(this.webpackJsonplibrary=this.webpackJsonplibrary||[]).push([[1],{148:function(e){e.exports=JSON.parse('{"en":{"titleLong":"Holy Korean Martyrs Catholic Church Library","titleShort":"HKMCC Library","idHolder":"Enter User ID","pwHolder":"Enter email or phone","bookHolder":"Enter book ID","logIn":"Log In","logOut":"Log Out","logInSucceed":"Logged in","logInFail":"Log In Failed","nameSuffix":"","home":"Home","checkOutStatus":"Check Out Status","bookSearch":"Book Search","userSearch":"User Search","checkOut":"Check Out","return":"Return","extend":"Extend","history":"Rent History","situation":"Rent State","loading":"Loading DB","succeededToOpen":"Succeeded to load","searchUser":"Enter name or ID","searchBook":"Enter book keywords","failedToOpen":"Failed to open DB Refresh page later","all":"All","available":"Available","checkedOut":"Checked out","reserved":"Reserved","overDue":"Overdue","lost":"Lost","damaged":"Damanged","given":"Given","notAvailable":"Not available","deleted":"Deleted","id":"ID","bookName":"Book name","rentDate":"Rent date","returnDate":"Return date","dueDate":"Due date","noEntry":"No entry","notice":"Notice","newMember":"New Member","autoLogin":"AutoLogin","userMode":"User Mode","adminMode":"Admin Mode","normal":"Normal","stopped":"Stopped","homeText":"<div class=\\"container\\"><h2>Library Hours:</h2> <ul> <li>Every Sunday 9:30am~12:00pm</li> </ul> <h2>Book Borrowing:</h2> <ul> <li>Every Sunday 10:30am~12:00pm</li> <li>Maximum number of books for borrowing: 5</li> <li>Borrowing period: 3 weeks (Please request an extension from a volunteer at the time of borrowing or send an extension request email to <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>)</li> <li>Book return: Please return the books to the return box in front of the library or directly to the library volunteers.</li> <li>Request for desired books: Please fill out and submit the desired book request form provided at the library.</li> </ul> <h2>For other inquiries:</h2> <ul> <li>Please contact the library by email at <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>.</li> </ul></div>","INVALID_BOOK":"Unregistered book","INVALID_USER":"Invalid user","NOT_AVAILABLE":"Not available","OVERDUE":"Overdue account","RENTED":"Already rented book","MAX_RENTAL":"Max rent reached","NOT_RENTED":"Not a rented book","rentSucceed":"Rented","returnSucceed":"Returned","rentSuffix":" book(s) rented","confirmRent":"Rent this book?","confirmReturn":"Return this book?","confirm":"Confirm","cancel":"Cancel","name":"Name","registeredDate":"Registered","phone":"Phone","email":"Email","address":"Address","notice_":"Notice","level":"Level","save":"Save","confirmSave":"Save the modification?","kid":"Kid","adult":"Adult","admin":"Admin","regSuccess":"Registration Succeed","regFail":"Registration Fail","numberOnly":"Number Only","advSearch":"Advanced Search","search":"Search","author":"Author","bookCode":"Book code","finish":"Finish","extending":"Extend requested","maxExtend":"Max Extended"},"kr":{"titleLong":"\ucc9c\uc8fc\uad50 \uc0b0\ud638\uc138 \ud55c\uad6d \uc21c\uad50\uc790 \uc131\ub2f9 \ub3c4\uc11c\uad00","titleShort":"HKMCC \ub3c4\uc11c\uad00","idHolder":"\ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","pwHolder":"\uc774\uba54\uc77c\uc774\ub098 \uc804\ud654\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","bookHolder":"\ub3c4\uc11c \ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","logIn":"\ub85c\uadf8\uc778","logOut":"\ub85c\uadf8\uc544\uc6c3","logInSucceed":"\ub85c\uadf8\uc778 \uc131\uacf5","logInFail":"\ub85c\uadf8\uc778 \uc2e4\ud328","nameSuffix":" \ub2d8","home":"\ud648","checkOutStatus":"\ub300\ucd9c \uae30\ub85d \uc870\ud68c","bookSearch":"\ub3c4\uc11c \uac80\uc0c9","userSearch":"\ud68c\uc6d0 \uac80\uc0c9","checkOut":"\ub300\ucd9c","return":"\ubc18\ub0a9","extend":"\ub300\ucd9c \uc5f0\uc7a5","history":"\ub300\ucd9c \uc774\ub825","situation":"\ub300\ucd9c \ud604\ud669","loading":"DB \uc870\ud68c \uc911","succeededToOpen":"DB \uc870\ud68c \uc644\ub8cc","searchUser":"\uc774\ub984 \ub610\ub294 \ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","searchBook":"\ucc45 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694","failedToOpen":"DB \uc870\ud68c\uac00 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4 \uc7a0\uc2dc \ud6c4 \ud654\uba74\uc744 \uac31\uc2e0\ud574\uc8fc\uc138\uc694","all":"\uc804\uccb4","available":"\ub300\ucd9c\uac00\ub2a5","checkedOut":"\ub300\ucd9c\uc911","reserved":"\uc608\uc57d\uc911","overDue":"\uc5f0\uccb4\uc911","lost":"\ubd84\uc2e4","damaged":"\ud30c\uc190","given":"\uae30\uc99d","notAvailable":"\ub300\ucd9c\ubd88\uac00","deleted":"\ud3d0\uae30","id":"\ubc88\ud638","bookName":"\ub3c4\uc11c\uba85","rentDate":"\ub300\ucd9c\uc77c","returnDate":"\ubc18\ub0a9\uc77c","dueDate":"\ub300\ucd9c\uae30\ud55c","noEntry":"\ub0b4\uc5ed \uc5c6\uc74c","notice":"\uacf5\uc9c0 \uc0ac\ud56d","newMember":"\uc2e0\uaddc \ud68c\uc6d0","autoLogin":"\uc790\ub3d9 \ub85c\uadf8\uc778","userMode":"\uc77c\ubc18 \ubaa8\ub4dc","adminMode":"\uad00\ub9ac\uc790 \ubaa8\ub4dc","normal":"\uc815\uc0c1","stopped":"\ub300\ucd9c\uc911\uc9c0","homeText":"<div class=\\"container\\"><h2>\ub3c4\uc11c\uad00 \uac1c\ubc29\uc2dc\uac04:</h2><ul><li>\ub9e4 \uc8fc\uc77c(\uc77c) 9:30am~12:00pm</li></ul><h2>\ub3c4\uc11c \ub300\ucd9c:</h2><ul><li>\ub9e4 \uc8fc\uc77c 10:30am~12:00pm </li><li>\ub300\ucd9c \uad8c\uc218: \ucd5c\ub300 5\uad8c</li><li>\ub300\ucd9c \uae30\uac04: 3\uc8fc (\ub3c4\uc11c \ub300\ucd9c\uc2dc\uac04\uc5d0 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc5f0\uc7a5\uc744 \uc694\uccad\ud558\uc2dc\uac70\ub098, <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\uc73c\ub85c \uc5f0\uc7a5 \uc2e0\uccad \uba54\uc77c\uc744 \ubcf4\ub0b4\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.)</li><li>\ub3c4\uc11c \ubc18\ub0a9: \ub3c4\uc11c\uad00 \uc55e \ubc18\ub0a9\ud568\uc5d0 \ub123\uc5b4 \uc8fc\uc2dc\uac70\ub098 \ub3c4\uc11c\uad00 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc9c1\uc811 \ubc18\ub0a9\ud558\uc5ec \uc8fc\uc2ed\uc2dc\uc624.</li><li>\ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad: \ub3c4\uc11c\uad00\uc5d0 \ube44\uce58\ub41c \ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad\uc11c\uc5d0 \uc791\uc131\ud558\uc5ec \uc81c\ucd9c\ud558\uc5ec \uc8fc\uc138\uc694.</li></ul></p><h2>\ubb38\uc758:</h2><ul><li>\ub3c4\uc11c\uad00 \uad00\ub828 \ubb38\uc758\ub294 \ub3c4\uc11c\uad00 \uc774\uba54\uc77c \uc8fc\uc18c <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\ub85c \ubb38\uc758 \ubc14\ub78d\ub2c8\ub2e4.</li></ul></div>","INVALID_BOOK":"\ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \ub3c4\uc11c\uc785\ub2c8\ub2e4","INVALID_USER":"\ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \ud68c\uc6d0\uc785\ub2c8\ub2e4","NOT_AVAILABLE":"\ub300\ucd9c \ubd88\uac00 \ub3c4\uc11c\uc785\ub2c8\ub2e4","OVERDUE":"\uc5f0\uccb4\uc911\uc785\ub2c8\ub2e4","RENTED":"\ub300\ucd9c\ub41c \ub3c4\uc11c\uc785\ub2c8\ub2e4","MAX_RENTAL":"\ub300\ucd9c \uad8c\uc218\ub97c \ucd08\uacfc\ud558\uc600\uc2b5\ub2c8\ub2e4","NOT_RENTED":"\ub300\ucd9c\ub418\uc9c0 \uc54a\uc740 \ub3c4\uc11c\uc785\ub2c8\ub2e4","rentSucceed":"\ub300\ucd9c \uc644\ub8cc","returnSucceed":"\ubc18\ub0a9 \uc644\ub8cc","rentSuffix":"\uad8c \ub300\ucd9c \uc911","confirmRent":"\ub300\ucd9c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","confirmReturn":"\ubc18\ub0a9\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","confirm":"\ud655\uc778","cancel":"\ucde8\uc18c","name":"\uc774\ub984","registeredDate":"\ub4f1\ub85d\uc77c","phone":"\uc804\ud654\ubc88\ud638","email":"\uc774\uba54\uc77c","address":"\uc8fc\uc18c","notice_":"\ube44\uace0","level":"\ub4f1\uae09","save":"\uc800\uc7a5","confirmSave":"\uc800\uc7a5\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","kid":"\uc544\ub3d9","adult":"\uc131\uc778","admin":"\uad00\ub9ac\uc790","regSuccess":"\ub4f1\ub85d \uc644\ub8cc","regFail":"\ub4f1\ub85d \uc2e4\ud328","numberOnly":"\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694","advSearch":"\uc0c1\uc138 \uac80\uc0c9","search":"\uac80\uc0c9","author":"\uc800\uc790","bookCode":"\ub3c4\uc11c\ubc88\ud638","finish":"\uc644\ub8cc","extending":"\uc5f0\uc7a5 \uc2e0\uccad\uc911","maxExtend":"\uc5f0\uc7a5 \ud55c\ub3c4 \ucd08\uacfc"}}')},244:function(e,t,o){},245:function(e,t,o){},246:function(e,t,o){},256:function(e,t,o){},264:function(e,t){},266:function(e,t){},296:function(e,t){},298:function(e,t){},299:function(e,t){},304:function(e,t){},306:function(e,t){},326:function(e,t){},342:function(e,t){},345:function(e,t){},413:function(e,t,o){},414:function(e,t,o){},416:function(e,t,o){"use strict";o.r(t);var n=o(2),c=o.n(n),s=o(216),l=(o(244),o(245),o(18)),a=(o(246),o(1));var i=function(e){return Object(n.useEffect)((function(){!async function(){console.log("Home"),e.doc.setCallback(void 0)}()}),[]),e.doc.serverAvailable?(o.e(0).then(o.t.bind(null,467,7)),Object(a.jsxs)("div",{id:"home",children:[Object(a.jsx)(l.b,{className:"home-items",to:"/checkOut",children:e.text.checkOut}),Object(a.jsx)(l.b,{className:"home-items",to:"/return",children:e.text.return})]})):Object(a.jsx)("div",{id:"home",dangerouslySetInnerHTML:{__html:e.text.homeText}})},r=(o(47),o(63)),d=o(466);const u=10;String.prototype.format=function(){let e=this;for(let t=0;t<arguments.length;t++){let o=new RegExp("\\{"+t+"\\}","gi");e=e.replace(o,arguments[t])}return e};const b={position:"top-center",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0},j=function(e,t){return"0"===t||0===t?e.normal:"1"===t||1===t?e.overDue:"2"===t||2===t?e.stopped:void 0},h=function(e,t){switch(t){case"0":case 0:return e.available;case"1":case 1:return e.checkedOut;case"2":case 2:return e.reserved;case"3":case 3:return e.overDue;case"4":case 4:return e.lost;case"5":case 5:return e.damaged;case"6":case 6:return e.given;case"7":case 7:default:return e.notAvailable;case"8":case 8:return e.deleted}},O=function(e,t){if(e.name>t.name)return 1;if(e.name<t.name)return-1;const o=parseInt(e.claim_num),n=parseInt(t.claim_num);return o>n?1:o<n?-1:0},g=function(e,t){return e.name>t.name?1:e.name<t.name?-1:0},x=function(e,t){return e.rentDate>t.rentDate?1:e.rentDate<t.rentDate?-1:e.title>t.title?1:e.title<t.title?-1:0},m=function(e){return unescape(encodeURIComponent(e))},f="custom-loading-id",p="custom-logging-id";var v=o(7),k=o(104),S=o.n(k),E=o(106),y=o.n(E);var N=function(){console.log("Do nothing...")};var I,C,_,R,A,D,T,w,L,B,U,M=function(e){const[t,o]=Object(n.useState)([]),[c,s]=Object(n.useState)(0),[l,i]=Object(n.useState)([]);return Object(n.useEffect)((function(){console.log("Init List View")}),[]),Object(n.useEffect)((function(){o(e.list)}),[e.list]),Object(n.useEffect)((function(){s(0)}),[e.keyValue]),Object(n.useEffect)((function(){e.showCallback&&(N=e.showCallback)}),[e.showCallback]),Object(n.useEffect)((function(){const e=t.length;if(e>u){const o=c*u,n=Math.min(u,e-o);i(t.slice(o,o+n))}else i(t)}),[t,c]),Object(a.jsxs)("div",{id:"listView",children:[N(l,e.detail),t&&t.length>u&&Object(a.jsxs)("div",{id:"pageControl",children:[Object(a.jsx)("div",{className:"page",id:"page",children:Object(a.jsx)(S.a,{fontSize:"large",sx:{color:0===c?"#ffffff":"#404040"},onClick:()=>{console.log("Prev"),c>0&&s(c-1)}})}),Object(a.jsx)("div",{className:"pageNum",id:"pageNum",children:c+1}),Object(a.jsx)("div",{className:"page",id:"page",children:Object(a.jsx)(y.a,{fontSize:"large",sx:{color:t.length<=(c+1)*u?"#ffffff":"#404040"},onClick:()=>{console.log("Next"),t.length>(c+1)*u&&s(c+1)}})})]})]})},P=o(37),q=o(38);const H=Object(q.a)(I||(I=Object(P.a)(["\n    query AllBook{\n        book (limit:20000) {\n            _id\n            author\n            title\n            claim_num\n            num\n            series\n            category\n            claim\n            publisher\n            seqnum\n            registration_date\n            isbn\n            deleted\n        }\n    }\n"]))),K=Object(q.a)(C||(C=Object(P.a)(["\n    query AllRent{\n        rent (limit:20000) {\n            _id\n            book_id\n            user_id\n            rent_date\n            return_date\n            extend_count\n            state\n        }\n    }\n"]))),z=Object(q.a)(_||(_=Object(P.a)(["\n    query AllUser {\n        user (limit: 20000) {\n            _id\n            name\n            state\n            level\n        }\n    }"]))),F=Object(q.a)(R||(R=Object(P.a)(["\n    query FindUser($_id: string){\n        user (where: {_id: {_eq: $_id}}) {\n            _id\n            name\n            state\n            level\n            encrypted_email\n            encrypted_phone\n        }\n    }"]))),V=Object(q.a)(A||(A=Object(P.a)(["\n    query findLogs($user_id: string){\n        rentLog (limit: 20000, where: {user_id: {_eq: $user_id}}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            return_date\n            user_id\n        }\n    }"]))),G=Object(q.a)(D||(D=Object(P.a)(["\n    query findLogs($book_id: string){\n        rentLog (limit: 20000, where: {book_id: {_eq: $book_id}}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            return_date\n            user_id\n        }\n    }"]))),Y=Object(q.a)(T||(T=Object(P.a)(["\n    query findLogs ($fromTime: string, $toTime: string) {\n        rentLog(limit: 20000, where: {timestamp: {_gte: $fromTime, _lt: $toTime}}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            return_date\n            user_id\n        }\n    }"]))),Q=Object(q.a)(w||(w=Object(P.a)(["\n    query GetNotices {\n        notice (order_by: {date: asc}, limit:20000) {\n            _id\n            date\n            title\n        }\n    }"]))),W=Object(q.a)(L||(L=Object(P.a)(["\n    query GetContent ($_id: string) {\n        notice (where: {_id: {_eq: $_id}}) {\n            _id\n            date\n            title\n            content\n        }\n    }"]))),Z=Object(q.a)(B||(B=Object(P.a)(["\n    query GetServerInfo {\n        serverInfo {\n            _id\n            globalIp\n            localIp\n            port\n            proxy\n        }\n    }"]))),$=Object(q.a)(U||(U=Object(P.a)(["\n    query GetRequests($user_id: string) {\n        request (limit: 20000, where: {user_id: {_eq: $user_id}}) {\n            _id\n            user_id\n            action\n            state\n            book_id\n        }\n    }"])));var J=function(e){const[t,o]=Object(n.useState)([]),[c,s]=Object(n.useState)([]),[i,b]=Object(n.useState)(0),{loading:j,data:h,error:O}=Object(r.e)(Q),{id:g}=Object(v.r)(),[x,{loading:m,data:f,error:p}]=Object(d.a)(W,{variables:{_id:g}});Object(n.useEffect)((function(){!async function(){console.log("Notice"),e.doc.setCallback(void 0)}()}),[]),Object(n.useEffect)((()=>{console.log("Get Notice"),h&&o(h.notice)}),[h,O,j]),Object(n.useEffect)((()=>{console.log("Get Content")}),[f,p,m]),Object(n.useEffect)((()=>{const e=t.length;if(console.log("Page num "+i.toString()+" "),console.log(e),e>u){const o=i*u,n=Math.min(u,e-o);s(t.slice(o,o+n))}else s(t),b(0)}),[t,i]),Object(n.useEffect)((()=>{}),[c]),Object(n.useEffect)((()=>{console.log("Select id: "+g),g&&x()}),[g,x]);const k=e=>Object(a.jsxs)("tr",{className:"",children:[Object(a.jsxs)("td",{className:"",children:[" ",e.date," "]}),Object(a.jsxs)("td",{className:"noticeEntry",colSpan:"2",children:[g!==e._id&&Object(a.jsx)(l.b,{to:"/notice/"+e._id,children:e.title}),g===e._id&&Object(a.jsx)(l.b,{to:"/notice",children:e.title})]})]},e._id);return Object(a.jsxs)("div",{id:"notice",children:[Object(a.jsx)("div",{id:"title",children:Object(a.jsx)("h2",{children:e.text.notice})}),g&&f&&Object(a.jsx)("div",{id:"noticeContent",children:Object(a.jsx)("table",{className:"content",children:Object(a.jsxs)("tbody",{children:[k(f.notice[0]),Object(a.jsx)("tr",{children:Object(a.jsx)("td",{className:"content",colSpan:"3",children:f.notice[0].content})})]})})}),Object(a.jsx)(M,{list:t,showCallback:e=>Object(a.jsx)("div",{id:"noticeList",children:Object(a.jsx)("table",{children:Object(a.jsx)("tbody",{children:c.length>0&&c.map((e=>k(e)))})})})})]})},X=o(45),ee=o(231);o(252);let te=!1;var oe=function(e){const[t,c]=Object(n.useState)(""),[s,i]=Object(n.useState)([]),[r,u]=Object(n.useState)(0),[b,j]=Object(n.useState)([]),[g,x]=Object(n.useState)([]),[f,p]=Object(n.useState)(0),[k,S]=Object(n.useState)(!1),[E,y]=Object(n.useState)(!1),[N,I]=Object(n.useState)(""),[C,_]=Object(n.useState)(!1),[R,A]=Object(n.useState)(""),[D,T]=Object(n.useState)(""),[w,L]=Object(n.useState)(""),[B,U]=Object(n.useState)(""),[P,q]=Object(n.useState)(""),[H,K]=Object(n.useState)(0),[z,F]=Object(n.useState)([]),[V]=Object(X.a)(t,300),[Y,{data:Q}]=Object(d.a)(G,{variables:{book_id:N}}),W=Object(n.useRef)("0"),Z=Object(n.useRef)(!1),$=Object(n.useRef)(0),J=Object(n.useRef)(!1),{id:oe}=Object(v.r)();async function ne(){console.log("All data loaded "+te),te=!0;let t=[],o={};const n=e.doc.rent;for(let e=0;e<n.length;e++)t.push({code:n[e].book_id,retDate:n[e].return_date,state:n[e].state}),o[n[e].book_id]=n[e].state;x(t);let c=[];const s=e.doc.book;for(const e in s){const t=s[e],n=e in o?o[e]:0;c.push({code:t._id,name:t.title,state:n,num:t.num,author:t.author,claim:t.claim,regDate:t.registration_date,claim_num:t.claim_num,totalName:t.series,category:t.publisher,publish:t.publisher,isbn:t.isbn,deleted:t.deleted})}console.log("Load"),console.log(c.length),j(c),console.log(N),""!==N&&(console.log("Load history"),Y())}function ce(e){console.log("Set state "+e.toString()),Z.current=!0,S(!0),p(e),$.current=e,console.log(r.toString()+Z.current)}function se(e){const t=e.toString(),o=document.getElementById(t).checked;console.log("Set Search state "+t+" Value: "+o),"1023"===t?(document.getElementById("1023").checked=o,document.getElementById("0").checked=o,document.getElementById("1").checked=o,document.getElementById("3").checked=o,document.getElementById("4").checked=o,document.getElementById("5").checked=o,document.getElementById("6").checked=o,document.getElementById("7").checked=o,document.getElementById("8").checked=o):document.getElementById(t).checked=o;for(var n=0,c=0;c<9;c++){const e=c.toString(),t=document.getElementById(e);t&&(n|=t.checked?1<<c:0)}K(n),console.log("Filter: "+n.toString())}Object(n.useEffect)((function(){!async function(){e.doc.isOpen()?ne():e.doc.setCallback(ne),e.doc.serverAvailable&&o.e(0).then(o.t.bind(null,467,7)),console.log("BOOK ID: "+oe)}()}),[]),Object(n.useEffect)((()=>{console.log("Updated id: "+oe),oe?(console.log("Set Book ID "+oe),I(oe),Y()):I("")}),[oe,Y]),Object(n.useEffect)((()=>{!async function(){var t;if(console.log("Refresh"),!C)if(t=""!==N?N:V,console.log(t),t){let o=await async function(t){let o=[];if(e.doc.serverAvailable){console.log(m(t)),console.log(btoa(m(t)));const n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book";console.log("======================="),console.log("Request book list");const c={book:btoa(m(t)),match:!1},s=await e.doc.requestGet(n,c);if(console.log(s),!("books"in s.data.return))return o;const l=s.data.return.books;for(let t=0;t<l.length;t++){const n=l[t],c="".concat(n.BOOKNAME," ").concat(n.CLAIMNUM),s=n._STATE;let a="";1!==s&&3!==s&&"1"!==s&&"3"!==s||(a=e.text.returnDate+" "+n._RETURN);let i={index:t,text:c,name:n.BOOKNAME,code:n.BARCODE,rent:h(e.text,n._STATE.toString()),retDate:a,regDate:n.REG_DATE,author:n.AUTHOR,totalName:n.TOTAL_NAME,claim_num:n.CLAIMNUM,publish:n.PUBLISH,claim:n.CLAIM,state:n._STATE,isbn:n.ISBN};o.push(i)}}else o=ie(t,b);return o.sort(O),o}(t);o.length>0?i(o):i([]),1===o.length&&(W.current=o[0].code)}else i([])}()}),[V,N,b,g,e,E,C,f]),Object(n.useEffect)((()=>{if(console.log("History update"),console.log(Q),!Q)return F([]),void(J.current=!1);let e=[];for(let t=0;t<Q.rentLog.length;t++){const o=Q.rentLog[t];if(1!==o.book_state)continue;let n=[o.timestamp];n.push(o.return_date),e.push(n)}console.log(e.length),F(e),J.current=e.length>0}),[Q]);const le=(t,o)=>{const n=t.code!==W.current,c=n?"searchResult":"selectedSearchResult",i=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];i[t.state]=!0,1!==t.state&&2!==t.state&&3!==t.state||(i[0]=!0);const r=o[2];return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{id:c,onClick:async()=>await(async e=>{console.log("Prev "+W.current),1===s.length||-1===W.current||W.current!==e?(console.log("Select "+e),u(e),W.current=e):(console.log("Deselect "+e),u(-1),W.current=-1)})(t.code),children:Object(a.jsx)("table",{children:Object(a.jsx)("tbody",{children:Object(a.jsxs)("tr",{className:"searchTr",children:[Object(a.jsx)("td",{className:"searchTitle",children:t.text}),Object(a.jsx)("td",{className:"searchRent",children:t.rent})]})})})}),!n&&Object(a.jsxs)("div",{children:[Object(a.jsx)("table",{children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{children:[t.author," "]}),Object(a.jsxs)("td",{colSpan:"2",rowSpan:"2",children:[t.totalName+" ",Object(a.jsx)("b",{children:t.name})," "+t.claim_num]})]},"row1"),Object(a.jsx)("tr",{children:Object(a.jsx)("td",{children:Object(a.jsx)(l.b,{to:"/search/"+t.code,children:t.code})})},"row2"),Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:t.publish}),Object(a.jsx)("td",{colSpan:t.retDate.length>0?"1":"2",children:t.claim}),t.retDate.length>0&&Object(a.jsx)("td",{children:t.retDate})]},"row3")]})}),Object(a.jsx)("table",{className:"rentHistory",hidden:!J.current,children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{id:"titles",children:[Object(a.jsx)("td",{children:e.text.rentDate}),Object(a.jsx)("td",{children:e.text.returnDate})]}),r.map((e=>(e=>Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:e[0]},e[0]+"x"),Object(a.jsx)("td",{children:e[1]})]},e[0]))(e)))]})}),Object(a.jsxs)("div",{hidden:!e.doc.serverAvailable||!e.doc.admin,children:[Object(a.jsxs)("button",{className:"bookStates",id:"0",disabled:i[0],onClick:()=>ce(0),children:[" ",e.text.available," "]}),Object(a.jsxs)("button",{className:"bookStates",id:"4",disabled:i[4],onClick:()=>ce(4),children:[" ",e.text.lost," "]}),Object(a.jsxs)("button",{className:"bookStates",id:"5",disabled:i[5],onClick:()=>ce(5),children:[" ",e.text.damaged," "]}),Object(a.jsxs)("button",{className:"bookStates",id:"6",disabled:i[6],onClick:()=>ce(6),children:[" ",e.text.given," "]}),Object(a.jsxs)("button",{className:"bookStates",id:"7",disabled:i[7],onClick:()=>ce(7),children:[" ",e.text.notAvailable," "]}),Object(a.jsxs)("button",{className:"bookStates",id:"8",disabled:i[8],onClick:()=>ce(8),children:[" ",e.text.deleted," "]})]}),Object(a.jsxs)("div",{id:"checkRent",hidden:!Z.current,children:[Object(a.jsxs)("div",{id:"bookName",children:[" ",h(e.text,$.current)," "]}),Object(a.jsxs)("button",{id:"confirm",onClick:()=>async function(){console.log("Confirmed"),Z.current=!1,S(!1);const t=e.doc.serverInfo.localIp,o=e.doc.serverInfo.port;if(0===t.length||o<=0)return;const n="https://"+t+":"+o+"/book";var c={};c.book=W.current,c.state=$.current,console.log("======================="),console.log("Change book state"),await e.doc.requestPost(n,c),y(!E)}(),children:[" ",e.text.confirm," "]}),Object(a.jsxs)("button",{id:"cancel",onClick:()=>(console.log("Cancelled"),Z.current=!1,void S(!1)),children:[" ",e.text.cancel," "]})]})]})]},t.code)};function ae(e,t){e?T(t):L(t)}function ie(t,o){let n=[];console.log(C);const c=t.toLowerCase();console.log(c);for(let s=0;s<o.length;s++){const t=o[s];if(n.length>=500)break;if(c.length>0&&(!t.name||!t.name.toString().toLowerCase().includes(c))&&(!t.totalName||!t.totalName.toString().toLowerCase().includes(c))&&(!t.author||!t.author.toString().toLowerCase().includes(c))&&t.code.toLowerCase()!==c&&t.isbn!==c)continue;if(t.deleted&&"Y"===t.deleted)continue;if(C){if(R.length>0&&t.author&&!t.author.toString().toLowerCase().includes(R.toLowerCase()))continue;if(D.length>0&&t.code<D)continue;if(w.length>0&&t.code>w)continue;const e=t.regDate;if(e<B||e>P)continue;if(console.log(t),console.log(e),console.log(e<B),console.log(e>P),!(1<<t.state&H))continue}else if(0===c.length)continue;let l="".concat(t.name," ").concat(t.claim_num),a="",i="0";for(const o of g)if(o.code===t.code){i=o.state,"1"!==i&&"3"!==i||(a=e.text.returnDate+" "+o.retDate);break}let r={index:s,text:l,name:t.name,code:t.code.toString(),rent:h(e.text,i),retDate:a,regDate:t.regDate,author:t.author,totalName:t.totalName,claim_num:t.claim_num,publish:t.publish,claim:t.claim,state:parseInt(i),isbn:t.isbn};n.push(r)}return console.log(n.length),n}return Object(a.jsxs)("div",{id:"search",children:[Object(a.jsx)("div",{id:"title",children:Object(a.jsxs)("h2",{children:[" ",e.text.bookSearch," "]})}),Object(a.jsxs)("div",{id:"searchContents",hidden:""!==N,children:[Object(a.jsx)("input",{id:"searchInput",placeholder:e.text.searchBook,value:t,onChange:e=>{c(e.target.value)}}),Object(a.jsxs)("div",{hidden:!e.doc.admin,children:[Object(a.jsx)("input",{type:"checkbox",id:"advancedSearch",checked:C,onChange:()=>{_(!C)}}),Object(a.jsx)("label",{children:e.text.advSearch})]}),Object(a.jsxs)("div",{hidden:!C,children:[Object(a.jsxs)("div",{children:[Object(a.jsxs)("label",{children:[" ",e.text.author," "]}),Object(a.jsx)("input",{type:"text",id:"author",onChange:e=>{A(e.target.value)}})]}),Object(a.jsxs)("div",{children:[Object(a.jsxs)("label",{children:[" ",e.text.bookCode," "]}),Object(a.jsx)("input",{type:"text",id:"fromPeriod",onChange:e=>{ae(!0,e.target.value)}}),Object(a.jsx)("label",{children:" ~  "}),Object(a.jsx)("input",{type:"text",id:"toPeriod",onChange:e=>{ae(!1,e.target.value)}})]}),Object(a.jsxs)("div",{children:[Object(a.jsxs)("label",{children:[" ",e.text.registeredDate," "]}),Object(a.jsx)(ee.a,{onChange:function(e){console.log(e);const t=e[0],o=e[1],n=t.getFullYear().toString()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0");console.log(n),U(n);const c=o.getFullYear().toString()+"-"+(o.getMonth()+1).toString().padStart(2,"0")+"-"+o.getDate().toString().padStart(2,"0");console.log(c),q(c)},selectRange:!0})]}),Object(a.jsx)("div",{children:Object(a.jsx)("table",{children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{className:"bookData",children:[Object(a.jsx)("td",{className:"stateName",children:e.text.all}),Object(a.jsx)("td",{className:"stateName",children:e.text.available}),Object(a.jsx)("td",{className:"stateName",children:e.text.checkedOut}),Object(a.jsx)("td",{className:"stateName",children:e.text.overDue}),Object(a.jsx)("td",{className:"stateName",children:e.text.lost}),Object(a.jsx)("td",{className:"stateName",children:e.text.damaged}),Object(a.jsx)("td",{className:"stateName",children:e.text.given}),Object(a.jsx)("td",{className:"stateName",children:e.text.notAvailable}),Object(a.jsx)("td",{className:"stateName",children:e.text.deleted})]},"stateName"),Object(a.jsxs)("tr",{className:"bookData",children:[Object(a.jsx)("td",{className:"stateButton",children:Object(a.jsx)("input",{type:"checkbox",className:"bookStates",id:"1023",onChange:()=>se(1023)})}),Object(a.jsx)("td",{className:"stateButton",children:Object(a.jsx)("input",{type:"checkbox",className:"bookStates",id:"0",onChange:()=>se(0)})}),Object(a.jsx)("td",{className:"stateButton",children:Object(a.jsx)("input",{type:"checkbox",className:"bookStates",id:"1",onChange:()=>se(1)})}),Object(a.jsx)("td",{className:"stateButton",children:Object(a.jsx)("input",{type:"checkbox",className:"bookStates",id:"3",onChange:()=>se(3)})}),Object(a.jsx)("td",{className:"stateButton",children:Object(a.jsx)("input",{type:"checkbox",className:"bookStates",id:"4",onChange:()=>se(4)})}),Object(a.jsx)("td",{className:"stateButton",children:Object(a.jsx)("input",{type:"checkbox",className:"bookStates",id:"5",onChange:()=>se(5)})}),Object(a.jsx)("td",{className:"stateButton",children:Object(a.jsx)("input",{type:"checkbox",className:"bookStates",id:"6",onChange:()=>se(6)})}),Object(a.jsx)("td",{className:"stateButton",children:Object(a.jsx)("input",{type:"checkbox",className:"bookStates",id:"7",onChange:()=>se(7)})}),Object(a.jsx)("td",{className:"stateButton",children:Object(a.jsx)("input",{type:"checkbox",className:"bookStates",id:"8",onChange:()=>se(8)})})]},"stateButton")]})})}),Object(a.jsx)("div",{children:Object(a.jsxs)("button",{id:"searchEntry",onClick:function(){console.log("Search"),console.log(D),console.log(w),console.log(B),console.log(P);let e=ie(t,b);e.sort(O);let o=e;o.length>0?i(o):i([]),1===o.length&&(W.current=o[0].code)},children:[" ",e.text.search," "]})})]})]}),Object(a.jsx)(M,{keyValue:V,list:s,detail:[r,k,z],showCallback:(e,t)=>function(e,t){return console.log("Redraw "+Z.current),console.log(J.current),console.log(t),e.map((e=>le(e,t)))}(e,t)})]})},ne=o(12);const ce=0,se=1,le=2;var ae=function(e){const[t,s]=Object(n.useState)(""),[i,r]=Object(n.useState)(""),[u,j]=Object(n.useState)([]),[h,O]=Object(n.useState)(!1),[g,m]=Object(n.useState)(""),[f,k]=Object(n.useState)(ce),[S,E]=Object(n.useState)([]),[y,N]=Object(n.useState)(0),[I,C]=Object(n.useState)(!1),[_,{data:R}]=Object(d.a)(F,{variables:{_id:g}}),[A,{data:D}]=Object(d.a)(V,{variables:{user_id:g}}),[T,{data:w}]=Object(d.a)($,{variables:{user_id:g}}),[L,B]=Object(n.useState)(""),[U,P]=Object(n.useState)("");async function q(){if(console.log("All data loaded "+h),e.doc.logged){k(le);const t=e.doc.userInfo._id;m(t),j(await e.doc.getRent(t)),console.log(e.doc.getRent(t)),await A(),await T()}else k(ce),m(""),r("");console.log("Set title "+e.doc.logged),e.doc.logged?e.doc.adminMode?P(e.text.userSearch):P(e.text.checkOut):P(e.text.logIn),console.log("Done"),O(!0)}Object(n.useEffect)((function(){!async function(){if(!e.doc.initialized)return;if(e.doc.isOpen()&&q(),console.log("======================================="),console.log("CheckOutStatus initialize"),e.doc.serverAvailable&&o.e(0).then(o.t.bind(null,467,7)),"autoLogin"in e.context.cookie){const t="true"===e.context.cookie.autoLogin;C(t)}const t=new Date;t.setTime(t.getTime()+1728e5),B(t.toGMTString())}()}),[]),Object(n.useEffect)((()=>{console.log("User data updated "),q()}),[e.doc.logged]),Object(n.useEffect)((()=>{!async function(){console.log("User data updated "),await z()}()}),[R]),Object(n.useEffect)((()=>{if(!D||!e.doc.bookReady||!e.doc.rentReady)return;console.log("History updated ");let t=[];const o=D.rentLog;for(let n=0;n<o.length;n++){const c=o[n];if("1"!==c.book_state&&1!==c.book_state)continue;if(!("return_date"in c)||!c.return_date)continue;const s=c.book_id;if(!(s in e.doc.book))continue;const l=e.doc.book[s],a=l.title,i=l.claim,r=c.timestamp.split(" ")[0].replace("-","/",2).replace("-","/"),d=c.return_date.split(" ")[0].replace("-","/",2).replace("-","/");t.push({id:s,title:a,rentDate:r,retDate:d,claim:i,totalName:l.series,claim_num:l.claim_num})}t.sort(x),console.log("Set history"),E(t)}),[D,e.doc.bookReady,e.doc.rentReady]),Object(n.useEffect)((()=>{console.log("Request data"),w&&(console.log("Request available"),e.doc.setRequest(w.request))}),[w,e.doc]);const H=(t,o)=>{let n;return n=o?e.text.returnDate:e.text.dueDate,Object(a.jsx)("div",{children:Object(a.jsx)("table",{children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{id:"id",children:e.text.id}),Object(a.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(a.jsx)("th",{id:"returnDate",children:n})]},"ID"),t.map(((t,n)=>((t,o,n)=>{const s=t.id,i=t.rentDate,r=t.retDate,d=t.claim,u=o.toString(),b=t.extendCount,j=b>=2;let h,O;return n?h="1":(O=e.doc.hasRequest(s),h="2"),Object(a.jsxs)(c.a.Fragment,{children:[Object(a.jsxs)("tr",{className:"bookData",children:[Object(a.jsx)("td",{className:"bookData",children:Object(a.jsx)(l.b,{to:"/search/"+s,children:s})}),Object(a.jsx)("td",{className:"bookData",children:i}),Object(a.jsx)("td",{className:"bookData",children:r})]},u),Object(a.jsxs)("tr",{className:"bookName",children:[Object(a.jsx)("td",{className:"bookName",children:d}),Object(a.jsxs)("td",{colSpan:"2",rowSpan:h,className:"bookName",children:[t.totalName+" ",Object(a.jsx)("b",{children:t.title})," "+t.claim_num]})]},u+"Title"),!n&&Object(a.jsx)("tr",{className:"bookExtend",children:Object(a.jsxs)("td",{className:"bookExtend",children:[" ",Object(a.jsxs)("button",{id:"extend",onClick:async()=>K(s),disabled:O||j,children:[j&&e.text.maxExtend,O&&!j&&e.text.extending,!(O||j)&&e.text.extend,"(",b,")"]})]})},u+"Extend")]},u+"Fragment")})(t,n,o))),0===t.length&&Object(a.jsx)("tr",{children:Object(a.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})})},K=async t=>{console.log("Extend");const o=(new Date).toISOString().replace("T"," ").replace("Z","");console.log(o);const n='{\n "user_id": "'+g+'",\n "book_id": "'+t+'",\n "date": "'+o+'",\n "action": "extend"\n}\n';e.context.sendRequest(n),e.doc.addRequest(t),N(y+1)},z=async()=>{if(!R||f===ce)return;console.log(ne.c.isActive(p));const t=b;let o;console.log(i);const n=R.user[0];e.context.checkLogIn(n,i)?(e.doc.logIn(n),j(await e.doc.getRent(g)),k(le),t.type=ne.c.TYPE.SUCCESS,o=e.text.logInSucceed,document.cookie="user_id="+g+"; expires="+L+";"):(t.type=ne.c.TYPE.ERROR,o=e.text.logInFail),t.render=o,t.autoClose=3e3,t.toastId=p,ne.c.isActive(p)?(console.log("update toast"),ne.c.update(p,t)):(console.log("New toast"),ne.c.info(o,t))};return e.doc.initialized?Object(a.jsxs)("div",{id:"checkOut",children:[Object(a.jsx)("div",{id:"title",children:Object(a.jsx)("h2",{children:U})}),Object(a.jsxs)("div",{id:"checkOutInput",hidden:!(f!==le),children:[Object(a.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:t,disabled:!h,onInput:e=>{s(e.target.value)}}),Object(a.jsx)("input",{type:"password",id:"searchPassword",placeholder:e.text.pwHolder,value:i,disabled:!h,onInput:e=>{r(e.target.value)}}),Object(a.jsxs)("div",{id:"autoLogin",children:[Object(a.jsx)("input",{type:"checkbox",id:"autoLoginButton",checked:I,onChange:()=>(()=>{console.log("Toggle autoLogin");const e="autoLogin="+(I?"false":"true")+"; expires="+L+";";document.cookie=e,C(!I)})()}),Object(a.jsx)("label",{children:e.text.autoLogin})]}),Object(a.jsxs)("button",{id:"logIn",onClick:async()=>(async()=>{k(se),m(t.toUpperCase()),await _(),await A(),await T(),console.log("Log In"),await z()})(),children:[" ",e.text.logIn," "]})]}),Object(a.jsxs)("div",{id:"checkOutResult",hidden:!(f===le),children:[Object(a.jsx)("div",{children:H(u,!1)}),Object(a.jsx)("div",{id:"name",children:e.text.history}),Object(a.jsx)(M,{list:S,showCallback:e=>H(e,!0)})]})]}):Object(a.jsx)(v.a,{to:"/"})};const ie=0,re=1,de=2;var ue=function(e){const[t,c]=Object(n.useState)(""),[s,l]=Object(n.useState)(""),[i]=Object(X.a)(s,500),[r,d]=Object(n.useState)(""),[u,h]=Object(n.useState)(!1),[O,g]=Object(n.useState)(""),[x,m]=Object(n.useState)({}),[k,S]=Object(n.useState)([]),[E,y]=Object(n.useState)({}),[N,I]=Object(n.useState)({}),[C,_]=Object(n.useState)(ie),{id:R}=Object(v.r)(),A=Object(v.p)();Object(n.useEffect)((function(){const t=setInterval((async()=>{if(!("localIp"in e.doc.serverInfo)||!("port"in e.doc.serverInfo))return;if(e.doc.admin)return;o.e(0).then(o.t.bind(null,467,7));const t=e.doc.serverInfo.localIp,n=e.doc.serverInfo.port;if(t.length>0&&n>0){const o="https://"+t+":"+n+"/scanBarcode",c=(await e.doc.requestGet(o,{})).data.scan;c&&(console.log(c),console.log(C),g(c))}}),1e3);return async function(){console.log("======================================="),console.log("CheckOut initialize");const e=document.getElementsByName("idPrefix");for(var t=0;t<e.length;t++){const o=e[t].id;e[t].checked="AB"===o}console.log("ID: "+R),R&&0!==R.length&&(c(R),T(R))}(),()=>clearInterval(t)}),[]),Object(n.useEffect)((()=>{console.log("Updated id: "+R)}),[R]),Object(n.useEffect)((()=>{O&&(console.log("Updated barcode: "+O),console.log("state : "+C),C===de?d(O):C===ie&&T(O))}),[O]),Object(n.useEffect)((()=>{console.log("User data updated "),console.log(ne.c.isActive(p));const t=b;let o,n=!1;"USER_CODE"in E&&C!==de?(console.log("Set state to LoggedIn from "+C),_(de),t.type=ne.c.TYPE.SUCCESS,o=e.text.logInSucceed,n=!0):"USER_CODE"in E||(console.log("Set state to LoggedOut from "+C),C===re&&(t.type=ne.c.TYPE.ERROR,o=e.text.logInFail,n=!0),_(ie)),n&&m({id:f,text:o,type:t.type})}),[E]),Object(n.useEffect)((()=>{console.log("book updated "),"BARCODE"in N?0===N._STATE?h(!0):(m({id:f,text:e.text.RENTED,type:ne.c.TYPE.ERROR}),h(!1)):(h(!1),d(""))}),[N]),Object(n.useEffect)((()=>{if(!("text"in x))return;ne.c.dismiss(),console.log("Notification "+x.text);const e=b;e.type=x.type,e.autoClose=3e3,ne.c.info(x.text,e)}),[x]);const D=async t=>{const o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/user?user="+t,n={user:t,data:"nothing"},s=(await e.doc.requestGet(o,n)).data.return;y(s),console.log(s),c(s.USER_CODE)},T=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;var t,o,n="";const c=document.getElementsByName("idPrefix");if(e){if(e.length<=2)return;n=e.substring(0,2);var s=!1;for(o=0;o<c.length;o++)if(n===c[o].id){s=!0;break}if(!s)return;t=e}else{const e=document.getElementById("userInput").value;for(o=0;o<c.length;o++)c[o].checked&&(n=c[o].id),console.log("Pressed ["+o.toString()+" "+n+"]");t="A"===e[0]||"a"===e[0]?e:n+e}if(console.log("LOGIN"),console.log(t),0===t.length)return;console.log("Set state to LoggingIn from "+C),_(re);const l=t.toUpperCase();D(l)};function w(t){return Object(a.jsxs)("div",{id:"bookList",children:[Object(a.jsxs)("div",{id:"dueDate",children:[e.text.dueDate," : ",e.doc.dueDate]}),t.map(((e,t)=>function(e,t){return Object(a.jsxs)("div",{id:"bookEntry",children:[Object(a.jsxs)("div",{id:"bookItem",children:[" ",t.id," "]}),Object(a.jsxs)("div",{id:"bookItem",children:[" ",t.name," "]})]},t.id)}(0,e)))]})}return Object(n.useEffect)((()=>{!async function(){if(i.length<=0)return;var t;t=e.doc.admin?i:"HK"+i,console.log("Search book1 "+t);const o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",n={book:t,match:!0},c=(await e.doc.requestGet(o,n)).data.return;console.log(c),"books"in c&&"BOOKNAME"in c.books&&(console.log(c.books),I(c.books))}()}),[i,e.doc]),Object(n.useEffect)((()=>{!async function(){if(console.log("Set bookId: "+r),0===r.length)return;console.log("Search book2 "+r);const t="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",o={book:r,match:!0},n=(await e.doc.requestGet(t,o)).data.return;console.log(n),"books"in n&&"BOOKNAME"in n.books&&I(n.books)}()}),[r,e.doc]),Object(n.useEffect)((()=>{!async function(){if(console.log("Set userId: "+t),t&&0!==t.length&&(0===t.search("AA")||0===t.search("AB"))){const o=document.getElementsByName("idPrefix"),n=t.substring(0,2);for(var e=0;e<o.length;e++){const t=o[e].id;o[e].checked=n===t}}}()}),[t]),Object(a.jsxs)("div",{id:"checkOut",children:[Object(a.jsx)("div",{id:"title",children:Object(a.jsx)("h2",{children:e.text.checkOut})}),Object(a.jsxs)("div",{id:"checkOutInput",hidden:C===de,children:[Object(a.jsx)("input",{type:"radio",id:"AA",name:"idPrefix"}),Object(a.jsx)("label",{htmlFor:"AA",className:"idPrefix",name:"idPrefix",children:" AA "}),Object(a.jsx)("input",{type:"radio",id:"AB",name:"idPrefix"}),Object(a.jsx)("label",{htmlFor:"AB",className:"idPrefix",name:"idPrefix",children:" AB "}),Object(a.jsx)("input",{type:"text",id:"userInput",pattern:"[0-9]*",inputMode:"numeric",placeholder:e.text.idHolder,onKeyDown:e=>{!function(e){"Enter"===e.key&&(console.log(e),console.log(document.getElementById("userInput").value),T())}(e)}}),Object(a.jsxs)("button",{id:"logIn",onClick:async()=>T(),children:[" ",e.text.logIn," "]})]}),Object(a.jsxs)("div",{id:"checkOutResult",hidden:C!==de,children:[E.USER_CODE&&Object(a.jsxs)("div",{id:"userInfo",children:[Object(a.jsx)("div",{id:"userItem",children:E.USER_CODE+" : "+E.USER_NAME+e.text.nameSuffix}),Object(a.jsxs)("div",{id:"userItem",children:[" ",j(e.text,E.USER_STATE)," "]}),Object(a.jsxs)("div",{id:"userItem",children:[" ",E._RENT.length+" "+e.text.rentSuffix," "]})]}),Object(a.jsx)("div",{id:"bookInput",hidden:u,children:Object(a.jsxs)("label",{id:"manualInput",children:[Object(a.jsx)("div",{id:"hkPrefix",children:e.text.numberOnly}),Object(a.jsx)("input",{inputMode:"numeric",pattern:"[0-9]*",type:"text",id:"bookInput",placeholder:e.text.bookHolder,onInput:e=>{l(e.target.value)}})]})}),Object(a.jsxs)("div",{id:"checkRent",hidden:!u,children:[Object(a.jsxs)("div",{id:"bookName",children:[" ",e.text.confirmRent," "]}),Object(a.jsxs)("div",{id:"bookName",children:[" ",N.AUTHOR+":"," "]}),Object(a.jsxs)("div",{id:"bookName",children:[" ",N.BOOKNAME," "]}),Object(a.jsxs)("button",{id:"confirm",onClick:async()=>async function(){console.log("Confirmed"),h(!1),console.log(N);const o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/checkOut",n={book:N.BARCODE,user:t},c=(await e.doc.requestPost(o,n)).data.return;if(console.log("Rent confirmed"),console.log(c),"SUCCESS"===c)m({id:f,text:e.text.rentSucceed,type:ne.c.TYPE.SUCCESS}),k.push({id:N.BARCODE,name:N.BOOKNAME}),console.log(k),S(k);else{let t;t=c in e.text?e.text[c]:e.text.NOT_AVAILABLE,console.log(t),m({id:f,text:t,type:ne.c.TYPE.ERROR})}I({}),d(""),D(t)}(),children:[" ",e.text.confirm," "]}),Object(a.jsxs)("button",{id:"cancel",onClick:()=>(console.log("Cancelled"),h(!1),I({}),void d("")),children:[" ",e.text.cancel," "]})]}),k.length>0&&Object(a.jsx)(M,{list:k,showCallback:e=>w(e)})]}),Object(a.jsxs)("button",{id:"logOutButton",onClick:()=>(async()=>{console.log("Finish"),y({}),I({}),c(""),d(""),S([]),A("/")})(),children:[" ",e.text.finish," "]})]})},be=o(221),je=o.n(be);var he=function(e){const[t,c]=Object(n.useState)(""),[s]=Object(X.a)(t,300),[l,i]=Object(n.useState)({}),[r,d]=Object(n.useState)(!1),[u,j]=Object(n.useState)({}),[h,O]=Object(n.useState)(""),[g,x]=Object(n.useState)([]),m=Object(v.p)();function p(e){return Object(a.jsx)("div",{id:"bookList",children:e.map(((e,t)=>function(e,t){return Object(a.jsxs)("div",{id:"bookEntry",children:[Object(a.jsxs)("div",{id:"bookItem",children:[" ",t.id," "]}),Object(a.jsxs)("div",{id:"bookItem",children:[" ",t.name," "]})]},t.id)}(0,e)))})}return Object(n.useEffect)((function(){const t=setInterval((async()=>{if(!("localIp"in e.doc.serverInfo)||!("port"in e.doc.serverInfo))return;if(e.doc.admin)return;o.e(0).then(o.t.bind(null,467,7));const t=e.doc.serverInfo.localIp,n=e.doc.serverInfo.port;if(t&&t.length>0&&n>0){const o="https://"+t+":"+n+"/scanBarcode",c=(await e.doc.requestGet(o,{})).data.scan;c&&(console.log(c.search("HK")),0===c.search("HK")&&(console.log(h+" -> "+c),O(c)))}}),1e3);return async function(){e.doc.setCallback(void 0),console.log("======================================="),console.log("Return initialize")}(),()=>clearInterval(t)}),[]),Object(n.useEffect)((()=>{!async function(){if(t.length>0){var o;o=e.doc.admin?t:"HK"+t,console.log("Search book1 "+o);const n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",c={book:o,match:!0},s=(await e.doc.requestGet(n,c)).data.return;"books"in s&&"BOOKNAME"in s.books&&i(s.books)}}()}),[s,e.doc,t]),Object(n.useEffect)((()=>{!async function(){if(console.log("B"+h),h.length>0){const t=h;console.log("Search book2 "+t);const o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",n={book:t,match:!0},c=(await e.doc.requestGet(o,n)).data.return;console.log(c),"books"in c&&"BOOKNAME"in c.books&&i(c.books)}}()}),[h,e.doc]),Object(n.useEffect)((()=>{console.log("book updated "),"BARCODE"in l?1===l._STATE||3===l._STATE?d(!0):(console.log("Not rented"),j({id:f,text:e.text.NOT_RENTED,type:ne.c.TYPE.ERROR}),document.getElementById("barcodeScan").value=null,d(!1),O("")):d(!1)}),[l]),Object(n.useEffect)((()=>{if(!("text"in u))return;ne.c.dismiss();const e=b;e.type=u.type,e.autoClose=3e3,ne.c.info(u.text,e)}),[u]),Object(n.useEffect)((()=>{if(console.log("Returned updated"),console.log(g),!("localIp"in e.doc.serverInfo)||!("port"in e.doc.serverInfo))return;console.log("Update return list");const o="HK"+t;console.log("Search book1 "+o);const n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",c={books:g};e.doc.requestGet(n,c)}),[g,t,e.doc]),Object(a.jsxs)("div",{id:"checkOut",children:[Object(a.jsx)("div",{id:"title",children:Object(a.jsx)("h2",{children:e.text.return})}),Object(a.jsxs)("div",{id:"checkOutResult",children:[Object(a.jsxs)("div",{id:"bookInput",hidden:r,children:[Object(a.jsxs)("label",{id:"barcodeScan",hidden:!0,children:[Object(a.jsx)(je.a,{fontSize:"large",sx:{color:"#404040"}}),Object(a.jsx)("span",{})]}),Object(a.jsxs)("label",{id:"manualInput",children:[Object(a.jsx)("div",{id:"hkPrefix",children:e.text.numberOnly}),Object(a.jsx)("input",{inputMode:"numeric",pattern:"\\d*",type:"text",id:"searchInput",placeholder:e.text.bookHolder,onInput:e=>{c(e.target.value)}})]})]}),Object(a.jsxs)("div",{id:"checkReturn",hidden:!r,children:[Object(a.jsxs)("div",{id:"bookName",children:[" ",e.text.confirmReturn," "]}),Object(a.jsxs)("div",{id:"bookName",children:[" ",l.AUTHOR+":"," "]}),Object(a.jsxs)("div",{id:"bookName",children:[" ",l.BOOKNAME," "]}),Object(a.jsxs)("button",{id:"confirm",onClick:()=>async function(){console.log("Confirmed"),d(!1),console.log(l);const t="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/return",o={book:l.BARCODE},n=(await e.doc.requestPost(t,o)).data.return;if(console.log(n),"SUCCESS"===n)j({id:f,text:e.text.returnSucceed,type:ne.c.TYPE.SUCCESS}),g.push({id:l.BARCODE,name:l.BOOKNAME}),console.log(g),x(g);else{let t;t=n in e.text?e.text[n]:e.text.NOT_AVAILABLE,console.log(t),j({id:f,text:t,type:ne.c.TYPE.ERROR})}i({}),O("")}(),children:[" ",e.text.confirm," "]}),Object(a.jsxs)("button",{id:"cancel",onClick:()=>(console.log("Cancelled"),d(!1),i({}),void O("")),children:[" ",e.text.cancel," "]})]}),g.length>0&&Object(a.jsx)(M,{list:g,showCallback:e=>p(e)})]}),Object(a.jsxs)("button",{id:"logOutButton",onClick:()=>(async()=>{console.log("Finish"),m("/")})(),children:[" ",e.text.finish," "]})]})};o(256);var Oe=function(e){const[t,o]=Object(n.useState)(!1),[c,s]=Object(n.useState)(!0),[l,i]=Object(n.useState)({});function r(e,t){console.log(e),console.log(t);var o=l;switch(e){case 0:o.USER_NAME=t;break;case 1:o.PHONE_NUMBER=t;break;case 2:o.EMAIL=t;break;case 3:o.ADDRESS=t;break;case 4:o.USER_LEVEL=t;break;case 5:o.NOTICE=t}const n=Object.keys(o).length;console.log(n),n>1&&s(!1),i(o)}return Object(n.useEffect)((function(){console.log("User Info"),console.log(e.info),document.getElementById("userName").value=e.info.USER_NAME?e.info.USER_NAME:"",document.getElementById("phone").value=e.info.PHONE_NUMBER?e.info.PHONE_NUMBER:"",document.getElementById("email").value=e.info.EMAIL?e.info.EMAIL:"",document.getElementById("address").value=e.info.ADDRESS?e.info.ADDRESS:"",document.getElementById("notice_").value=e.info.NOTICE?e.info.NOTICE:"",document.getElementById("user_level").value=e.info.USER_LEVEL,i({USER_CODE:e.info.USER_CODE}),s(!0)}),[e.info]),Object(a.jsxs)("div",{children:[Object(a.jsx)("table",{children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{children:[" ",e.text.name," "]}),Object(a.jsx)("td",{colSpan:"3",children:Object(a.jsx)("input",{type:"text",className:"input",id:"userName",onChange:e=>{r(0,e.target.value)}})})]},"Name"),"REG_DATE"in e.info&&Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{children:[" ",e.text.registeredDate," "]}),Object(a.jsx)("td",{colSpan:"3",className:"data",children:e.info.REG_DATE})]},"Register"),Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{children:[" ",e.text.phone," "]}),Object(a.jsx)("td",{colSpan:"3",children:Object(a.jsx)("input",{type:"text",className:"input",id:"phone",onChange:e=>{r(1,e.target.value)}})})]},"Phone"),Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{children:[" ",e.text.email," "]}),Object(a.jsx)("td",{colSpan:"3",children:Object(a.jsx)("input",{type:"text",className:"input",id:"email",onChange:e=>{r(2,e.target.value)}})})]},"Email"),Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{children:[" ",e.text.address," "]}),Object(a.jsx)("td",{colSpan:"3",children:Object(a.jsx)("input",{type:"text",className:"input",id:"address",onChange:e=>{r(3,e.target.value)}})})]},"Address"),Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{children:[" ",e.text.notice_," "]}),Object(a.jsx)("td",{colSpan:"3",children:Object(a.jsx)("input",{type:"text",className:"input",id:"notice_",onChange:e=>{r(5,e.target.value)}})})]},"Notice"),Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{children:[" ",e.text.level," "]}),Object(a.jsx)("td",{colSpan:"3",className:"cell",children:Object(a.jsxs)("select",{name:"User Level",id:"user_level",className:"dropdown",onChange:e=>{r(4,e.target.value)},children:[Object(a.jsxs)("option",{value:"0",children:[" ",e.text.kid," "]}),Object(a.jsxs)("option",{value:"1",children:[" ",e.text.adult," "]}),Object(a.jsxs)("option",{value:"2",children:[" ",e.text.admin," "]})]})})]},"Level")]})}),Object(a.jsxs)("button",{id:"modify",hidden:t,onClick:async()=>o(!0),disabled:c,children:[" ",e.text.save," "]}),Object(a.jsxs)("div",{id:"checkModify",hidden:!t,children:[Object(a.jsxs)("div",{id:"noticeMsg",children:[" ",e.text.confirmSave," "]}),Object(a.jsxs)("button",{id:"confirm",onClick:()=>async function(){console.log("Save modification"),console.log(l);const t=e.doc.serverInfo.localIp,n=e.doc.serverInfo.port;if(0===t.length||n<=0)return;const c="https://"+t+":"+n+"/user";var s={};console.log(l);for(const e in l)s[e]=btoa(m(l[e]));const a=await e.doc.requestPost(c,s);console.log(a),e.refresh(a),o(!1)}(),children:[" ",e.text.confirm," "]}),Object(a.jsxs)("button",{id:"cancel",onClick:()=>{o(!1)},children:[" ",e.text.cancel," "]})]})]})};var ge=function(e){const[t,s]=Object(n.useState)(""),[i]=Object(X.a)(t,300),[r,u]=Object(n.useState)(!1),[h,O]=Object(n.useState)([]),[x,f]=Object(n.useState)(!1),[p,{loading:k,data:S,error:E}]=Object(d.a)(z),[y,N]=Object(n.useState)({}),I=Object(n.useRef)("0"),{id:C}=Object(v.r)(),[_,R]=Object(n.useState)([]),A=Object(v.p)();async function D(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(console.log("All data loaded "+x),t){const t=b;t.type=ne.c.TYPE.SUCCESS,t.render=e.text.succeededToOpen,t.autoClose=3e3,t.toastId="",ne.c.info(e.text.succeededToOpen,t)}console.log("Set title "+e.logged),console.log("Done"),f(!0)}function T(e){console.log("Refresh page "+r),console.log(e),u(!r)}Object(n.useEffect)((function(){!async function(){e.doc.initialized&&(e.doc.isOpen()?D(!1):e.doc.setCallback(D),console.log("======================================="),console.log("UserSearch initialize"),console.log("User ID: "+C),e.doc.serverAvailable?o.e(0).then(o.t.bind(null,467,7)):(console.log("Load users"),p()))}()}),[]),Object(n.useEffect)((()=>{console.log("Updated id: "+C),s(C||"")}),[C]),Object(n.useEffect)((()=>{console.log("User data updated "),D(!1)}),[e.logged]),Object(n.useEffect)((()=>{if(console.log("User list loaded"),console.log(E),console.log(k),S){const o=S.user;var t=[];console.log("User list available");for(let n=0;n<o.length;n++){const c=o[n],s={id:c._id,name:c.name,level:c.level,state:j(e.text,c.state)};t.push(s)}console.log(t),e.doc.setUser(t),console.log(e.doc.getUser()),N(e.doc.getUser())}}),[S,k,E,e]);const w=(t,o)=>{const n=t.id,s=t.rentDate,i=t.retDate,r=t.title,d=t.extendCount,u=o.toString();return Object(a.jsxs)(c.a.Fragment,{children:[Object(a.jsxs)("tr",{className:"bookData",children:[Object(a.jsx)("td",{className:"bookData",children:Object(a.jsx)(l.b,{to:"/search/"+n,children:n})}),Object(a.jsx)("td",{className:"bookData",children:s}),Object(a.jsx)("td",{className:"bookData",children:i})]},u),Object(a.jsxs)("tr",{className:"bookName",children:[Object(a.jsx)("td",{colSpan:e.doc.serverAvailable?"2":"3",className:"bookName",children:r}),e.doc.serverAvailable&&Object(a.jsx)("td",{className:"bookName",children:Object(a.jsx)("button",{className:"extend",onClick:()=>async function(t){console.log("Extend "+t);const o=e.doc.serverInfo.localIp,n=e.doc.serverInfo.port;if(0===o.length||n<=0)return;const c="https://"+o+":"+n+"/extend";var s={};s.book=t;const l=await e.doc.requestPost(c,s);if(console.log("Extended"),console.log(l),L(I.current,!0),"SUCCESS"===l.data.return){const t=b;t.type=ne.c.TYPE.SUCCESS,t.render=e.text.succeededToOpen,t.autoClose=3e3,t.toastId="",ne.c.info(e.text.extend,t)}}(n),children:e.text.extend+" ("+d.toString()+")"})})]},u+"Title")]},u+"Fragment")},L=async function(t){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=await e.doc.getRent(t);console.log(n),-1===I.current||I.current!==t||o?(console.log("Select "+t),I.current=t,console.log("Set Rent List"),console.log(n),R(n)):h.length>1&&(console.log("Deselect "+t),I.current=-1,R([]))},B=(t,o)=>Object(a.jsxs)("div",{children:[t.map(((e,t)=>((e,t,o)=>{const n=o.toString();return Object(a.jsxs)("div",{children:[Object(a.jsx)("table",{children:Object(a.jsx)("tbody",{children:Object(a.jsxs)("tr",{className:"searchTr",onClick:async()=>await L(e.id),children:[Object(a.jsx)("td",{className:"bookData",children:e.id}),Object(a.jsx)("td",{className:"bookData",children:e.name}),Object(a.jsx)("td",{className:"bookData",children:e.state}),Object(a.jsx)("td",{className:"bookData",children:e.rent})]},e.id)})}),e.id===I.current&&U(e,t)]},n)})(e,o,t))),0===t.length&&Object(a.jsx)("table",{children:Object(a.jsx)("tbody",{children:Object(a.jsx)("tr",{children:Object(a.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")})})]}),U=(t,o)=>(console.log("Detail"),console.log(t),Object(a.jsxs)(a.Fragment,{children:[e.doc.serverAvailable&&Object(a.jsxs)("div",{children:[Object(a.jsx)(Oe,{text:e.text,doc:e.doc,info:t,refresh:T}),Object(a.jsxs)("button",{id:"modify",onClick:()=>A("/checkOut/"+t.USER_CODE),children:[" ",e.text.checkOut," "]})]}),Object(a.jsx)("table",{children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{id:"id",children:e.text.id}),Object(a.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(a.jsx)("th",{id:"returnDate",children:e.text.dueDate})]},"ID"),o.map(((e,t)=>w(e,t))),0===o.length&&Object(a.jsx)("tr",{children:Object(a.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})]}));return Object(n.useEffect)((()=>{!async function(){const o=t.trim();if(console.log("Query "+o+" "+i),o.length>0&&i){let t;if(e.doc.serverAvailable){console.log("from CLIB");const n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/users",c={user:btoa(m(o))},s=await e.doc.requestGet(n,c),l=s.data.return.data;if(console.log(s.data.return),t=[],l)for(const o of s.data.return.data){console.log(o);let n=o;n.id=o.USER_CODE,n.name=o.USER_NAME,n.state=j(e.text,o.USER_STATE),n.rent=o._RENT.length,t.push(n)}}else console.log("from DB"),t=await async function(e){let t=[];for(const o in y){const n=y[o];if(t.length>=500)break;(n.name&&n.name.toString().includes(e)||n.id.toLowerCase()===e.toLowerCase())&&t.push(n)}return t.sort(g),console.log(t),t}(i);t.length>0?O(t):O([]),1===t.length?L(t[0].id):L(0)}else O([])}()}),[i,e,y,r,t]),e.doc.initialized?Object(a.jsxs)("div",{id:"checkOut",children:[Object(a.jsx)("div",{id:"title",children:Object(a.jsx)("h2",{children:e.text.userSearch})}),Object(a.jsxs)("div",{id:"checkOutInput",hidden:!e.doc.admin,children:[Object(a.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:t,onChange:e=>{s(e.target.value)}}),Object(a.jsx)("div",{children:Object(a.jsx)(M,{keyValue:i,list:h,detail:_,showCallback:(e,t)=>B(e,t)})})]})]}):Object(a.jsx)(v.a,{to:"/"})};var xe=function(e){const[t,s]=Object(n.useState)([]),[i,r]=Object(n.useState)(!1),[u,{loading:b,data:O,error:g}]=Object(d.a)(z),[m,f]=Object(n.useState)({});async function p(){if(console.log("All data loaded "+i),e.doc.serverAvailable){let t=[];const o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",n={user:"*",match:!1},c=(await e.doc.requestGet(o,n)).data.return.books;for(let s=0;s<c.length;s++){const o=c[s],n="".concat(o.BOOKNAME," ").concat(o.CLAIMNUM),l=o._STATE;let a="";1!==l&&3!==l&&"1"!==l&&"3"!==l||(a=o.RETURN_DATE);let i={index:s,text:n,title:o.BOOKNAME,id:o.BARCODE,rent:h(e.text,o.STATS.toString()),rentDate:o.LENT_DATE,retDate:a,author:o.AUTHOR,totalName:o.TOTAL_NAME,claim_num:o.CLAMENUM,publish:o.PUBLISH,claim:o.CLAIM,user:o.USER,userName:o.USER_NAME};t.push(i)}t.sort(x),s(t)}else{const t=await e.doc.getRent();console.log("Rent"),console.log(t),t.sort(x);for(const e in t){const o=t[e].user;let n;n=m&&o in m?m[o].name:"",t[e].userName=n}s(t)}console.log("Done"),r(!0)}Object(n.useEffect)((function(){!async function(){console.log("======================================="),console.log("RentHistory initialize"),e.doc.serverAvailable?(o.e(0).then(o.t.bind(null,467,7)),p()):(console.log("Load users"),u())}()}),[]),Object(n.useEffect)((()=>{if(console.log("User list loaded"),console.log(g),console.log(b),O){const o=O.user;var t=[];console.log("User list available");for(let n=0;n<o.length;n++){const c=o[n],s={id:c._id,name:c.name,level:c.level,state:j(e.text,c.state)};t.push(s)}e.doc.setUser(t),f(e.doc.getUser())}}),[O,b,g,e.doc,e.text]),Object(n.useEffect)((()=>{p()}),[m]);const k=t=>Object(a.jsx)("div",{children:Object(a.jsx)("table",{children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{id:"id",children:e.text.id}),Object(a.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(a.jsx)("th",{id:"returnDate",children:e.text.dueDate})]},"ID"),t&&t.map(((e,t)=>((e,t)=>{const o=e.id,n=e.rentDate,s=e.retDate,i=e.user,r=e.userName,d=t.toString(),u=e.claim;return Object(a.jsxs)(c.a.Fragment,{children:[Object(a.jsxs)("tr",{className:"bookTop",children:[Object(a.jsx)("td",{className:"bookCell",children:Object(a.jsx)(l.b,{to:"/search/"+o,children:o})}),Object(a.jsx)("td",{className:"bookCell",children:n}),Object(a.jsx)("td",{className:"bookCell",children:s})]},d),Object(a.jsxs)("tr",{className:"bookRow",children:[Object(a.jsx)("td",{className:"bookName",children:u}),Object(a.jsxs)("td",{colSpan:"2",className:"bookName",children:[e.totalName+" ",Object(a.jsx)("b",{children:e.title})," "+e.claim_num]})]},d+"Title"),Object(a.jsxs)("tr",{className:"bookBottom",children:[Object(a.jsx)("td",{className:"bookCell",children:Object(a.jsxs)(l.b,{to:"/userSearch/"+i,children:[" ",i," "]})}),Object(a.jsxs)("td",{colSpan:"2",className:"bookCell",children:[" ",r," "]})]},d+"Renter")]},d+"Fragment")})(e,t))),t&&0===t.length&&Object(a.jsx)("tr",{children:Object(a.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})});return e.doc.initialized?Object(a.jsxs)("div",{id:"situation",children:[Object(a.jsx)("div",{id:"title",children:Object(a.jsx)("h2",{children:e.text.situation})}),Object(a.jsx)("div",{id:"checkOutResult",children:Object(a.jsx)(M,{keyValue:"",list:t,showCallback:e=>k(e)})})]}):Object(a.jsx)(v.a,{to:"/"})};var me=function(e){const[t,s]=Object(n.useState)([]),[i,r]=Object(n.useState)(""),[u,b]=Object(n.useState)(""),[h,{loading:O,data:g,error:m}]=Object(d.a)(z),[f,{loading:p,data:k,error:E}]=Object(d.a)(Y,{variables:{fromTime:i,toTime:u}}),[N,I]=Object(n.useState)({}),[C,_]=Object(n.useState)(0),[R,A]=Object(n.useState)(0),[D,T]=Object(n.useState)(""),[w]=Object(X.a)(D,300);Object(n.useEffect)((function(){!async function(){if(console.log("======================================="),console.log("RentHistory initialize"),!e.doc.initialized)return;var t,n,c=document.getElementById("year"),s=document.getElementById("month");for(t=1;t<=12;t++)(n=document.createElement("option")).text=t.toString(),s.add(n,t);const l=(new Date).getFullYear(),a=(new Date).getMonth()+1;for(t=2017;t<=l;t++)(n=document.createElement("option")).text=t.toString(),c.add(n,t);console.log(l),console.log(a),_(l),A(a),document.getElementById("year").value=l,document.getElementById("month").value=a,e.doc.serverAvailable?o.e(0).then(o.t.bind(null,467,7)):(console.log("Load users"),h())}()}),[]),Object(n.useEffect)((()=>{if(console.log("User list loaded"),console.log(m),console.log(O),g){const o=g.user;var t=[];console.log("User list available");for(let n=0;n<o.length;n++){const c=o[n],s={id:c._id,name:c.name,level:c.level,state:j(e.text,c.state)};t.push(s)}e.doc.setUser(t),I(e.doc.getUser())}}),[g,O,m,e.doc,e.text]),Object(n.useEffect)((()=>{if(console.log("History update"),!k)return;const t=k.rentLog;let o=[],n="";for(let s=0;s<t.length;s++){const a=t[s],i=a.book_state;if("1"!==i&&1!==i)continue;if(!a.return_date||0===a.return_date.length)continue;const r=a.book_id,d=a.user_id;var c,l;c=N&&d in N?N[d].name:"",r in e.doc.book?l=e.doc.book[r]:((l={}).author="",l.totalName="",l.claim_num="",l.publish="",l.title="");const u="".concat(l.title," ").concat(l.claim_num);n=a.return_date;let b={index:s,text:u,title:l.title,id:r,rentDate:a.timestamp,retDate:n,author:l.author,totalName:l.series,claim_num:l.claim_num,publish:l.publisher,claim:l.claim,user:d,userName:c};o.push(b)}o.sort(x),console.log(o),s(o)}),[k,p,E]);const L=t=>Object(a.jsx)("div",{children:Object(a.jsx)("table",{children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{id:"id",children:e.text.id}),Object(a.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(a.jsx)("th",{id:"returnDate",children:e.text.returnDate})]},"ID"),t&&t.map(((e,t)=>((e,t)=>{const o=e.id,n=e.rentDate,s=e.retDate,i=e.claim,r=e.user,d=e.userName,u=t.toString();return Object(a.jsxs)(c.a.Fragment,{children:[Object(a.jsxs)("tr",{className:"bookTop",children:[Object(a.jsx)("td",{className:"bookCell",children:Object(a.jsx)(l.b,{to:"/search/"+o,children:o})}),Object(a.jsx)("td",{className:"bookCell",children:n}),Object(a.jsx)("td",{className:"bookCell",children:s})]},u),Object(a.jsxs)("tr",{className:"bookRow",children:[Object(a.jsx)("td",{className:"bookName",children:i}),Object(a.jsxs)("td",{colSpan:"2",className:"bookCell",children:[e.totalName+" ",Object(a.jsx)("b",{children:e.title})," "+e.claim_num]})]},u+"Title"),Object(a.jsxs)("tr",{className:"bookBottom",children:[Object(a.jsx)("td",{className:"bookCell",children:Object(a.jsxs)(l.b,{to:"/userSearch/"+r,children:[" ",r," "]})}),Object(a.jsxs)("td",{colSpan:"2",className:"bookCell",children:[" ",d," "]})]},u+"Renter")]},u+"Fragment")})(e,t))),t&&0===t.length&&Object(a.jsx)("tr",{children:Object(a.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})});function B(e,t){switch(console.log(e),console.log(t),e){case 0:_(t);break;case 1:A(parseInt(t))}}return Object(n.useEffect)((function(){T(C.toString()+"-"+R.toString().padStart(2,"0"))}),[C,R]),Object(n.useEffect)((function(){!async function(){if(console.log("Search"),e.doc.serverAvailable){const t="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/history",o={period:D},n=await e.doc.requestGet(t,o);console.log(n);const c=n.data.return.books;let l=[],a="";for(let e=0;e<c.length;e++){const t=c[e],o="".concat(t.BOOKNAME," ").concat(t.CLAIMNUM);"_RETURN_DATE"in t&&(a=t._RETURN_DATE);let n={index:e,text:o,title:t.BOOKNAME,id:t.BARCODE,rentDate:t.RENT_DATE,retDate:a,author:t.AUTHOR,totalName:t.TOTAL_NAME,claim_num:t.CLAMENUM,publish:t.PUBLISH,claim:t.CLAIM,user:t.USER,userName:t.USER_NAME};l.push(n)}l.sort(x),s(l)}else{var t;const e=R+1;t=C.toString()+"-"+e.toString().padStart(2,"0"),r(D),b(t),console.log(D),console.log(t);try{await f()}catch(o){console.warn(o.name)}}}()}),[w]),e.doc.initialized?Object(a.jsxs)("div",{id:"checkOut",children:[Object(a.jsx)("div",{id:"title",children:Object(a.jsx)("h2",{children:e.text.history})}),Object(a.jsxs)("div",{id:"searchRange",children:[Object(a.jsx)("div",{className:"page",id:"page",children:Object(a.jsx)(S.a,{fontSize:"large",sx:{color:"#404040"},onClick:()=>{!function(){var e=C,t=R;"string"===typeof e&&(e=parseInt(e)),"string"===typeof t&&(t=parseInt(t)),console.log(e),console.log(t),console.log(typeof e),console.log(typeof t),t>1?t-=1:(e-=1,t=12),_(e),A(t),document.getElementById("year").value=e,document.getElementById("month").value=t}()}})}),Object(a.jsx)("select",{name:"year",id:"year",className:"dropdown",onChange:e=>{B(0,e.target.value)}}),Object(a.jsx)("select",{name:"month",id:"month",className:"dropdown",onChange:e=>{B(1,e.target.value)}}),Object(a.jsx)("div",{className:"page",id:"page",children:Object(a.jsx)(y.a,{fontSize:"large",sx:{color:"#404040"},onClick:()=>{!function(){var e=C,t=R;"string"===typeof e&&(e=parseInt(e)),"string"===typeof t&&(t=parseInt(t)),console.log(e),console.log(t),console.log(typeof e),console.log(typeof t),t<12?t+=1:(e+=1,t=1),_(e),A(t),document.getElementById("year").value=e,document.getElementById("month").value=t}()}})})]}),Object(a.jsx)("div",{id:"checkOutResult",children:Object(a.jsx)(M,{keyValue:w,list:t,showCallback:e=>L(e)})})]}):Object(a.jsx)(v.a,{to:"/"})};var fe=function(e){const[t,c]=Object(n.useState)({}),[s,l]=Object(n.useState)(!1);function i(){var e={USER_CODE:"",USER_NAME:"",PHONE_NUMBER:"",EMAIL:"",ADDRESS:"",NOTICE:"",USER_LEVEL:-1};c(e)}return Object(n.useEffect)((function(){!async function(){e.doc.initialized&&e.doc.serverAvailable&&(o.e(0).then(o.t.bind(null,467,7)),console.log("======================================="),console.log("NewMember initialize"),i())}()}),[]),e.doc.initialized&&e.doc.serverAvailable?Object(a.jsxs)("div",{id:"checkOut",children:[Object(a.jsx)("div",{id:"title",children:Object(a.jsx)("h2",{children:e.text.newMember})}),Object(a.jsx)("div",{id:"checkOutInput",hidden:!e.doc.admin,children:e.doc.serverAvailable&&Object(a.jsx)(Oe,{text:e.text,doc:e.doc,info:t,refresh:function(t){console.log("Refresh page "+s),console.log(t),l(!s);const o=b;var n;"OK"===t.data.return?(o.type=ne.c.TYPE.SUCCESS,n=e.text.regSuccess,i()):(o.type=ne.c.TYPE.ERROR,n=e.text.regFail),o.autoClose=3e3,ne.c.info(n,o)}})})]}):Object(a.jsx)(v.a,{to:"/"})},pe=(o(257),o(461));var ve=class{constructor(){console.log("Create Doc class"),this.initialized=!1,this.bookReady=!1,this.rentReady=!1,this.userReady=!1,this.logged=!1,this.userInfo={},this.book={},this.rent={},this.request=new Set,this.logCallback=void 0,this.admin=!1,this.dueDate="",this.serverInfo={},this.serverAvailable=!1,this.ipAddr=""}async requestGet(e,t){t.os=navigator.platform;const o={params:t};console.log("Request GET : "+e);return await pe.a.get(e,o)}async requestPost(e,t){console.log("Request POST: "+e),t.os=navigator.platform;return await pe.a.post(e,t)}async updateIpAddr(){}checkServerIp(){}checkState(){this.bookReady&&this.rentReady&&(this.initialized=!0,ne.c.dismiss(),this.callback&&this.callback())}setLogCallback(e){this.logCallback=e}setRent(e){this.rent=e,this.rentReady=!0,this.checkState(),this.checkRent()}setRequest(e){for(const t of e)this.request.add(t.book_id)}hasRequest(e){return this.request.has(e)}addRequest(e){this.request.add(e)}setServerInfo(e){console.log(e),this.serverInfo=e,this.serverInfo={},this.serverInfo.globalIp=e.globalIp,e.proxy?(this.serverInfo.localIp="libserver.hkmcclibrary.duckdns.org",this.serverInfo.port=443):(this.serverInfo.localIp=e.localIp,this.serverInfo.port=e.port),console.log(this.serverInfo),this.checkServerIp()}setBook(e){this.book={};for(let t=0;t<e.length;t++){const o=e[t],n=o._id;this.book[n]={...o},this.book[n].claim=o.claim.replace(/_/g," ")}this.bookReady=!0,this.checkState()}setUser(e){this.user={};for(let t=0;t<e.length;t++){const o=e[t],n=o.id;this.user[n]=o,this.user[n].rent=0}this.userReady=!0,this.checkRent()}checkRent(){if(this.userReady&&this.rentReady)for(let e=0;e<this.rent.length;e++){const t=this.rent[e].state;if("1"!==t&&"3"!==t&&1!==t&&3!==t)continue;const o=this.rent[e].user_id;o&&o.length>0&&o in this.user?"rent"in this.user[o]?this.user[o].rent+=1:this.user[o].rent=1:(console.log("Invalid user"),console.log(this.rent[e]))}else console.log("Cannot check rent")}logIn(e){console.log("Logged in: "+e._id),this.logged=!0,this.userInfo=e,"2"!==e.level&&2!==e.level||(this.admin=!0),this.logCallback&&this.logCallback(!0)}logOut(){console.log("Logged out"),this.logged=!1,this.admin=!1,this.userInfo={},this.request.clear(),this.logCallback&&this.logCallback(!1)}async getRent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=[];if(this.serverAvailable){const o="https://"+this.serverInfo.localIp+":"+this.serverInfo.port+"/book",n={user:e},c=await this.requestGet(o,n);if(console.log(c),"books"in c.data.return)for(const e of c.data.return.books){console.log(e);const o={id:e.BARCODE,title:e.BOOKNAME,claim:e.CLAIM,claim_num:e.CLAMENUM,totalName:e.TOTAL_NAME,rentDate:e.LENT_DATE,retDate:e.RETURN_DATE,stat:e.STATS,extendCount:e._EXTEND_COUNT};t.push(o)}}else{if(console.log("Check "+e),console.log(this.bookReady),!this.bookReady)return t;for(let o=0;o<this.rent.length;o++){const n=this.rent[o];if(void 0!==e&&n.user_id!==e)continue;if("1"!==n.state&&"3"!==n.state&&1!==n.state&&3!==n.state)continue;const c=n.book_id,s=this.book[c];let l={};l.id=s._id,l.title=s.title,l.claim_num=s.claim_num,l.totalName=s.series,l.rentDate=n.rent_date.split(" ")[0].replace("-","/",2).replace("-","/"),l.retDate=n.return_date.split(" ")[0].replace("-","/",2).replace("-","/"),l.claim=s.claim,l.user=n.user_id,l.extendCount=n.extend_count,t.push(l)}}return t}getUser(){return this.user}async openDoc(){try{this.initialized=!0}catch(e){return console.log(e),!1}return!0}isOpen(){return this.initialized}setCallback(e){console.log("Update function registered"),this.callback=e}},ke=o(460),Se=o(453),Ee=o(454),ye=o(89);const Ne=o(261);var Ie=class{constructor(e){console.log("Create Context"),console.log("Cookies");const t=document.cookie;this.cookie=t.split(";").map((e=>e.split("="))).reduce(((e,t)=>{const o=t.shift().trim(),n=t.join("=").trim();return e[decodeURIComponent(o)]=decodeURIComponent(n),e}),{});const o=e.REACT_APP_AWSS_KEY1+e.REACT_APP_AWSS_KEY2,n=e.REACT_APP_AWSS_SECRET1+e.REACT_APP_AWSS_SECRET2,c={region:ye.region,credentials:{accessKeyId:o,secretAccessKey:n}};this.sqsClient=new ke.a(c)}checkLogIn(e,t){var o,n=!1;if(e&&t.length>0){console.log("User data available");const s=e.encrypted_email,l=e.encrypted_phone,a=new Ne(ye.privateKey);if(o=a.sign(t,"base64"),t===s||t===l)o=t,n=!0;else if(s===o)n=!0;else{var c="";for(let e=0;e<t.length;e++)isNaN(t[e])||(c+=t[e]);(o=a.sign(c,"base64"))===l&&(n=!0)}}if(n){const e=new Date,t=2;e.setTime(e.getTime()+24*t*60*60*1e3);const n=e.toGMTString();document.cookie="password="+o+"; expires="+n+" ; SameSite=Lax ;"}return n}async sendRequest(e){const t=Math.floor(1e8*Math.random()).toString();try{const o=new Se.a({MessageBody:e,QueueUrl:ye.queue_url,MessageGroupId:"1",MessageDeduplicationId:t});await this.sqsClient.send(o)}catch(o){console.log(o)}}async receiveRequest(){console.log("Read request");var e=[];try{const t=new Ee.a({QueueUrl:ye.queue_url,AttributeNames:[""],MessageAttributeNames:["STRING_VALUE"],MaxNumberOfMessages:100,VisibilityTimeout:5,WaitTimeSeconds:5}),o=await this.sqsClient.send(t);if(console.log(o),void 0!==o.Messages)for(const n of o.Messages){const t=JSON.parse(n.Body);e.push(t)}}catch(t){console.log(t)}return e}},Ce=o(148),_e=o(227),Re=(o(413),o(414),o(228)),Ae=o.n(Re);var De=function(e){const[t,c]=Object(n.useState)(!1);Object(n.useEffect)((()=>{e.doc.serverAvailable&&o.e(4).then(o.t.bind(null,468,7)),t&&setTimeout((function(){console.log("Register close"),window.addEventListener("click",s)}),100);const n=document.getElementById("dropdown-menu");return t?n.classList.add("is-show"):n.classList.remove("is-show"),()=>{window.removeEventListener("click",s)}}),[t,e.doc.logged,e.doc.serverAvailable]);const s=()=>{console.log("Close"),console.log(t),c(!1),window.removeEventListener("click",s)};return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:"menu",onClick:()=>{console.log("Click menu"),c(!t),console.log(t),t&&window.removeEventListener("click",s)},children:Object(a.jsx)(Ae.a,{className:"img",fontSize:"large",sx:{color:"#ffffff"}})}),Object(a.jsxs)("div",{id:"dropdown-menu",onClick:()=>{s()},className:"dropdown-menu",children:[!e.doc.serverAvailable&&e.doc.logged&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{className:"menu-items",children:e.doc.userInfo._id+" : "+e.doc.userInfo.name+e.text.nameSuffix}),Object(a.jsx)("hr",{className:"hline"})]}),Object(a.jsx)(l.b,{className:"menu-items",to:"/",children:e.text.home}),Object(a.jsx)(l.b,{className:"menu-items",to:"/notice",children:e.text.notice}),Object(a.jsx)(l.b,{className:"menu-items",to:"/search",children:e.text.bookSearch}),e.doc.serverAvailable&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(l.b,{className:"menu-items",to:"/checkOut",children:e.text.checkOut}),Object(a.jsx)(l.b,{className:"menu-items",to:"/return",children:e.text.return})]}),!e.doc.serverAvailable&&e.doc.logged&&Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(l.b,{className:"menu-items",to:"/checkOutStatus",children:e.text.checkOutStatus})}),e.doc.admin&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("hr",{className:"hline"}),Object(a.jsx)(l.b,{className:"menu-items",to:"/userSearch",children:e.text.userSearch}),Object(a.jsx)(l.b,{className:"menu-items",to:"/rentalSituation",children:e.text.situation}),Object(a.jsx)(l.b,{className:"menu-items",to:"/rentHistory",children:e.text.history})]}),e.doc.serverAvailable&&e.doc.admin&&Object(a.jsx)(l.b,{className:"menu-items",to:"/newMember",children:e.text.newMember}),!e.doc.serverAvailable&&e.doc.logged&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("hr",{className:"hline"}),Object(a.jsx)("div",{className:"menu-items",onClick:()=>{e.doc.logOut(),document.cookie="user_id=",document.cookie="password=",document.cookie="autoLogin=false"},children:e.text.logOut})]}),!e.doc.serverAvailable&&!e.doc.logged&&Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(l.b,{className:"menu-items",to:"/checkOutStatus",children:e.text.logIn})})]})]})};var Te=function(e){return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{id:"navbar",className:"navbar",children:[Object(a.jsx)("div",{className:"title",children:_e.isMobile?Object(a.jsx)("h1",{children:e.text.titleShort}):Object(a.jsx)("h1",{children:e.text.titleLong})}),Object(a.jsx)(De,{text:e.text,doc:e.doc})]})})};const we=new ve;let Le;const Be={};let Ue="";var Me=function(){const[e,t]=Object(n.useState)(!1),[o,c]=Object(n.useState)(!1),[s,u]=Object(n.useState)(""),{loading:j,error:h,data:O}=Object(r.e)(K),[g,{data:x}]=Object(d.a)($,{variables:{user_id:s}}),{loading:m,error:p,data:k}=Object(r.e)(Z),[S,{loading:E,error:y,data:N}]=Object(d.a)(H),[I,{data:C}]=Object(d.a)(F,{variables:{_id:s}});function _(){const e=b;e.type=ne.c.TYPE.SUCCESS,e.render=Be.succeededToOpen,e.autoClose=3e3,e.toastId="",ne.c.info(Be.succeededToOpen,e)}function R(e){console.log("==== Update logging state "+we.logged),c(we.logged)}return Object(n.useEffect)((function(){!async function(){console.log("Initialize app"),console.log("Platform: "),console.log(navigator.platform),Ue+="<p>Initialize app</p>",console.log("library"),console.log("0.9.10"),Le=new Ie(Object({NODE_ENV:"production",PUBLIC_URL:"/library",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AWSS_KEY1:"AKIARJHWVM",REACT_APP_AWSS_KEY2:"Y4YGU3MDMX",REACT_APP_AWSS_SECRET1:"Xvk2fxmia49bRets3DvZ",REACT_APP_AWSS_SECRET2:"G0bqmrQvaiBofvpnfQ7Q",REACT_APP_NAME:"library",REACT_APP_VERSION:"0.9.10"}));const e=navigator.languages;console.log(e);let o={};o=e.length>0&&(e[0].toLowerCase().includes("kr")||e[0].toLowerCase().includes("ko"))?Ce.kr:Ce.en;for(let t in o)Be[t]=o[t];await we.updateIpAddr(),"autoLogin"in Le.cookie&&"true"===Le.cookie.autoLogin&&(console.log("Auto Login: "+Le.cookie.user_id),u(Le.cookie.user_id),console.log(Le.cookie.nothing),I()),t(!0),console.log("Download book file");const n={method:"get",headers:{"Content-Type":"application/gzip","Access-Control-Allow-Origin":"https://github.com"}};console.log(n),fetch("https://github.com/linupa/hkmccBook/blob/main/book.json.gz",n),console.log("Done")}()}),[I]),Object(n.useEffect)((()=>{if(console.log("User data loaded"),!C)return;const e=C.user[0];Le.cookie.password&&Le.checkLogIn(e,Le.cookie.password)&&(console.log("Login suceeded"),we.logIn(e),g())}),[C,g]),Object(n.useEffect)((()=>{console.log("Rent Query Updated"),Ue=Ue+"<p>Rent Query Updated "+j+" "+h+"</p>",console.log(j),console.log("Rent Error"),console.log(h),O&&(console.log("Rent available"),Ue+="<p>Rent available</p>",we.setRent(O.rent),we.initialized&&_())}),[j,h,O]),Object(n.useEffect)((()=>{console.log("Request Query Updated"),x&&(console.log("Request available"),we.setRequest(x.request))}),[x]),Object(n.useEffect)((()=>{console.log("Book Query Updated"),Ue+="<p>Book Query Updated</p>",console.log(E),console.log(y),N&&(console.log("Book available"),Ue+="<p>Book available</p>",we.setBook(N.book),we.initialized&&_())}),[E,y,N]),Object(n.useEffect)((()=>{if(console.log("Server Query Updated"),Ue+="<p>Server Query Updated</p>",console.log(k),console.log(e),k&&e&&(console.log("Server info available"),Ue+="<p>Server info available</p>",console.log(k),we.setServerInfo(k.serverInfo),!we.serverAvailable)){console.log("Server is not available. Load books from cloud DB"),S();const e=b;e.type=ne.c.TYPE.LOADING,e.autoClose=!1,e.toastId=f,ne.c.loading(Be.loading,e),we.setLogCallback(R)}}),[m,p,k,S,e]),Object(a.jsx)(l.a,{children:Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)("div",{children:Object(a.jsx)(ne.a,{newestOnTop:!0,closeOnClick:!0,rtl:!1,draggable:!0,pauseOnHover:!0,pauseOnFocusLoss:!1,transition:ne.b,limit:10})}),Object(a.jsx)(Te,{doc:we,text:Be}),Object(a.jsxs)(v.d,{children:[Object(a.jsx)(v.b,{path:"/",element:Object(a.jsx)(i,{doc:we,text:Be})}),Object(a.jsx)(v.b,{path:"/notice/:id?",element:Object(a.jsx)(J,{doc:we,text:Be})}),Object(a.jsx)(v.b,{path:"/search/:id?",element:Object(a.jsx)(oe,{doc:we,text:Be})}),Object(a.jsx)(v.b,{path:"/checkOutStatus",element:Object(a.jsx)(ae,{context:Le,doc:we,text:Be,logged:o})}),Object(a.jsx)(v.b,{path:"/userSearch/:id?",element:Object(a.jsx)(ge,{context:Le,doc:we,text:Be})}),Object(a.jsx)(v.b,{path:"/checkOut/:id?",element:Object(a.jsx)(ue,{context:Le,doc:we,text:Be})}),Object(a.jsx)(v.b,{path:"/return",element:Object(a.jsx)(he,{context:Le,doc:we,text:Be})}),Object(a.jsx)(v.b,{path:"/rentalSituation",element:Object(a.jsx)(xe,{context:Le,doc:we,text:Be})}),Object(a.jsx)(v.b,{path:"/rentHistory",element:Object(a.jsx)(me,{context:Le,doc:we,text:Be})}),Object(a.jsx)(v.b,{path:"/newMember",element:Object(a.jsx)(fe,{context:Le,doc:we,text:Be})})]}),Object(a.jsxs)("h3",{children:["v ","0.9.10"]})]})})};var Pe=e=>{e&&e instanceof Function&&o.e(5).then(o.bind(null,469)).then((t=>{let{getCLS:o,getFID:n,getFCP:c,getLCP:s,getTTFB:l}=t;o(e),n(e),c(e),s(e),l(e)}))},qe=o(463),He=o(462),Ke=o(464),ze=o(459);const Fe=new qe.a({link:new He.a({uri:"https://hkmcc-library.hasura.app/v1/graphql",headers:{"x-hasura-admin-secret":"bkkZk6R6B9zITCmVyVDCtjDLWURfW4lC0ye04GP4UWN77ASpl69W6bk4BvyjN9ZH"}}),cache:new Ke.a}),Ve=document.getElementById("root");Object(s.createRoot)(Ve).render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(ze.a,{client:Fe,children:Object(a.jsx)(Me,{})})})),Pe()},47:function(e,t,o){},89:function(e){e.exports=JSON.parse('{"privateKey":"-----BEGIN RSA PRIVATE KEY-----\\nMIICYAIBAAKBgQCrjaN6qZ81C0wl1uegCHbI/psEvpTNzBCS42ZwvVDq2y69kXfx\\nkDygmKqWi8rTFm6lx474GOAKpneEQ3ragP017HbW55hrXhQu2jK/UE5OPdIImPF5\\nY2v28y0WEdWd0h6/4S28lSE5nG0IigsfuIh0FIvH9vGVwBqCPm1DOEAUIQIDAQAB\\nAoGAE/ZVUY6vUfLQl46cQUj62YSW8URj+FaIjy8a2n+NDOcYV0K4HEnWZDGfmAkI\\nPuvbUDsabdAnMdYRDjjz1H7L4Y52vU+ZqD3+kJ3iUsR9Ba+R17zS6F4HVNPCzUDI\\nOpgE+z8od8+on2cppBPHMEl/Ze+CcKYLz7bLs8zje8QHZMkCRQDyuEx9WQSCf0LS\\nds+jwr7npwVlbb737oal6UKuVzKv039aLaxBpsAeMQsSdXgBq2E2ChmC8SmPuB0V\\n0mutfSBu2UapkwI9ALTwh/iFkje7O/1wjCVZn4TnLz6a4nx676rydpsRy2PrDyQ3\\naC5SWmzQezeSTs9Qmbhxm4ZTj3Co4aeL+wJEC+zqNS5ufkrqaZTU1uL2pkMajMU7\\noMrjartvP0mhf+oQU8nysLcUsWcPeDS1VL+q4xDT+A8JT7poE25nQ/rl4Qxj4GkC\\nPQCR+zoIlWOZ2VMWMBayD7P22zqvzPCMM/dnuYVdqSaqr7wgoR9JuCHChxXSiRVS\\niBntyKMM5h/laivdLL8CRGdrBwiAkVrYnghDj+9UJX9Twox3oahPqYhzxWJR7jZ4\\nipOKhw9r+YfZDNDYpVgE+g2KB75tZlOU9Hx7dXyzANnsIueT\\n-----END RSA PRIVATE KEY-----\\n","queue_url":"https://sqs.us-west-1.amazonaws.com/088564131385/HKMCCLibraryRequest.fifo","region":"us-west-1"}')}},[[416,2,3]]]);
//# sourceMappingURL=main.f6c52165.chunk.js.map