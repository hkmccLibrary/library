(this.webpackJsonplibrary=this.webpackJsonplibrary||[]).push([[1],{148:function(e){e.exports=JSON.parse('{"en":{"titleLong":"Holy Korean Martyrs Catholic Church Library","titleShort":"HKMCC Library","idHolder":"Enter User ID","pwHolder":"Enter email or phone","bookHolder":"Enter book ID","logIn":"Log In","logOut":"Log Out","logInSucceed":"Logged in","logInFail":"Log In Failed","nameSuffix":"","home":"Home","checkOutStatus":"Check Out Status","bookSearch":"Book Search","userSearch":"User Search","checkOut":"Check Out","return":"Return","extend":"Extend","history":"Rent History","situation":"Rent State","loading":"Loading DB","succeededToOpen":"Succeeded to load","searchUser":"Enter name or ID","searchBook":"Enter book keywords","failedToOpen":"Failed to open DB Refresh page later","all":"All","available":"Available","checkedOut":"Checked out","reserved":"Reserved","overDue":"Overdue","lost":"Lost","damaged":"Damanged","given":"Given","notAvailable":"Not available","deleted":"Deleted","id":"ID","bookName":"Book name","rentDate":"Rent date","returnDate":"Return date","dueDate":"Due date","noEntry":"No entry","notice":"Notice","newMember":"New Member","autoLogin":"AutoLogin","userMode":"User Mode","adminMode":"Admin Mode","normal":"Normal","stopped":"Stopped","homeText":"<div class=\\"container\\"><h2>Library Hours:</h2> <ul> <li>Every Sunday 9:30am~12:00pm</li> </ul> <h2>Book Borrowing:</h2> <ul> <li>Every Sunday 10:30am~12:00pm</li> <li>Maximum number of books for borrowing: 5</li> <li>Borrowing period: 3 weeks (Please request an extension from a volunteer at the time of borrowing or send an extension request email to <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>)</li> <li>Book return: Please return the books to the return box in front of the library or directly to the library volunteers.</li> <li>Request for desired books: Please fill out and submit the desired book request form provided at the library.</li> </ul> <h2>For other inquiries:</h2> <ul> <li>Please contact the library by email at <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>.</li> </ul></div>","INVALID_BOOK":"Unregistered book","INVALID_USER":"Invalid user","NOT_AVAILABLE":"Not available","OVERDUE":"Overdue account","RENTED":"Already rented book","MAX_RENTAL":"Max rent reached","NOT_RENTED":"Not a rented book","rentSucceed":"Rented","returnSucceed":"Returned","rentSuffix":" book(s) rented","confirmRent":"Rent this book?","confirmReturn":"Return this book?","confirm":"Confirm","cancel":"Cancel","name":"Name","registeredDate":"Registered","phone":"Phone","email":"Email","address":"Address","notice_":"Notice","level":"Level","save":"Save","confirmSave":"Save the modification?","kid":"Kid","adult":"Adult","admin":"Admin","regSuccess":"Registration Succeed","regFail":"Registration Fail","numberOnly":"Number Only","advSearch":"Advanced Search","search":"Search","author":"Author","bookCode":"Book code","finish":"Finish","extending":"Extend requested","maxExtend":"Max Extended"},"kr":{"titleLong":"\ucc9c\uc8fc\uad50 \uc0b0\ud638\uc138 \ud55c\uad6d \uc21c\uad50\uc790 \uc131\ub2f9 \ub3c4\uc11c\uad00","titleShort":"HKMCC \ub3c4\uc11c\uad00","idHolder":"\ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","pwHolder":"\uc774\uba54\uc77c\uc774\ub098 \uc804\ud654\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","bookHolder":"\ub3c4\uc11c \ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","logIn":"\ub85c\uadf8\uc778","logOut":"\ub85c\uadf8\uc544\uc6c3","logInSucceed":"\ub85c\uadf8\uc778 \uc131\uacf5","logInFail":"\ub85c\uadf8\uc778 \uc2e4\ud328","nameSuffix":" \ub2d8","home":"\ud648","checkOutStatus":"\ub300\ucd9c \uae30\ub85d \uc870\ud68c","bookSearch":"\ub3c4\uc11c \uac80\uc0c9","userSearch":"\ud68c\uc6d0 \uac80\uc0c9","checkOut":"\ub300\ucd9c","return":"\ubc18\ub0a9","extend":"\ub300\ucd9c \uc5f0\uc7a5","history":"\ub300\ucd9c \uc774\ub825","situation":"\ub300\ucd9c \ud604\ud669","loading":"DB \uc870\ud68c \uc911","succeededToOpen":"DB \uc870\ud68c \uc644\ub8cc","searchUser":"\uc774\ub984 \ub610\ub294 \ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","searchBook":"\ucc45 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694","failedToOpen":"DB \uc870\ud68c\uac00 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4 \uc7a0\uc2dc \ud6c4 \ud654\uba74\uc744 \uac31\uc2e0\ud574\uc8fc\uc138\uc694","all":"\uc804\uccb4","available":"\ub300\ucd9c\uac00\ub2a5","checkedOut":"\ub300\ucd9c\uc911","reserved":"\uc608\uc57d\uc911","overDue":"\uc5f0\uccb4\uc911","lost":"\ubd84\uc2e4","damaged":"\ud30c\uc190","given":"\uae30\uc99d","notAvailable":"\ub300\ucd9c\ubd88\uac00","deleted":"\ud3d0\uae30","id":"\ubc88\ud638","bookName":"\ub3c4\uc11c\uba85","rentDate":"\ub300\ucd9c\uc77c","returnDate":"\ubc18\ub0a9\uc77c","dueDate":"\ub300\ucd9c\uae30\ud55c","noEntry":"\ub0b4\uc5ed \uc5c6\uc74c","notice":"\uacf5\uc9c0 \uc0ac\ud56d","newMember":"\uc2e0\uaddc \ud68c\uc6d0","autoLogin":"\uc790\ub3d9 \ub85c\uadf8\uc778","userMode":"\uc77c\ubc18 \ubaa8\ub4dc","adminMode":"\uad00\ub9ac\uc790 \ubaa8\ub4dc","normal":"\uc815\uc0c1","stopped":"\ub300\ucd9c\uc911\uc9c0","homeText":"<div class=\\"container\\"><h2>\ub3c4\uc11c\uad00 \uac1c\ubc29\uc2dc\uac04:</h2><ul><li>\ub9e4 \uc8fc\uc77c(\uc77c) 9:30am~12:00pm</li></ul><h2>\ub3c4\uc11c \ub300\ucd9c:</h2><ul><li>\ub9e4 \uc8fc\uc77c 10:30am~12:00pm </li><li>\ub300\ucd9c \uad8c\uc218: \ucd5c\ub300 5\uad8c</li><li>\ub300\ucd9c \uae30\uac04: 3\uc8fc (\ub3c4\uc11c \ub300\ucd9c\uc2dc\uac04\uc5d0 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc5f0\uc7a5\uc744 \uc694\uccad\ud558\uc2dc\uac70\ub098, <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\uc73c\ub85c \uc5f0\uc7a5 \uc2e0\uccad \uba54\uc77c\uc744 \ubcf4\ub0b4\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.)</li><li>\ub3c4\uc11c \ubc18\ub0a9: \ub3c4\uc11c\uad00 \uc55e \ubc18\ub0a9\ud568\uc5d0 \ub123\uc5b4 \uc8fc\uc2dc\uac70\ub098 \ub3c4\uc11c\uad00 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc9c1\uc811 \ubc18\ub0a9\ud558\uc5ec \uc8fc\uc2ed\uc2dc\uc624.</li><li>\ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad: \ub3c4\uc11c\uad00\uc5d0 \ube44\uce58\ub41c \ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad\uc11c\uc5d0 \uc791\uc131\ud558\uc5ec \uc81c\ucd9c\ud558\uc5ec \uc8fc\uc138\uc694.</li></ul></p><h2>\ubb38\uc758:</h2><ul><li>\ub3c4\uc11c\uad00 \uad00\ub828 \ubb38\uc758\ub294 \ub3c4\uc11c\uad00 \uc774\uba54\uc77c \uc8fc\uc18c <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\ub85c \ubb38\uc758 \ubc14\ub78d\ub2c8\ub2e4.</li></ul></div>","INVALID_BOOK":"\ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \ub3c4\uc11c\uc785\ub2c8\ub2e4","INVALID_USER":"\ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \ud68c\uc6d0\uc785\ub2c8\ub2e4","NOT_AVAILABLE":"\ub300\ucd9c \ubd88\uac00 \ub3c4\uc11c\uc785\ub2c8\ub2e4","OVERDUE":"\uc5f0\uccb4\uc911\uc785\ub2c8\ub2e4","RENTED":"\ub300\ucd9c\ub41c \ub3c4\uc11c\uc785\ub2c8\ub2e4","MAX_RENTAL":"\ub300\ucd9c \uad8c\uc218\ub97c \ucd08\uacfc\ud558\uc600\uc2b5\ub2c8\ub2e4","NOT_RENTED":"\ub300\ucd9c\ub418\uc9c0 \uc54a\uc740 \ub3c4\uc11c\uc785\ub2c8\ub2e4","rentSucceed":"\ub300\ucd9c \uc644\ub8cc","returnSucceed":"\ubc18\ub0a9 \uc644\ub8cc","rentSuffix":"\uad8c \ub300\ucd9c \uc911","confirmRent":"\ub300\ucd9c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","confirmReturn":"\ubc18\ub0a9\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","confirm":"\ud655\uc778","cancel":"\ucde8\uc18c","name":"\uc774\ub984","registeredDate":"\ub4f1\ub85d\uc77c","phone":"\uc804\ud654\ubc88\ud638","email":"\uc774\uba54\uc77c","address":"\uc8fc\uc18c","notice_":"\ube44\uace0","level":"\ub4f1\uae09","save":"\uc800\uc7a5","confirmSave":"\uc800\uc7a5\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","kid":"\uc544\ub3d9","adult":"\uc131\uc778","admin":"\uad00\ub9ac\uc790","regSuccess":"\ub4f1\ub85d \uc644\ub8cc","regFail":"\ub4f1\ub85d \uc2e4\ud328","numberOnly":"\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694","advSearch":"\uc0c1\uc138 \uac80\uc0c9","search":"\uac80\uc0c9","author":"\uc800\uc790","bookCode":"\ub3c4\uc11c\ubc88\ud638","finish":"\uc644\ub8cc","extending":"\uc5f0\uc7a5 \uc2e0\uccad\uc911","maxExtend":"\uc5f0\uc7a5 \ud55c\ub3c4 \ucd08\uacfc"}}')},244:function(e,t,o){},245:function(e,t,o){},246:function(e,t,o){},256:function(e,t,o){},264:function(e,t){},266:function(e,t){},296:function(e,t){},298:function(e,t){},299:function(e,t){},304:function(e,t){},306:function(e,t){},326:function(e,t){},342:function(e,t){},345:function(e,t){},413:function(e,t,o){},414:function(e,t,o){},416:function(e,t,o){"use strict";o.r(t);var c=o(2),n=o.n(c),s=o(216),l=(o(244),o(245),o(18)),i=(o(246),o(1));var a=function(e){return Object(c.useEffect)((function(){!async function(){console.log("Home"),e.doc.setCallback(void 0)}()}),[]),e.doc.serverAvailable?(o.e(0).then(o.t.bind(null,467,7)),Object(i.jsxs)("div",{id:"home",children:[Object(i.jsx)(l.b,{className:"home-items",to:"/checkOut",children:e.text.checkOut}),Object(i.jsx)(l.b,{className:"home-items",to:"/return",children:e.text.return})]})):Object(i.jsx)("div",{id:"home",dangerouslySetInnerHTML:{__html:e.text.homeText}})},r=(o(47),o(64)),d=o(466);const u=10;String.prototype.format=function(){let e=this;for(let t=0;t<arguments.length;t++){let o=new RegExp("\\{"+t+"\\}","gi");e=e.replace(o,arguments[t])}return e};const b={position:"top-center",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0},j=function(e,t){return"0"===t||0===t?e.normal:"1"===t||1===t?e.overDue:"2"===t||2===t?e.stopped:void 0},h=function(e,t){switch(t){case"0":case 0:return e.available;case"1":case 1:return e.checkedOut;case"2":case 2:return e.reserved;case"3":case 3:return e.overDue;case"4":case 4:return e.lost;case"5":case 5:return e.damaged;case"6":case 6:return e.given;case"7":case 7:default:return e.notAvailable;case"8":case 8:return e.deleted}},O=function(e,t){if(e.name>t.name)return 1;if(e.name<t.name)return-1;const o=parseInt(e.claim_num),c=parseInt(t.claim_num);return o>c?1:o<c?-1:0},g=function(e,t){return e.name>t.name?1:e.name<t.name?-1:0},x=function(e,t){return e.rentDate>t.rentDate?1:e.rentDate<t.rentDate?-1:e.title>t.title?1:e.title<t.title?-1:0},m=function(e){return unescape(encodeURIComponent(e))},f="custom-loading-id",p="custom-logging-id";var v=o(7),S=o(104),k=o.n(S),E=o(106),_=o.n(E);var N=function(){console.log("Do nothing...")};var y,C,I,R,A,D,T,w,L,U,B,P=function(e){const[t,o]=Object(c.useState)([]),[n,s]=Object(c.useState)(0),[l,a]=Object(c.useState)([]);return Object(c.useEffect)((function(){console.log("Init List View")}),[]),Object(c.useEffect)((function(){o(e.list)}),[e.list]),Object(c.useEffect)((function(){s(0)}),[e.keyValue]),Object(c.useEffect)((function(){e.showCallback&&(N=e.showCallback)}),[e.showCallback]),Object(c.useEffect)((function(){const e=t.length;if(e>u){const o=n*u,c=Math.min(u,e-o);a(t.slice(o,o+c))}else a(t)}),[t,n]),Object(i.jsxs)("div",{id:"listView",children:[N(l,e.detail),t&&t.length>u&&Object(i.jsxs)("div",{id:"pageControl",children:[Object(i.jsx)("div",{className:"page",id:"page",children:Object(i.jsx)(k.a,{fontSize:"large",sx:{color:0===n?"#ffffff":"#404040"},onClick:()=>{console.log("Prev"),n>0&&s(n-1)}})}),Object(i.jsx)("div",{className:"pageNum",id:"pageNum",children:n+1}),Object(i.jsx)("div",{className:"page",id:"page",children:Object(i.jsx)(_.a,{fontSize:"large",sx:{color:t.length<=(n+1)*u?"#ffffff":"#404040"},onClick:()=>{console.log("Next"),t.length>(n+1)*u&&s(n+1)}})})]})]})},M=o(37),q=o(38);Object(q.a)(y||(y=Object(M.a)(["\n    query AllBook{\n        book (limit:20000) {\n            _id\n            author\n            title\n            claim_num\n            num\n            series\n            category\n            claim\n            publisher\n            seqnum\n            registration_date\n            isbn\n            deleted\n        }\n    }\n"])));const H=Object(q.a)(C||(C=Object(M.a)(["\n    query AllRent{\n        rent (limit:20000) {\n            _id\n            book_id\n            user_id\n            rent_date\n            return_date\n            extend_count\n            state\n        }\n    }\n"]))),K=Object(q.a)(I||(I=Object(M.a)(["\n    query AllUser {\n        user (limit: 20000) {\n            _id\n            name\n            state\n            level\n        }\n    }"]))),F=Object(q.a)(R||(R=Object(M.a)(["\n    query FindUser($_id: string){\n        user (where: {_id: {_eq: $_id}}) {\n            _id\n            name\n            state\n            level\n            encrypted_email\n            encrypted_phone\n        }\n    }"]))),G=Object(q.a)(A||(A=Object(M.a)(["\n    query findLogs($user_id: string){\n        rentLog (limit: 20000, where: {user_id: {_eq: $user_id}}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            return_date\n            user_id\n        }\n    }"]))),Y=Object(q.a)(D||(D=Object(M.a)(["\n    query findLogs($book_id: string){\n        rentLog (limit: 20000, where: {book_id: {_eq: $book_id}}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            return_date\n            user_id\n        }\n    }"]))),V=Object(q.a)(T||(T=Object(M.a)(["\n    query findLogs ($fromTime: string, $toTime: string) {\n        rentLog(limit: 20000, where: {timestamp: {_gte: $fromTime, _lt: $toTime}}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            return_date\n            user_id\n        }\n    }"]))),z=Object(q.a)(w||(w=Object(M.a)(["\n    query GetNotices {\n        notice (order_by: {date: asc}, limit:20000) {\n            _id\n            date\n            title\n        }\n    }"]))),W=Object(q.a)(L||(L=Object(M.a)(["\n    query GetContent ($_id: string) {\n        notice (where: {_id: {_eq: $_id}}) {\n            _id\n            date\n            title\n            content\n        }\n    }"]))),Q=Object(q.a)(U||(U=Object(M.a)(["\n    query GetServerInfo {\n        serverInfo {\n            _id\n            globalIp\n            localIp\n            port\n            proxy\n        }\n    }"]))),$=Object(q.a)(B||(B=Object(M.a)(["\n    query GetRequests($user_id: string) {\n        request (limit: 20000, where: {user_id: {_eq: $user_id}}) {\n            _id\n            user_id\n            action\n            state\n            book_id\n        }\n    }"])));var X=function(e){const[t,o]=Object(c.useState)([]),[n,s]=Object(c.useState)([]),[a,b]=Object(c.useState)(0),{loading:j,data:h,error:O}=Object(r.e)(z),{id:g}=Object(v.r)(),[x,{loading:m,data:f,error:p}]=Object(d.a)(W,{variables:{_id:g}});Object(c.useEffect)((function(){!async function(){console.log("Notice"),e.doc.setCallback(void 0)}()}),[]),Object(c.useEffect)((()=>{console.log("Get Notice"),h&&o(h.notice)}),[h,O,j]),Object(c.useEffect)((()=>{console.log("Get Content")}),[f,p,m]),Object(c.useEffect)((()=>{const e=t.length;if(console.log("Page num "+a.toString()+" "),console.log(e),e>u){const o=a*u,c=Math.min(u,e-o);s(t.slice(o,o+c))}else s(t),b(0)}),[t,a]),Object(c.useEffect)((()=>{}),[n]),Object(c.useEffect)((()=>{console.log("Select id: "+g),g&&x()}),[g,x]);const S=e=>Object(i.jsxs)("tr",{className:"",children:[Object(i.jsxs)("td",{className:"",children:[" ",e.date," "]}),Object(i.jsxs)("td",{className:"noticeEntry",colSpan:"2",children:[g!==e._id&&Object(i.jsx)(l.b,{to:"/notice/"+e._id,children:e.title}),g===e._id&&Object(i.jsx)(l.b,{to:"/notice",children:e.title})]})]},e._id);return Object(i.jsxs)("div",{id:"notice",children:[Object(i.jsx)("div",{id:"title",children:Object(i.jsx)("h2",{children:e.text.notice})}),g&&f&&Object(i.jsx)("div",{id:"noticeContent",children:Object(i.jsx)("table",{className:"content",children:Object(i.jsxs)("tbody",{children:[S(f.notice[0]),Object(i.jsx)("tr",{children:Object(i.jsx)("td",{className:"content",colSpan:"3",children:f.notice[0].content})})]})})}),Object(i.jsx)(P,{list:t,showCallback:e=>Object(i.jsx)("div",{id:"noticeList",children:Object(i.jsx)("table",{children:Object(i.jsx)("tbody",{children:n.length>0&&n.map((e=>S(e)))})})})})]})},J=o(45),Z=o(231);o(252);let ee=!1;var te=function(e){const[t,n]=Object(c.useState)(""),[s,a]=Object(c.useState)([]),[r,u]=Object(c.useState)(0),[b,j]=Object(c.useState)([]),[g,x]=Object(c.useState)([]),[f,p]=Object(c.useState)(0),[S,k]=Object(c.useState)(!1),[E,_]=Object(c.useState)(!1),[N,y]=Object(c.useState)(""),[C,I]=Object(c.useState)(!1),[R,A]=Object(c.useState)(""),[D,T]=Object(c.useState)(""),[w,L]=Object(c.useState)(""),[U,B]=Object(c.useState)(""),[M,q]=Object(c.useState)(""),[H,K]=Object(c.useState)(0),[F,G]=Object(c.useState)([]),[V]=Object(J.a)(t,300),[z,{data:W}]=Object(d.a)(Y,{variables:{book_id:N}}),Q=Object(c.useRef)("0"),$=Object(c.useRef)(!1),X=Object(c.useRef)(0),te=Object(c.useRef)(!1),{id:oe}=Object(v.r)();async function ce(){console.log("All data loaded "+ee),ee=!0;let t=[],o={};const c=e.doc.rent;for(let e=0;e<c.length;e++)t.push({code:c[e].book_id,retDate:c[e].return_date,state:c[e].state}),o[c[e].book_id]=c[e].state;x(t);let n=[];const s=e.doc.book;for(const e in s){const t=s[e],c=e in o?o[e]:0;n.push({code:t._id,name:t.title,state:c,num:t.num,author:t.author,claim:t.claim,regDate:t.registration_date,claim_num:t.claim_num,totalName:t.series,category:t.publisher,publish:t.publisher,isbn:t.isbn,deleted:t.deleted})}console.log("Load"),console.log(n.length),j(n),console.log(N),""!==N&&(console.log("Load history"),z())}function ne(e){console.log("Set state "+f+" to "+e.toString()),$.current=!0,k(!0),p(e),X.current=e,console.log(r.toString()+$.current)}function se(e){const t=e.toString(),o=document.getElementById(t).checked;console.log("Set Search state "+t+" Value: "+o),"1023"===t?(document.getElementById("1023").checked=o,document.getElementById("0").checked=o,document.getElementById("1").checked=o,document.getElementById("3").checked=o,document.getElementById("4").checked=o,document.getElementById("5").checked=o,document.getElementById("6").checked=o,document.getElementById("7").checked=o,document.getElementById("8").checked=o):document.getElementById(t).checked=o;for(var c=0,n=0;n<9;n++){const e=n.toString(),t=document.getElementById(e);t&&(c|=t.checked?1<<n:0)}K(c),console.log("Filter: "+c.toString())}Object(c.useEffect)((function(){!async function(){e.doc.isOpen()?ce():e.doc.setCallback(ce),e.doc.serverAvailable&&o.e(0).then(o.t.bind(null,467,7)),console.log("BOOK ID: "+oe)}()}),[]),Object(c.useEffect)((()=>{console.log("Updated id: "+oe),oe?(console.log("Set Book ID "+oe),y(oe),z()):y("")}),[oe,z]),Object(c.useEffect)((()=>{!async function(){var t;if(console.log("Refresh"),!C)if(t=""!==N?N:V,console.log(t),t){let o=await async function(t){let o=[];if(e.doc.serverAvailable){console.log(m(t)),console.log(btoa(m(t)));const c="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book";console.log("======================="),console.log("Request book list");const n={book:btoa(m(t)),match:!1},s=await e.doc.requestGet(c,n);if(console.log(s),!("books"in s.data.return))return o;const l=s.data.return.books;for(let t=0;t<l.length;t++){const c=l[t],n="".concat(c.BOOKNAME," ").concat(c.CLAIMNUM),s=c._STATE;let i="";1!==s&&3!==s&&"1"!==s&&"3"!==s||(i=e.text.returnDate+" "+c._RETURN);let a={index:t,text:n,name:c.BOOKNAME,code:c.BARCODE,rent:h(e.text,c._STATE.toString()),retDate:i,regDate:c.REG_DATE,author:c.AUTHOR,totalName:c.TOTAL_NAME,claim_num:c.CLAIMNUM,publish:c.PUBLISH,claim:c.CLAIM,state:c._STATE,isbn:c.ISBN};o.push(a)}}else o=ae(t,b);return o.sort(O),o}(t);o.length>0?a(o):a([]),1===o.length&&(Q.current=o[0].code)}else a([])}()}),[V,N,b,g,e,E,C]),Object(c.useEffect)((()=>{if(console.log("History update"),console.log(W),!W)return G([]),void(te.current=!1);let e=[];for(let t=0;t<W.rentLog.length;t++){const o=W.rentLog[t];if(1!==o.book_state)continue;let c=[o.timestamp];c.push(o.return_date),e.push(c)}console.log(e.length),G(e),te.current=e.length>0}),[W]);const le=(t,o)=>{const c=t.code!==Q.current,n=c?"searchResult":"selectedSearchResult",a=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];a[t.state]=!0,1!==t.state&&2!==t.state&&3!==t.state||(a[0]=!0);const r=o[2];return Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{id:n,onClick:async()=>await(async e=>{console.log("Prev "+Q.current),1===s.length||-1===Q.current||Q.current!==e?(console.log("Select "+e),u(e),Q.current=e):(console.log("Deselect "+e),u(-1),Q.current=-1)})(t.code),children:Object(i.jsx)("table",{children:Object(i.jsx)("tbody",{children:Object(i.jsxs)("tr",{className:"searchTr",children:[Object(i.jsx)("td",{className:"searchTitle",children:t.text}),Object(i.jsx)("td",{className:"searchRent",children:t.rent})]})})})}),!c&&Object(i.jsxs)("div",{children:[Object(i.jsx)("table",{children:Object(i.jsxs)("tbody",{children:[Object(i.jsxs)("tr",{children:[Object(i.jsxs)("td",{children:[t.author," "]}),Object(i.jsxs)("td",{colSpan:"2",rowSpan:"2",children:[t.totalName+" ",Object(i.jsx)("b",{children:t.name})," "+t.claim_num]})]},"row1"),Object(i.jsx)("tr",{children:Object(i.jsx)("td",{children:Object(i.jsx)(l.b,{to:"/search/"+t.code,children:t.code})})},"row2"),Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:t.publish}),Object(i.jsx)("td",{colSpan:t.retDate.length>0?"1":"2",children:t.claim}),t.retDate.length>0&&Object(i.jsx)("td",{children:t.retDate})]},"row3")]})}),Object(i.jsx)("table",{className:"rentHistory",hidden:!te.current,children:Object(i.jsxs)("tbody",{children:[Object(i.jsxs)("tr",{id:"titles",children:[Object(i.jsx)("td",{children:e.text.rentDate}),Object(i.jsx)("td",{children:e.text.returnDate})]}),r.map((e=>(e=>Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:e[0]},e[0]+"x"),Object(i.jsx)("td",{children:e[1]})]},e[0]))(e)))]})}),Object(i.jsxs)("div",{hidden:!e.doc.serverAvailable||!e.doc.admin,children:[Object(i.jsxs)("button",{className:"bookStates",id:"0",disabled:a[0],onClick:()=>ne(0),children:[" ",e.text.available," "]}),Object(i.jsxs)("button",{className:"bookStates",id:"4",disabled:a[4],onClick:()=>ne(4),children:[" ",e.text.lost," "]}),Object(i.jsxs)("button",{className:"bookStates",id:"5",disabled:a[5],onClick:()=>ne(5),children:[" ",e.text.damaged," "]}),Object(i.jsxs)("button",{className:"bookStates",id:"6",disabled:a[6],onClick:()=>ne(6),children:[" ",e.text.given," "]}),Object(i.jsxs)("button",{className:"bookStates",id:"7",disabled:a[7],onClick:()=>ne(7),children:[" ",e.text.notAvailable," "]}),Object(i.jsxs)("button",{className:"bookStates",id:"8",disabled:a[8],onClick:()=>ne(8),children:[" ",e.text.deleted," "]})]}),Object(i.jsxs)("div",{id:"checkRent",hidden:!$.current,children:[Object(i.jsxs)("div",{id:"bookName",children:[" ",h(e.text,X.current)," "]}),Object(i.jsxs)("button",{id:"confirm",onClick:()=>async function(){console.log("Confirmed"),$.current=!1,k(!1);const t=e.doc.serverInfo.localIp,o=e.doc.serverInfo.port;if(0===t.length||o<=0)return;const c="https://"+t+":"+o+"/book";var n={};n.book=Q.current,n.state=X.current,console.log("======================="),console.log("Change book state"),await e.doc.requestPost(c,n),_(!E)}(),children:[" ",e.text.confirm," "]}),Object(i.jsxs)("button",{id:"cancel",onClick:()=>(console.log("Cancelled"),$.current=!1,void k(!1)),children:[" ",e.text.cancel," "]})]})]})]},t.code)};function ie(e,t){e?T(t):L(t)}function ae(t,o){let c=[];console.log(C);const n=t.toLowerCase();console.log(n);for(let s=0;s<o.length;s++){const t=o[s];if(c.length>=500)break;if(n.length>0&&(!t.name||!t.name.toString().toLowerCase().includes(n))&&(!t.totalName||!t.totalName.toString().toLowerCase().includes(n))&&(!t.author||!t.author.toString().toLowerCase().includes(n))&&t.code.toLowerCase()!==n&&t.isbn!==n)continue;if(t.deleted&&"Y"===t.deleted)continue;if(C){if(R.length>0&&t.author&&!t.author.toString().toLowerCase().includes(R.toLowerCase()))continue;if(D.length>0&&t.code<D)continue;if(w.length>0&&t.code>w)continue;const e=t.regDate;if(e<U||e>M)continue;if(console.log(t),console.log(e),console.log(e<U),console.log(e>M),!(1<<t.state&H))continue}else if(0===n.length)continue;let l="".concat(t.name," ").concat(t.claim_num),i="",a="0";for(const o of g)if(o.code===t.code){a=o.state,"1"!==a&&"3"!==a||(i=e.text.returnDate+" "+o.retDate);break}let r={index:s,text:l,name:t.name,code:t.code.toString(),rent:h(e.text,a),retDate:i,regDate:t.regDate,author:t.author,totalName:t.totalName,claim_num:t.claim_num,publish:t.publish,claim:t.claim,state:parseInt(a),isbn:t.isbn};c.push(r)}return console.log(c.length),c}return Object(i.jsxs)("div",{id:"search",children:[Object(i.jsx)("div",{id:"title",children:Object(i.jsxs)("h2",{children:[" ",e.text.bookSearch," "]})}),Object(i.jsxs)("div",{id:"searchContents",hidden:""!==N,children:[Object(i.jsx)("input",{id:"searchInput",placeholder:e.text.searchBook,value:t,onChange:e=>{n(e.target.value)}}),Object(i.jsxs)("div",{hidden:!e.doc.admin,children:[Object(i.jsx)("input",{type:"checkbox",id:"advancedSearch",checked:C,onChange:()=>{I(!C)}}),Object(i.jsx)("label",{children:e.text.advSearch})]}),Object(i.jsxs)("div",{hidden:!C,children:[Object(i.jsxs)("div",{children:[Object(i.jsxs)("label",{children:[" ",e.text.author," "]}),Object(i.jsx)("input",{type:"text",id:"author",onChange:e=>{A(e.target.value)}})]}),Object(i.jsxs)("div",{children:[Object(i.jsxs)("label",{children:[" ",e.text.bookCode," "]}),Object(i.jsx)("input",{type:"text",id:"fromPeriod",onChange:e=>{ie(!0,e.target.value)}}),Object(i.jsx)("label",{children:" ~  "}),Object(i.jsx)("input",{type:"text",id:"toPeriod",onChange:e=>{ie(!1,e.target.value)}})]}),Object(i.jsxs)("div",{children:[Object(i.jsxs)("label",{children:[" ",e.text.registeredDate," "]}),Object(i.jsx)(Z.a,{onChange:function(e){console.log(e);const t=e[0],o=e[1],c=t.getFullYear().toString()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0");console.log(c),B(c);const n=o.getFullYear().toString()+"-"+(o.getMonth()+1).toString().padStart(2,"0")+"-"+o.getDate().toString().padStart(2,"0");console.log(n),q(n)},selectRange:!0})]}),Object(i.jsx)("div",{children:Object(i.jsx)("table",{children:Object(i.jsxs)("tbody",{children:[Object(i.jsxs)("tr",{className:"bookData",children:[Object(i.jsx)("td",{className:"stateName",children:e.text.all}),Object(i.jsx)("td",{className:"stateName",children:e.text.available}),Object(i.jsx)("td",{className:"stateName",children:e.text.checkedOut}),Object(i.jsx)("td",{className:"stateName",children:e.text.overDue}),Object(i.jsx)("td",{className:"stateName",children:e.text.lost}),Object(i.jsx)("td",{className:"stateName",children:e.text.damaged}),Object(i.jsx)("td",{className:"stateName",children:e.text.given}),Object(i.jsx)("td",{className:"stateName",children:e.text.notAvailable}),Object(i.jsx)("td",{className:"stateName",children:e.text.deleted})]},"stateName"),Object(i.jsxs)("tr",{className:"bookData",children:[Object(i.jsx)("td",{className:"stateButton",children:Object(i.jsx)("input",{type:"checkbox",className:"bookStates",id:"1023",onChange:()=>se(1023)})}),Object(i.jsx)("td",{className:"stateButton",children:Object(i.jsx)("input",{type:"checkbox",className:"bookStates",id:"0",onChange:()=>se(0)})}),Object(i.jsx)("td",{className:"stateButton",children:Object(i.jsx)("input",{type:"checkbox",className:"bookStates",id:"1",onChange:()=>se(1)})}),Object(i.jsx)("td",{className:"stateButton",children:Object(i.jsx)("input",{type:"checkbox",className:"bookStates",id:"3",onChange:()=>se(3)})}),Object(i.jsx)("td",{className:"stateButton",children:Object(i.jsx)("input",{type:"checkbox",className:"bookStates",id:"4",onChange:()=>se(4)})}),Object(i.jsx)("td",{className:"stateButton",children:Object(i.jsx)("input",{type:"checkbox",className:"bookStates",id:"5",onChange:()=>se(5)})}),Object(i.jsx)("td",{className:"stateButton",children:Object(i.jsx)("input",{type:"checkbox",className:"bookStates",id:"6",onChange:()=>se(6)})}),Object(i.jsx)("td",{className:"stateButton",children:Object(i.jsx)("input",{type:"checkbox",className:"bookStates",id:"7",onChange:()=>se(7)})}),Object(i.jsx)("td",{className:"stateButton",children:Object(i.jsx)("input",{type:"checkbox",className:"bookStates",id:"8",onChange:()=>se(8)})})]},"stateButton")]})})}),Object(i.jsx)("div",{children:Object(i.jsxs)("button",{id:"searchEntry",onClick:function(){console.log("Search"),console.log(D),console.log(w),console.log(U),console.log(M);let e=ae(t,b);e.sort(O);let o=e;o.length>0?a(o):a([]),1===o.length&&(Q.current=o[0].code)},children:[" ",e.text.search," "]})})]})]}),Object(i.jsx)(P,{keyValue:V,list:s,detail:[r,S,F],showCallback:(e,t)=>function(e,t){return console.log("Redraw "+$.current),console.log(te.current),console.log(t),e.map((e=>le(e,t)))}(e,t)})]})},oe=o(12);const ce=0,ne=1,se=2;var le=function(e){const[t,s]=Object(c.useState)(""),[a,r]=Object(c.useState)(""),[u,j]=Object(c.useState)([]),[h,O]=Object(c.useState)(!1),[g,m]=Object(c.useState)(""),[f,S]=Object(c.useState)(ce),[k,E]=Object(c.useState)([]),[_,N]=Object(c.useState)(0),[y,C]=Object(c.useState)(!1),[I,{data:R}]=Object(d.a)(F,{variables:{_id:g}}),[A,{data:D}]=Object(d.a)(G,{variables:{user_id:g}}),[T,{data:w}]=Object(d.a)($,{variables:{user_id:g}}),[L,U]=Object(c.useState)(""),[B,M]=Object(c.useState)("");async function q(){if(console.log("All data loaded "+h),e.doc.logged){S(se);const t=e.doc.userInfo._id;m(t),j(await e.doc.getRent(t)),console.log(e.doc.getRent(t)),await A(),await T()}else S(ce),m(""),r("");console.log("Set title "+e.doc.logged),e.doc.logged?e.doc.adminMode?M(e.text.userSearch):M(e.text.checkOut):M(e.text.logIn),console.log("Done"),O(!0)}Object(c.useEffect)((function(){!async function(){if(!e.doc.initialized)return;if(e.doc.isOpen()&&q(),console.log("======================================="),console.log("CheckOutStatus initialize"),e.doc.serverAvailable&&o.e(0).then(o.t.bind(null,467,7)),"autoLogin"in e.context.cookie){const t="true"===e.context.cookie.autoLogin;C(t)}const t=new Date;t.setTime(t.getTime()+1728e5),U(t.toGMTString())}()}),[]),Object(c.useEffect)((()=>{console.log("User data updated "),q()}),[e.doc.logged]),Object(c.useEffect)((()=>{!async function(){console.log("User data updated "),await Y()}()}),[R]),Object(c.useEffect)((()=>{if(!D||!e.doc.bookReady||!e.doc.rentReady)return;console.log("History updated ");let t=[];const o=D.rentLog;for(let c=0;c<o.length;c++){const n=o[c];if("1"!==n.book_state&&1!==n.book_state)continue;if(!("return_date"in n)||!n.return_date)continue;const s=n.book_id;if(!(s in e.doc.book))continue;const l=e.doc.book[s],i=l.title,a=l.claim,r=n.timestamp.split(" ")[0].replace("-","/",2).replace("-","/"),d=n.return_date.split(" ")[0].replace("-","/",2).replace("-","/");t.push({id:s,title:i,rentDate:r,retDate:d,claim:a,totalName:l.series,claim_num:l.claim_num})}t.sort(x),console.log("Set history"),E(t)}),[D,e.doc.bookReady,e.doc.rentReady]),Object(c.useEffect)((()=>{console.log("Request data"),w&&(console.log("Request available"),e.doc.setRequest(w.request))}),[w]);const H=(t,o)=>{let c;return c=o?e.text.returnDate:e.text.dueDate,Object(i.jsx)("div",{children:Object(i.jsx)("table",{children:Object(i.jsxs)("tbody",{children:[Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{id:"id",children:e.text.id}),Object(i.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(i.jsx)("th",{id:"returnDate",children:c})]},"ID"),t.map(((t,c)=>((t,o,c)=>{const s=t.id,a=t.rentDate,r=t.retDate,d=t.claim,u=o.toString(),b=t.extendCount,j=b>=1;let h,O;return c?h="1":(O=e.doc.hasRequest(s),h="2"),Object(i.jsxs)(n.a.Fragment,{children:[Object(i.jsxs)("tr",{className:"bookData",children:[Object(i.jsx)("td",{className:"bookData",children:Object(i.jsx)(l.b,{to:"/search/"+s,children:s})}),Object(i.jsx)("td",{className:"bookData",children:a}),Object(i.jsx)("td",{className:"bookData",children:r})]},u),Object(i.jsxs)("tr",{className:"bookName",children:[Object(i.jsx)("td",{className:"bookName",children:d}),Object(i.jsxs)("td",{colSpan:"2",rowSpan:h,className:"bookName",children:[t.totalName+" ",Object(i.jsx)("b",{children:t.title})," "+t.claim_num]})]},u+"Title"),!c&&Object(i.jsx)("tr",{className:"bookExtend",children:Object(i.jsxs)("td",{className:"bookExtend",children:[" ",Object(i.jsxs)("button",{id:"extend",onClick:async()=>K(s),disabled:O||j,children:[j&&e.text.maxExtend,O&&!j&&e.text.extending,!(O||j)&&e.text.extend,"(",b,")"]})]})},u+"Extend")]},u+"Fragment")})(t,c,o))),0===t.length&&Object(i.jsx)("tr",{children:Object(i.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})})},K=async t=>{console.log("Extend");const o=(new Date).toISOString().replace("T"," ").replace("Z","");console.log(o);const c='{\n "user_id": "'+g+'",\n "book_id": "'+t+'",\n "date": "'+o+'",\n "action": "extend"\n}\n';e.context.sendRequest(c),e.doc.addRequest(t),N(_+1)},Y=async()=>{if(!R||f===ce)return;console.log(oe.c.isActive(p));const t=b;let o;console.log(a);const c=R.user[0];e.context.checkLogIn(c,a)?(e.doc.logIn(c),j(await e.doc.getRent(g)),S(se),t.type=oe.c.TYPE.SUCCESS,o=e.text.logInSucceed,document.cookie="user_id="+g+"; expires="+L+";"):(t.type=oe.c.TYPE.ERROR,o=e.text.logInFail),t.render=o,t.autoClose=3e3,t.toastId=p,oe.c.isActive(p)?(console.log("update toast"),oe.c.update(p,t)):(console.log("New toast"),oe.c.info(o,t))};return e.doc.initialized?Object(i.jsxs)("div",{id:"checkOut",children:[Object(i.jsx)("div",{id:"title",children:Object(i.jsx)("h2",{children:B})}),Object(i.jsxs)("div",{id:"checkOutInput",hidden:!(f!==se),children:[Object(i.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:t,disabled:!h,onInput:e=>{s(e.target.value)}}),Object(i.jsx)("input",{type:"password",id:"searchPassword",placeholder:e.text.pwHolder,value:a,disabled:!h,onInput:e=>{r(e.target.value)}}),Object(i.jsxs)("div",{id:"autoLogin",children:[Object(i.jsx)("input",{type:"checkbox",id:"autoLoginButton",checked:y,onChange:()=>(()=>{console.log("Toggle autoLogin");const e="autoLogin="+(y?"false":"true")+"; expires="+L+";";document.cookie=e,C(!y)})()}),Object(i.jsx)("label",{children:e.text.autoLogin})]}),Object(i.jsxs)("button",{id:"logIn",onClick:async()=>(async()=>{S(ne),m(t.toUpperCase()),await I(),await A(),await T(),console.log("Log In"),await Y()})(),children:[" ",e.text.logIn," "]})]}),Object(i.jsxs)("div",{id:"checkOutResult",hidden:!(f===se),children:[Object(i.jsx)("div",{children:H(u,!1)}),Object(i.jsx)("div",{id:"name",children:e.text.history}),Object(i.jsx)(P,{list:k,showCallback:e=>H(e,!0)})]})]}):Object(i.jsx)(v.a,{to:"/"})};const ie=0,ae=1,re=2;var de=function(e){const[t,n]=Object(c.useState)(""),[s,l]=Object(c.useState)(""),[a]=Object(J.a)(s,500),[r,d]=Object(c.useState)(""),[u,h]=Object(c.useState)(!1),[O,g]=Object(c.useState)(""),[x,m]=Object(c.useState)({}),[S,k]=Object(c.useState)([]),[E,_]=Object(c.useState)({}),[N,y]=Object(c.useState)({}),[C,I]=Object(c.useState)(ie),{id:R}=Object(v.r)(),A=Object(v.p)();Object(c.useEffect)((function(){const t=setInterval((async()=>{if(!("localIp"in e.doc.serverInfo)||!("port"in e.doc.serverInfo))return;if(e.doc.admin)return;o.e(0).then(o.t.bind(null,467,7));const t=e.doc.serverInfo.localIp,c=e.doc.serverInfo.port;if(t.length>0&&c>0){const o="https://"+t+":"+c+"/scanBarcode",n=(await e.doc.requestGet(o,{})).data.scan;n&&(console.log(n),console.log(C),g(n))}}),1e3);return async function(){console.log("======================================="),console.log("CheckOut initialize");const e=document.getElementsByName("idPrefix");for(var t=0;t<e.length;t++){const o=e[t].id;e[t].checked="AB"===o}console.log("ID: "+R),R&&0!==R.length&&(n(R),T(R))}(),()=>clearInterval(t)}),[]),Object(c.useEffect)((()=>{console.log("Updated id: "+R)}),[R]),Object(c.useEffect)((()=>{O&&(console.log("Updated barcode: "+O),console.log("state : "+C),C===re?d(O):C===ie&&T(O))}),[O]),Object(c.useEffect)((()=>{console.log("User data updated "),console.log(oe.c.isActive(p));const t=b;let o,c=!1;"USER_CODE"in E&&C!==re?(console.log("Set state to LoggedIn from "+C),I(re),t.type=oe.c.TYPE.SUCCESS,o=e.text.logInSucceed,c=!0):"USER_CODE"in E||(console.log("Set state to LoggedOut from "+C),C===ae&&(t.type=oe.c.TYPE.ERROR,o=e.text.logInFail,c=!0),I(ie)),c&&m({id:f,text:o,type:t.type})}),[E]),Object(c.useEffect)((()=>{console.log("book updated "),"BARCODE"in N?0===N._STATE?h(!0):(m({id:f,text:e.text.RENTED,type:oe.c.TYPE.ERROR}),h(!1)):(h(!1),d(""))}),[N]),Object(c.useEffect)((()=>{if(!("text"in x))return;oe.c.dismiss(),console.log("Notification "+x.text);const e=b;e.type=x.type,e.autoClose=3e3,oe.c.info(x.text,e)}),[x]);const D=async t=>{const o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/user?user="+t,c={user:t,data:"nothing"},s=(await e.doc.requestGet(o,c)).data.return;_(s),console.log(s),n(s.USER_CODE)},T=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;var t,o,c="";const n=document.getElementsByName("idPrefix");if(e){if(e.length<=2)return;c=e.substring(0,2);var s=!1;for(o=0;o<n.length;o++)if(c===n[o].id){s=!0;break}if(!s)return;t=e}else{const e=document.getElementById("userInput").value;for(o=0;o<n.length;o++)n[o].checked&&(c=n[o].id),console.log("Pressed ["+o.toString()+" "+c+"]");t="A"===e[0]||"a"===e[0]?e:c+e}if(console.log("LOGIN"),console.log(t),0===t.length)return;console.log("Set state to LoggingIn from "+C),I(ae);const l=t.toUpperCase();D(l)};function w(t){return Object(i.jsxs)("div",{id:"bookList",children:[Object(i.jsxs)("div",{id:"dueDate",children:[e.text.dueDate," : ",e.doc.dueDate]}),t.map(((e,t)=>function(e,t){return Object(i.jsxs)("div",{id:"bookEntry",children:[Object(i.jsxs)("div",{id:"bookItem",children:[" ",t.id," "]}),Object(i.jsxs)("div",{id:"bookItem",children:[" ",t.name," "]})]},t.id)}(0,e)))]})}return Object(c.useEffect)((()=>{!async function(){if(a.length<=0)return;var t;t=e.doc.admin?a:"HK"+a,console.log("Search book1 "+t);const o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",c={book:t,match:!0},n=(await e.doc.requestGet(o,c)).data.return;console.log(n),"books"in n&&"BOOKNAME"in n.books&&(console.log(n.books),y(n.books))}()}),[a,e.doc]),Object(c.useEffect)((()=>{!async function(){if(console.log("Set bookId: "+r),0===r.length)return;console.log("Search book2 "+r);const t="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",o={book:r,match:!0},c=(await e.doc.requestGet(t,o)).data.return;console.log(c),"books"in c&&"BOOKNAME"in c.books&&y(c.books)}()}),[r,e.doc]),Object(c.useEffect)((()=>{!async function(){if(console.log("Set userId: "+t),t&&0!==t.length&&(0===t.search("AA")||0===t.search("AB"))){const o=document.getElementsByName("idPrefix"),c=t.substring(0,2);for(var e=0;e<o.length;e++){const t=o[e].id;o[e].checked=c===t}}}()}),[t]),Object(i.jsxs)("div",{id:"checkOut",children:[Object(i.jsx)("div",{id:"title",children:Object(i.jsx)("h2",{children:e.text.checkOut})}),Object(i.jsxs)("div",{id:"checkOutInput",hidden:C===re,children:[Object(i.jsx)("input",{type:"radio",id:"AA",name:"idPrefix"}),Object(i.jsx)("label",{htmlFor:"AA",className:"idPrefix",name:"idPrefix",children:" AA "}),Object(i.jsx)("input",{type:"radio",id:"AB",name:"idPrefix"}),Object(i.jsx)("label",{htmlFor:"AB",className:"idPrefix",name:"idPrefix",children:" AB "}),Object(i.jsx)("input",{type:"text",id:"userInput",pattern:"[0-9]*",inputMode:"numeric",placeholder:e.text.idHolder,onKeyDown:e=>{!function(e){"Enter"===e.key&&(console.log(e),console.log(document.getElementById("userInput").value),T())}(e)}}),Object(i.jsxs)("button",{id:"logIn",onClick:async()=>T(),children:[" ",e.text.logIn," "]})]}),Object(i.jsxs)("div",{id:"checkOutResult",hidden:C!==re,children:[E.USER_CODE&&Object(i.jsxs)("div",{id:"userInfo",children:[Object(i.jsx)("div",{id:"userItem",children:E.USER_CODE+" : "+E.USER_NAME+e.text.nameSuffix}),Object(i.jsxs)("div",{id:"userItem",children:[" ",j(e.text,E.USER_STATE)," "]}),Object(i.jsxs)("div",{id:"userItem",children:[" ",E._RENT.length+" "+e.text.rentSuffix," "]})]}),Object(i.jsx)("div",{id:"bookInput",hidden:u,children:Object(i.jsxs)("label",{id:"manualInput",children:[Object(i.jsx)("div",{id:"hkPrefix",children:e.text.numberOnly}),Object(i.jsx)("input",{inputMode:"numeric",pattern:"[0-9]*",type:"text",id:"bookInput",placeholder:e.text.bookHolder,onInput:e=>{l(e.target.value)}})]})}),Object(i.jsxs)("div",{id:"checkRent",hidden:!u,children:[Object(i.jsxs)("div",{id:"bookName",children:[" ",e.text.confirmRent," "]}),Object(i.jsxs)("div",{id:"bookName",children:[" ",N.AUTHOR+":"," "]}),Object(i.jsxs)("div",{id:"bookName",children:[" ",N.BOOKNAME," "]}),Object(i.jsxs)("button",{id:"confirm",onClick:async()=>async function(){console.log("Confirmed"),h(!1),console.log(N);const o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/checkOut",c={book:N.BARCODE,user:t},n=(await e.doc.requestPost(o,c)).data.return;if(console.log("Rent confirmed"),console.log(n),"SUCCESS"===n)m({id:f,text:e.text.rentSucceed,type:oe.c.TYPE.SUCCESS}),S.push({id:N.BARCODE,name:N.BOOKNAME}),console.log(S),k(S);else{let t;t=n in e.text?e.text[n]:e.text.NOT_AVAILABLE,console.log(t),m({id:f,text:t,type:oe.c.TYPE.ERROR})}y({}),d(""),D(t)}(),children:[" ",e.text.confirm," "]}),Object(i.jsxs)("button",{id:"cancel",onClick:()=>(console.log("Cancelled"),h(!1),y({}),void d("")),children:[" ",e.text.cancel," "]})]}),S.length>0&&Object(i.jsx)(P,{list:S,showCallback:e=>w(e)})]}),Object(i.jsxs)("button",{id:"logOutButton",onClick:()=>(async()=>{console.log("Finish"),_({}),y({}),n(""),d(""),k([]),A("/")})(),children:[" ",e.text.finish," "]})]})},ue=o(221),be=o.n(ue);var je=function(e){const[t,n]=Object(c.useState)(""),[s]=Object(J.a)(t,300),[l,a]=Object(c.useState)({}),[r,d]=Object(c.useState)(!1),[u,j]=Object(c.useState)({}),[h,O]=Object(c.useState)(""),[g,x]=Object(c.useState)([]),m=Object(v.p)();function p(e){return Object(i.jsx)("div",{id:"bookList",children:e.map(((e,t)=>function(e,t){return Object(i.jsxs)("div",{id:"bookEntry",children:[Object(i.jsxs)("div",{id:"bookItem",children:[" ",t.id," "]}),Object(i.jsxs)("div",{id:"bookItem",children:[" ",t.name," "]})]},t.id)}(0,e)))})}return Object(c.useEffect)((function(){const t=setInterval((async()=>{if(!("localIp"in e.doc.serverInfo)||!("port"in e.doc.serverInfo))return;if(e.doc.admin)return;o.e(0).then(o.t.bind(null,467,7));const t=e.doc.serverInfo.localIp,c=e.doc.serverInfo.port;if(t&&t.length>0&&c>0){const o="https://"+t+":"+c+"/scanBarcode",n=(await e.doc.requestGet(o,{})).data.scan;n&&(console.log(n.search("HK")),0===n.search("HK")&&(console.log(h+" -> "+n),O(n)))}}),1e3);return async function(){e.doc.setCallback(void 0),console.log("======================================="),console.log("Return initialize")}(),()=>clearInterval(t)}),[]),Object(c.useEffect)((()=>{!async function(){if(t.length>0){var o;o=e.doc.admin?t:"HK"+t,console.log("Search book1 "+o);const c="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",n={book:o,match:!0},s=(await e.doc.requestGet(c,n)).data.return;"books"in s&&"BOOKNAME"in s.books&&a(s.books)}}()}),[s,e.doc,t]),Object(c.useEffect)((()=>{!async function(){if(console.log("B"+h),h.length>0){const t=h;console.log("Search book2 "+t);const o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",c={book:t,match:!0},n=(await e.doc.requestGet(o,c)).data.return;console.log(n),"books"in n&&"BOOKNAME"in n.books&&a(n.books)}}()}),[h,e.doc]),Object(c.useEffect)((()=>{console.log("book updated "),"BARCODE"in l?1===l._STATE||3===l._STATE?d(!0):(console.log("Not rented"),j({id:f,text:e.text.NOT_RENTED,type:oe.c.TYPE.ERROR}),document.getElementById("barcodeScan").value=null,d(!1),O("")):d(!1)}),[l]),Object(c.useEffect)((()=>{if(!("text"in u))return;oe.c.dismiss();const e=b;e.type=u.type,e.autoClose=3e3,oe.c.info(u.text,e)}),[u]),Object(c.useEffect)((()=>{if(console.log("Returned updated"),console.log(g),!("localIp"in e.doc.serverInfo)||!("port"in e.doc.serverInfo))return;console.log("Update return list");const o="HK"+t;console.log("Search book1 "+o);const c="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",n={books:g};e.doc.requestGet(c,n)}),[g,t,e.doc]),Object(i.jsxs)("div",{id:"checkOut",children:[Object(i.jsx)("div",{id:"title",children:Object(i.jsx)("h2",{children:e.text.return})}),Object(i.jsxs)("div",{id:"checkOutResult",children:[Object(i.jsxs)("div",{id:"bookInput",hidden:r,children:[Object(i.jsxs)("label",{id:"barcodeScan",hidden:!0,children:[Object(i.jsx)(be.a,{fontSize:"large",sx:{color:"#404040"}}),Object(i.jsx)("span",{})]}),Object(i.jsxs)("label",{id:"manualInput",children:[Object(i.jsx)("div",{id:"hkPrefix",children:e.text.numberOnly}),Object(i.jsx)("input",{inputMode:"numeric",pattern:"\\d*",type:"text",id:"searchInput",placeholder:e.text.bookHolder,onInput:e=>{n(e.target.value)}})]})]}),Object(i.jsxs)("div",{id:"checkReturn",hidden:!r,children:[Object(i.jsxs)("div",{id:"bookName",children:[" ",e.text.confirmReturn," "]}),Object(i.jsxs)("div",{id:"bookName",children:[" ",l.AUTHOR+":"," "]}),Object(i.jsxs)("div",{id:"bookName",children:[" ",l.BOOKNAME," "]}),Object(i.jsxs)("button",{id:"confirm",onClick:()=>async function(){console.log("Confirmed"),d(!1),console.log(l);const t="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/return",o={book:l.BARCODE},c=(await e.doc.requestPost(t,o)).data.return;if(console.log(c),"SUCCESS"===c)j({id:f,text:e.text.returnSucceed,type:oe.c.TYPE.SUCCESS}),g.push({id:l.BARCODE,name:l.BOOKNAME}),console.log(g),x(g);else{let t;t=c in e.text?e.text[c]:e.text.NOT_AVAILABLE,console.log(t),j({id:f,text:t,type:oe.c.TYPE.ERROR})}a({}),O("")}(),children:[" ",e.text.confirm," "]}),Object(i.jsxs)("button",{id:"cancel",onClick:()=>(console.log("Cancelled"),d(!1),a({}),void O("")),children:[" ",e.text.cancel," "]})]}),g.length>0&&Object(i.jsx)(P,{list:g,showCallback:e=>p(e)})]}),Object(i.jsxs)("button",{id:"logOutButton",onClick:()=>(async()=>{console.log("Finish"),m("/")})(),children:[" ",e.text.finish," "]})]})};o(256);var he=function(e){const[t,o]=Object(c.useState)(!1),[n,s]=Object(c.useState)(!0),[l,a]=Object(c.useState)({});function r(e,t){console.log(e),console.log(t);var o=l;switch(e){case 0:o.USER_NAME=t;break;case 1:o.PHONE_NUMBER=t;break;case 2:o.EMAIL=t;break;case 3:o.ADDRESS=t;break;case 4:o.USER_LEVEL=t;break;case 5:o.NOTICE=t}const c=Object.keys(o).length;console.log(c),c>1&&s(!1),a(o)}return Object(c.useEffect)((function(){console.log("User Info"),console.log(e.info),document.getElementById("userName").value=e.info.USER_NAME?e.info.USER_NAME:"",document.getElementById("phone").value=e.info.PHONE_NUMBER?e.info.PHONE_NUMBER:"",document.getElementById("email").value=e.info.EMAIL?e.info.EMAIL:"",document.getElementById("address").value=e.info.ADDRESS?e.info.ADDRESS:"",document.getElementById("notice_").value=e.info.NOTICE?e.info.NOTICE:"",document.getElementById("user_level").value=e.info.USER_LEVEL,a({USER_CODE:e.info.USER_CODE}),s(!0)}),[e.info]),Object(i.jsxs)("div",{children:[Object(i.jsx)("table",{children:Object(i.jsxs)("tbody",{children:[Object(i.jsxs)("tr",{children:[Object(i.jsxs)("td",{children:[" ",e.text.name," "]}),Object(i.jsx)("td",{colSpan:"3",children:Object(i.jsx)("input",{type:"text",className:"input",id:"userName",onChange:e=>{r(0,e.target.value)}})})]},"Name"),"REG_DATE"in e.info&&Object(i.jsxs)("tr",{children:[Object(i.jsxs)("td",{children:[" ",e.text.registeredDate," "]}),Object(i.jsx)("td",{colSpan:"3",className:"data",children:e.info.REG_DATE})]},"Register"),Object(i.jsxs)("tr",{children:[Object(i.jsxs)("td",{children:[" ",e.text.phone," "]}),Object(i.jsx)("td",{colSpan:"3",children:Object(i.jsx)("input",{type:"text",className:"input",id:"phone",onChange:e=>{r(1,e.target.value)}})})]},"Phone"),Object(i.jsxs)("tr",{children:[Object(i.jsxs)("td",{children:[" ",e.text.email," "]}),Object(i.jsx)("td",{colSpan:"3",children:Object(i.jsx)("input",{type:"text",className:"input",id:"email",onChange:e=>{r(2,e.target.value)}})})]},"Email"),Object(i.jsxs)("tr",{children:[Object(i.jsxs)("td",{children:[" ",e.text.address," "]}),Object(i.jsx)("td",{colSpan:"3",children:Object(i.jsx)("input",{type:"text",className:"input",id:"address",onChange:e=>{r(3,e.target.value)}})})]},"Address"),Object(i.jsxs)("tr",{children:[Object(i.jsxs)("td",{children:[" ",e.text.notice_," "]}),Object(i.jsx)("td",{colSpan:"3",children:Object(i.jsx)("input",{type:"text",className:"input",id:"notice_",onChange:e=>{r(5,e.target.value)}})})]},"Notice"),Object(i.jsxs)("tr",{children:[Object(i.jsxs)("td",{children:[" ",e.text.level," "]}),Object(i.jsx)("td",{colSpan:"3",className:"cell",children:Object(i.jsxs)("select",{name:"User Level",id:"user_level",className:"dropdown",onChange:e=>{r(4,e.target.value)},children:[Object(i.jsxs)("option",{value:"0",children:[" ",e.text.kid," "]}),Object(i.jsxs)("option",{value:"1",children:[" ",e.text.adult," "]}),Object(i.jsxs)("option",{value:"2",children:[" ",e.text.admin," "]})]})})]},"Level")]})}),Object(i.jsxs)("button",{id:"modify",hidden:t,onClick:async()=>o(!0),disabled:n,children:[" ",e.text.save," "]}),Object(i.jsxs)("div",{id:"checkModify",hidden:!t,children:[Object(i.jsxs)("div",{id:"noticeMsg",children:[" ",e.text.confirmSave," "]}),Object(i.jsxs)("button",{id:"confirm",onClick:()=>async function(){console.log("Save modification"),console.log(l);const t=e.doc.serverInfo.localIp,c=e.doc.serverInfo.port;if(0===t.length||c<=0)return;const n="https://"+t+":"+c+"/user";var s={};console.log(l);for(const e in l)s[e]=btoa(m(l[e]));const i=await e.doc.requestPost(n,s);console.log(i),e.refresh(i),o(!1)}(),children:[" ",e.text.confirm," "]}),Object(i.jsxs)("button",{id:"cancel",onClick:()=>{o(!1)},children:[" ",e.text.cancel," "]})]})]})};var Oe=function(e){const[t,s]=Object(c.useState)(""),[a]=Object(J.a)(t,300),[r,u]=Object(c.useState)(!1),[h,O]=Object(c.useState)([]),[x,f]=Object(c.useState)(!1),[p,{loading:S,data:k,error:E}]=Object(d.a)(K),[_,N]=Object(c.useState)({}),y=Object(c.useRef)("0"),{id:C}=Object(v.r)(),[I,R]=Object(c.useState)([]),A=Object(v.p)();async function D(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(console.log("All data loaded "+x),t){const t=b;t.type=oe.c.TYPE.SUCCESS,t.render=e.text.succeededToOpen,t.autoClose=3e3,t.toastId="",oe.c.info(e.text.succeededToOpen,t)}console.log("Set title "+e.logged),console.log("Done"),f(!0)}function T(e){console.log("Refresh page "+r),console.log(e),u(!r)}Object(c.useEffect)((function(){!async function(){e.doc.initialized&&(e.doc.isOpen()?D(!1):e.doc.setCallback(D),console.log("======================================="),console.log("UserSearch initialize"),console.log("User ID: "+C),e.doc.serverAvailable?o.e(0).then(o.t.bind(null,467,7)):(console.log("Load users"),p()))}()}),[]),Object(c.useEffect)((()=>{console.log("Updated id: "+C),s(C||"")}),[C]),Object(c.useEffect)((()=>{console.log("User data updated "),D(!1)}),[e.logged]),Object(c.useEffect)((()=>{if(console.log("User list loaded"),console.log(E),console.log(S),k){const o=k.user;var t=[];console.log("User list available");for(let c=0;c<o.length;c++){const n=o[c],s={id:n._id,name:n.name,level:n.level,state:j(e.text,n.state)};t.push(s)}console.log(t),e.doc.setUser(t),console.log(e.doc.getUser()),N(e.doc.getUser())}}),[k,S,E,e]);const w=(t,o)=>{const c=t.id,s=t.rentDate,a=t.retDate,r=t.title,d=t.extendCount,u=o.toString();return Object(i.jsxs)(n.a.Fragment,{children:[Object(i.jsxs)("tr",{className:"bookData",children:[Object(i.jsx)("td",{className:"bookData",children:Object(i.jsx)(l.b,{to:"/search/"+c,children:c})}),Object(i.jsx)("td",{className:"bookData",children:s}),Object(i.jsx)("td",{className:"bookData",children:a})]},u),Object(i.jsxs)("tr",{className:"bookName",children:[Object(i.jsx)("td",{colSpan:e.doc.serverAvailable?"2":"3",className:"bookName",children:r}),e.doc.serverAvailable&&Object(i.jsx)("td",{className:"bookName",children:Object(i.jsx)("button",{className:"extend",onClick:()=>async function(t){console.log("Extend "+t);const o=e.doc.serverInfo.localIp,c=e.doc.serverInfo.port;if(0===o.length||c<=0)return;const n="https://"+o+":"+c+"/extend";var s={};s.book=t;const l=await e.doc.requestPost(n,s);if(console.log("Extended"),console.log(l),L(y.current,!0),"SUCCESS"===l.data.return){const t=b;t.type=oe.c.TYPE.SUCCESS,t.render=e.text.succeededToOpen,t.autoClose=3e3,t.toastId="",oe.c.info(e.text.extend,t)}}(c),children:e.text.extend+" ("+d.toString()+")"})})]},u+"Title")]},u+"Fragment")},L=async function(t){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const c=await e.doc.getRent(t);console.log(c),-1===y.current||y.current!==t||o?(console.log("Select "+t),y.current=t,console.log("Set Rent List"),console.log(c),R(c)):h.length>1&&(console.log("Deselect "+t),y.current=-1,R([]))},U=(t,o)=>Object(i.jsxs)("div",{children:[t.map(((e,t)=>((e,t,o)=>{const c=o.toString();return Object(i.jsxs)("div",{children:[Object(i.jsx)("table",{children:Object(i.jsx)("tbody",{children:Object(i.jsxs)("tr",{className:"searchTr",onClick:async()=>await L(e.id),children:[Object(i.jsx)("td",{className:"bookData",children:e.id}),Object(i.jsx)("td",{className:"bookData",children:e.name}),Object(i.jsx)("td",{className:"bookData",children:e.state}),Object(i.jsx)("td",{className:"bookData",children:e.rent})]},e.id)})}),e.id===y.current&&B(e,t)]},c)})(e,o,t))),0===t.length&&Object(i.jsx)("table",{children:Object(i.jsx)("tbody",{children:Object(i.jsx)("tr",{children:Object(i.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")})})]}),B=(t,o)=>(console.log("Detail"),console.log(t),Object(i.jsxs)(i.Fragment,{children:[e.doc.serverAvailable&&Object(i.jsxs)("div",{children:[Object(i.jsx)(he,{text:e.text,doc:e.doc,info:t,refresh:T}),Object(i.jsxs)("button",{id:"modify",onClick:()=>A("/checkOut/"+t.USER_CODE),children:[" ",e.text.checkOut," "]})]}),Object(i.jsx)("table",{children:Object(i.jsxs)("tbody",{children:[Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{id:"id",children:e.text.id}),Object(i.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(i.jsx)("th",{id:"returnDate",children:e.text.dueDate})]},"ID"),o.map(((e,t)=>w(e,t))),0===o.length&&Object(i.jsx)("tr",{children:Object(i.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})]}));return Object(c.useEffect)((()=>{!async function(){const o=t.trim();if(console.log("Query "+o+" "+a),o.length>0&&a){let t;if(e.doc.serverAvailable){console.log("from CLIB");const c="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/users",n={user:btoa(m(o))},s=await e.doc.requestGet(c,n),l=s.data.return.data;if(console.log(s.data.return),t=[],l)for(const o of s.data.return.data){console.log(o);let c=o;c.id=o.USER_CODE,c.name=o.USER_NAME,c.state=j(e.text,o.USER_STATE),c.rent=o._RENT.length,t.push(c)}}else console.log("from DB"),t=await async function(e){let t=[];for(const o in _){const c=_[o];if(t.length>=500)break;(c.name&&c.name.toString().includes(e)||c.id.toLowerCase()===e.toLowerCase())&&t.push(c)}return t.sort(g),console.log(t),t}(a);t.length>0?O(t):O([]),1===t.length?L(t[0].id):L(0)}else O([])}()}),[a,e,_,r,t]),e.doc.initialized?Object(i.jsxs)("div",{id:"checkOut",children:[Object(i.jsx)("div",{id:"title",children:Object(i.jsx)("h2",{children:e.text.userSearch})}),Object(i.jsxs)("div",{id:"checkOutInput",hidden:!e.doc.admin,children:[Object(i.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:t,onChange:e=>{s(e.target.value)}}),Object(i.jsx)("div",{children:Object(i.jsx)(P,{keyValue:a,list:h,detail:I,showCallback:(e,t)=>U(e,t)})})]})]}):Object(i.jsx)(v.a,{to:"/"})};var ge=function(e){const[t,s]=Object(c.useState)([]),[a,r]=Object(c.useState)(!1),[u,{loading:b,data:O,error:g}]=Object(d.a)(K),[m,f]=Object(c.useState)({});async function p(){if(console.log("All data loaded "+a),e.doc.serverAvailable){let t=[];const o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",c={user:"*",match:!1},n=(await e.doc.requestGet(o,c)).data.return.books;for(let s=0;s<n.length;s++){const o=n[s],c="".concat(o.BOOKNAME," ").concat(o.CLAIMNUM),l=o._STATE;let i="";1!==l&&3!==l&&"1"!==l&&"3"!==l||(i=o.RETURN_DATE);let a={index:s,text:c,title:o.BOOKNAME,id:o.BARCODE,rent:h(e.text,o.STATS.toString()),rentDate:o.LENT_DATE,retDate:i,author:o.AUTHOR,totalName:o.TOTAL_NAME,claim_num:o.CLAMENUM,publish:o.PUBLISH,claim:o.CLAIM,user:o.USER,userName:o.USER_NAME};t.push(a)}t.sort(x),s(t)}else{const t=await e.doc.getRent();console.log("Rent"),console.log(t),t.sort(x);for(const e in t){const o=t[e].user;let c;c=m&&o in m?m[o].name:"",t[e].userName=c}s(t)}console.log("Done"),r(!0)}Object(c.useEffect)((function(){!async function(){console.log("======================================="),console.log("RentHistory initialize"),e.doc.serverAvailable?(o.e(0).then(o.t.bind(null,467,7)),p()):(console.log("Load users"),u())}()}),[]),Object(c.useEffect)((()=>{if(console.log("User list loaded"),console.log(g),console.log(b),O){const o=O.user;var t=[];console.log("User list available");for(let c=0;c<o.length;c++){const n=o[c],s={id:n._id,name:n.name,level:n.level,state:j(e.text,n.state)};t.push(s)}e.doc.setUser(t),f(e.doc.getUser())}}),[O,b,g,e.doc,e.text]),Object(c.useEffect)((()=>{p()}),[m]);const S=t=>Object(i.jsx)("div",{children:Object(i.jsx)("table",{children:Object(i.jsxs)("tbody",{children:[Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{id:"id",children:e.text.id}),Object(i.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(i.jsx)("th",{id:"returnDate",children:e.text.dueDate})]},"ID"),t&&t.map(((e,t)=>((e,t)=>{const o=e.id,c=e.rentDate,s=e.retDate,a=e.user,r=e.userName,d=t.toString(),u=e.claim;return Object(i.jsxs)(n.a.Fragment,{children:[Object(i.jsxs)("tr",{className:"bookTop",children:[Object(i.jsx)("td",{className:"bookCell",children:Object(i.jsx)(l.b,{to:"/search/"+o,children:o})}),Object(i.jsx)("td",{className:"bookCell",children:c}),Object(i.jsx)("td",{className:"bookCell",children:s})]},d),Object(i.jsxs)("tr",{className:"bookRow",children:[Object(i.jsx)("td",{className:"bookName",children:u}),Object(i.jsxs)("td",{colSpan:"2",className:"bookName",children:[e.totalName+" ",Object(i.jsx)("b",{children:e.title})," "+e.claim_num]})]},d+"Title"),Object(i.jsxs)("tr",{className:"bookBottom",children:[Object(i.jsx)("td",{className:"bookCell",children:Object(i.jsxs)(l.b,{to:"/userSearch/"+a,children:[" ",a," "]})}),Object(i.jsxs)("td",{colSpan:"2",className:"bookCell",children:[" ",r," "]})]},d+"Renter")]},d+"Fragment")})(e,t))),t&&0===t.length&&Object(i.jsx)("tr",{children:Object(i.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})});return e.doc.initialized?Object(i.jsxs)("div",{id:"situation",children:[Object(i.jsx)("div",{id:"title",children:Object(i.jsx)("h2",{children:e.text.situation})}),Object(i.jsx)("div",{id:"checkOutResult",children:Object(i.jsx)(P,{keyValue:"",list:t,showCallback:e=>S(e)})})]}):Object(i.jsx)(v.a,{to:"/"})};var xe=function(e){const[t,s]=Object(c.useState)([]),[a,r]=Object(c.useState)(""),[u,b]=Object(c.useState)(""),[h,{loading:O,data:g,error:m}]=Object(d.a)(K),[f,{loading:p,data:S,error:E}]=Object(d.a)(V,{variables:{fromTime:a,toTime:u}}),[N,y]=Object(c.useState)({}),[C,I]=Object(c.useState)(0),[R,A]=Object(c.useState)(0),[D,T]=Object(c.useState)(""),[w]=Object(J.a)(D,300);Object(c.useEffect)((function(){!async function(){if(console.log("======================================="),console.log("RentHistory initialize"),!e.doc.initialized)return;var t,c,n=document.getElementById("year"),s=document.getElementById("month");for(t=1;t<=12;t++)(c=document.createElement("option")).text=t.toString(),s.add(c,t);const l=(new Date).getFullYear(),i=(new Date).getMonth()+1;for(t=2017;t<=l;t++)(c=document.createElement("option")).text=t.toString(),n.add(c,t);console.log(l),console.log(i),I(l),A(i),document.getElementById("year").value=l,document.getElementById("month").value=i,e.doc.serverAvailable?o.e(0).then(o.t.bind(null,467,7)):(console.log("Load users"),h())}()}),[]),Object(c.useEffect)((()=>{if(console.log("User list loaded"),console.log(m),console.log(O),g){const o=g.user;var t=[];console.log("User list available");for(let c=0;c<o.length;c++){const n=o[c],s={id:n._id,name:n.name,level:n.level,state:j(e.text,n.state)};t.push(s)}e.doc.setUser(t),y(e.doc.getUser())}}),[g,O,m,e.doc,e.text]),Object(c.useEffect)((()=>{if(console.log("History update"),!S)return;const t=S.rentLog;let o=[],c="";for(let s=0;s<t.length;s++){const i=t[s],a=i.book_state;if("1"!==a&&1!==a)continue;if(!i.return_date||0===i.return_date.length)continue;const r=i.book_id,d=i.user_id;var n,l;n=N&&d in N?N[d].name:"",r in e.doc.book?l=e.doc.book[r]:((l={}).author="",l.totalName="",l.claim_num="",l.publish="",l.title="");const u="".concat(l.title," ").concat(l.claim_num);c=i.return_date;let b={index:s,text:u,title:l.title,id:r,rentDate:i.timestamp,retDate:c,author:l.author,totalName:l.series,claim_num:l.claim_num,publish:l.publisher,claim:l.claim,user:d,userName:n};o.push(b)}o.sort(x),console.log(o),s(o)}),[S,p,E]);const L=t=>Object(i.jsx)("div",{children:Object(i.jsx)("table",{children:Object(i.jsxs)("tbody",{children:[Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{id:"id",children:e.text.id}),Object(i.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(i.jsx)("th",{id:"returnDate",children:e.text.returnDate})]},"ID"),t&&t.map(((e,t)=>((e,t)=>{const o=e.id,c=e.rentDate,s=e.retDate,a=e.claim,r=e.user,d=e.userName,u=t.toString();return Object(i.jsxs)(n.a.Fragment,{children:[Object(i.jsxs)("tr",{className:"bookTop",children:[Object(i.jsx)("td",{className:"bookCell",children:Object(i.jsx)(l.b,{to:"/search/"+o,children:o})}),Object(i.jsx)("td",{className:"bookCell",children:c}),Object(i.jsx)("td",{className:"bookCell",children:s})]},u),Object(i.jsxs)("tr",{className:"bookRow",children:[Object(i.jsx)("td",{className:"bookName",children:a}),Object(i.jsxs)("td",{colSpan:"2",className:"bookCell",children:[e.totalName+" ",Object(i.jsx)("b",{children:e.title})," "+e.claim_num]})]},u+"Title"),Object(i.jsxs)("tr",{className:"bookBottom",children:[Object(i.jsx)("td",{className:"bookCell",children:Object(i.jsxs)(l.b,{to:"/userSearch/"+r,children:[" ",r," "]})}),Object(i.jsxs)("td",{colSpan:"2",className:"bookCell",children:[" ",d," "]})]},u+"Renter")]},u+"Fragment")})(e,t))),t&&0===t.length&&Object(i.jsx)("tr",{children:Object(i.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})});function U(e,t){switch(console.log(e),console.log(t),e){case 0:I(t);break;case 1:A(parseInt(t))}}return Object(c.useEffect)((function(){T(C.toString()+"-"+R.toString().padStart(2,"0"))}),[C,R]),Object(c.useEffect)((function(){!async function(){if(console.log("Search"),e.doc.serverAvailable){const t="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/history",o={period:D},c=await e.doc.requestGet(t,o);console.log(c);const n=c.data.return.books;let l=[],i="";for(let e=0;e<n.length;e++){const t=n[e],o="".concat(t.BOOKNAME," ").concat(t.CLAIMNUM);"_RETURN_DATE"in t&&(i=t._RETURN_DATE);let c={index:e,text:o,title:t.BOOKNAME,id:t.BARCODE,rentDate:t.RENT_DATE,retDate:i,author:t.AUTHOR,totalName:t.TOTAL_NAME,claim_num:t.CLAMENUM,publish:t.PUBLISH,claim:t.CLAIM,user:t.USER,userName:t.USER_NAME};l.push(c)}l.sort(x),s(l)}else{var t;const e=R+1;t=C.toString()+"-"+e.toString().padStart(2,"0"),r(D),b(t),console.log(D),console.log(t);try{await f()}catch(o){console.warn(o.name)}}}()}),[w]),e.doc.initialized?Object(i.jsxs)("div",{id:"checkOut",children:[Object(i.jsx)("div",{id:"title",children:Object(i.jsx)("h2",{children:e.text.history})}),Object(i.jsxs)("div",{id:"searchRange",children:[Object(i.jsx)("div",{className:"page",id:"page",children:Object(i.jsx)(k.a,{fontSize:"large",sx:{color:"#404040"},onClick:()=>{!function(){var e=C,t=R;"string"===typeof e&&(e=parseInt(e)),"string"===typeof t&&(t=parseInt(t)),console.log(e),console.log(t),console.log(typeof e),console.log(typeof t),t>1?t-=1:(e-=1,t=12),I(e),A(t),document.getElementById("year").value=e,document.getElementById("month").value=t}()}})}),Object(i.jsx)("select",{name:"year",id:"year",className:"dropdown",onChange:e=>{U(0,e.target.value)}}),Object(i.jsx)("select",{name:"month",id:"month",className:"dropdown",onChange:e=>{U(1,e.target.value)}}),Object(i.jsx)("div",{className:"page",id:"page",children:Object(i.jsx)(_.a,{fontSize:"large",sx:{color:"#404040"},onClick:()=>{!function(){var e=C,t=R;"string"===typeof e&&(e=parseInt(e)),"string"===typeof t&&(t=parseInt(t)),console.log(e),console.log(t),console.log(typeof e),console.log(typeof t),t<12?t+=1:(e+=1,t=1),I(e),A(t),document.getElementById("year").value=e,document.getElementById("month").value=t}()}})})]}),Object(i.jsx)("div",{id:"checkOutResult",children:Object(i.jsx)(P,{keyValue:w,list:t,showCallback:e=>L(e)})})]}):Object(i.jsx)(v.a,{to:"/"})};var me=function(e){const[t,n]=Object(c.useState)({}),[s,l]=Object(c.useState)(!1);function a(){var e={USER_CODE:"",USER_NAME:"",PHONE_NUMBER:"",EMAIL:"",ADDRESS:"",NOTICE:"",USER_LEVEL:-1};n(e)}return Object(c.useEffect)((function(){!async function(){e.doc.initialized&&e.doc.serverAvailable&&(o.e(0).then(o.t.bind(null,467,7)),console.log("======================================="),console.log("NewMember initialize"),a())}()}),[]),e.doc.initialized&&e.doc.serverAvailable?Object(i.jsxs)("div",{id:"checkOut",children:[Object(i.jsx)("div",{id:"title",children:Object(i.jsx)("h2",{children:e.text.newMember})}),Object(i.jsx)("div",{id:"checkOutInput",hidden:!e.doc.admin,children:e.doc.serverAvailable&&Object(i.jsx)(he,{text:e.text,doc:e.doc,info:t,refresh:function(t){console.log("Refresh page "+s),console.log(t),l(!s);const o=b;var c;"OK"===t.data.return?(o.type=oe.c.TYPE.SUCCESS,c=e.text.regSuccess,a()):(o.type=oe.c.TYPE.ERROR,c=e.text.regFail),o.autoClose=3e3,oe.c.info(c,o)}})})]}):Object(i.jsx)(v.a,{to:"/"})},fe=(o(257),o(461));var pe=class{constructor(){console.log("Create Doc class"),this.initialized=!1,this.bookReady=!1,this.rentReady=!1,this.userReady=!1,this.logged=!1,this.userInfo={},this.book={},this.rent={},this.request=new Set,this.logCallback=void 0,this.admin=!1,this.dueDate="",this.serverInfo={},this.serverAvailable=!1,this.ipAddr=""}async requestGet(e,t){t.os=navigator.platform;const o={params:t};console.log("Request GET : "+e);return await fe.a.get(e,o)}async requestPost(e,t){console.log("Request POST: "+e),t.os=navigator.platform;return await fe.a.post(e,t)}async updateIpAddr(){}checkServerIp(){}checkState(){this.bookReady&&this.rentReady&&(this.initialized=!0,oe.c.dismiss(),this.callback&&this.callback())}setLogCallback(e){this.logCallback=e}setRent(e){this.rent=e,this.rentReady=!0,this.checkState(),this.checkRent()}setRequest(e){for(const t of e)this.request.add(t.book_id)}hasRequest(e){return this.request.has(e)}addRequest(e){this.request.add(e)}setServerInfo(e){console.log(e),this.serverInfo=e,this.serverInfo={},this.serverInfo.globalIp=e.globalIp,e.proxy?(this.serverInfo.localIp="libserver.hkmcclibrary.duckdns.org",this.serverInfo.port=443):(this.serverInfo.localIp=e.localIp,this.serverInfo.port=e.port),console.log(this.serverInfo),this.checkServerIp()}setBook(e){this.book={},console.log("Register "+e.length+" books");for(let t=0;t<e.length;t++){const o=e[t],c=o._id;this.book[c]={...o},this.book[c].claim=o.claim.replace(/_/g," ")}this.bookReady=!0,this.checkState()}setUser(e){this.user={};for(let t=0;t<e.length;t++){const o=e[t],c=o.id;this.user[c]=o,this.user[c].rent=0}this.userReady=!0,this.checkRent()}checkRent(){if(this.userReady&&this.rentReady)for(let e=0;e<this.rent.length;e++){const t=this.rent[e].state;if("1"!==t&&"3"!==t&&1!==t&&3!==t)continue;const o=this.rent[e].user_id;o&&o.length>0&&o in this.user?"rent"in this.user[o]?this.user[o].rent+=1:this.user[o].rent=1:(console.log("Invalid user"),console.log(this.rent[e]))}else console.log("Cannot check rent")}logIn(e){console.log("Logged in: "+e._id),this.logged=!0,this.userInfo=e,"2"!==e.level&&2!==e.level||(this.admin=!0),this.logCallback&&this.logCallback(!0);const t=e._id;console.log(t)}logOut(){console.log("Logged out"),this.logged=!1,this.admin=!1,this.userInfo={},this.request.clear(),this.logCallback&&this.logCallback(!1)}async getRent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=[];if(this.serverAvailable){const o="https://"+this.serverInfo.localIp+":"+this.serverInfo.port+"/book",c={user:e},n=await this.requestGet(o,c);if(console.log(n),"books"in n.data.return)for(const e of n.data.return.books){console.log(e);const o={id:e.BARCODE,title:e.BOOKNAME,claim:e.CLAIM,claim_num:e.CLAMENUM,totalName:e.TOTAL_NAME,rentDate:e.LENT_DATE,retDate:e.RETURN_DATE,stat:e.STATS,extendCount:e._EXTEND_COUNT};t.push(o)}}else{if(console.log("Check "+e),console.log(this.bookReady),!this.bookReady)return t;for(let o=0;o<this.rent.length;o++){const c=this.rent[o];if(void 0!==e&&c.user_id!==e)continue;if("1"!==c.state&&"3"!==c.state&&1!==c.state&&3!==c.state)continue;const n=c.book_id,s=this.book[n];let l={};l.id=s._id,l.title=s.title,l.claim_num=s.claim_num,l.totalName=s.series,l.rentDate=c.rent_date.split(" ")[0].replace("-","/",2).replace("-","/"),l.retDate=c.return_date.split(" ")[0].replace("-","/",2).replace("-","/"),l.claim=s.claim,l.user=c.user_id,l.extendCount=c.extend_count,t.push(l)}}return t}getUser(){return this.user}async openDoc(){try{this.initialized=!0}catch(e){return console.log(e),!1}return!0}isOpen(){return this.initialized}setCallback(e){console.log("Update function registered"),this.callback=e}},ve=o(460),Se=o(453),ke=o(454),Ee=o(62);const _e=o(261),Ne=Ee.queue_url;var ye=class{constructor(e){console.log("Create Context"),console.log("Cookies");const t=document.cookie;this.cookie=t.split(";").map((e=>e.split("="))).reduce(((e,t)=>{const o=t.shift().trim(),c=t.join("=").trim();return e[decodeURIComponent(o)]=decodeURIComponent(c),e}),{});const o=e.REACT_APP_AWSS_KEY1+e.REACT_APP_AWSS_KEY2,c=e.REACT_APP_AWSS_SECRET1+e.REACT_APP_AWSS_SECRET2,n={region:Ee.region,credentials:{accessKeyId:o,secretAccessKey:c}};this.sqsClient=new ve.a(n),this.prk=new _e(e.REACT_APP_PRIVATE_KEY)}checkLogIn(e,t){var o,c=!1;if(e&&t.length>0){console.log("User data available");const s=e.encrypted_email,l=e.encrypted_phone;if(o=this.prk.sign(t,"base64"),t===s||t===l)o=t,c=!0;else if(s===o)c=!0;else{var n="";for(let e=0;e<t.length;e++)isNaN(t[e])||(n+=t[e]);(o=this.prk.sign(n,"base64"))===l&&(c=!0)}}if(c){const e=new Date,t=2;e.setTime(e.getTime()+24*t*60*60*1e3);const c=e.toGMTString();document.cookie="password="+o+"; expires="+c+" ; SameSite=Lax ;"}return c}async sendRequest(e){const t=Math.floor(1e8*Math.random()).toString();try{const o=new Se.a({MessageBody:e,QueueUrl:Ne,MessageGroupId:"1",MessageDeduplicationId:t});await this.sqsClient.send(o)}catch(o){console.log(o)}}async receiveRequest(){console.log("Read request");var e=[];try{const t=new ke.a({QueueUrl:Ne,AttributeNames:[""],MessageAttributeNames:["STRING_VALUE"],MaxNumberOfMessages:100,VisibilityTimeout:5,WaitTimeSeconds:5}),o=await this.sqsClient.send(t);if(console.log(o),void 0!==o.Messages)for(const c of o.Messages){const t=JSON.parse(c.Body);e.push(t)}}catch(t){console.log(t)}return e}},Ce=o(148),Ie=o(227),Re=(o(413),o(414),o(228)),Ae=o.n(Re);var De=function(e){const[t,n]=Object(c.useState)(!1);Object(c.useEffect)((()=>{e.doc.serverAvailable&&o.e(4).then(o.t.bind(null,468,7)),t&&setTimeout((function(){console.log("Register close"),window.addEventListener("click",s)}),100);const c=document.getElementById("dropdown-menu");return t?c.classList.add("is-show"):c.classList.remove("is-show"),()=>{window.removeEventListener("click",s)}}),[t,e.doc.logged,e.doc.serverAvailable]);const s=()=>{console.log("Close"),console.log(t),n(!1),window.removeEventListener("click",s)};return Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{className:"menu",onClick:()=>{console.log("Click menu"),n(!t),console.log(t),t&&window.removeEventListener("click",s)},children:Object(i.jsx)(Ae.a,{className:"img",fontSize:"large",sx:{color:"#ffffff"}})}),Object(i.jsxs)("div",{id:"dropdown-menu",onClick:()=>{s()},className:"dropdown-menu",children:[!e.doc.serverAvailable&&e.doc.logged&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("div",{className:"menu-items",children:e.doc.userInfo._id+" : "+e.doc.userInfo.name+e.text.nameSuffix}),Object(i.jsx)("hr",{className:"hline"})]}),Object(i.jsx)(l.b,{className:"menu-items",to:"/",children:e.text.home}),Object(i.jsx)(l.b,{className:"menu-items",to:"/notice",children:e.text.notice}),Object(i.jsx)(l.b,{className:"menu-items",to:"/search",children:e.text.bookSearch}),e.doc.serverAvailable&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(l.b,{className:"menu-items",to:"/checkOut",children:e.text.checkOut}),Object(i.jsx)(l.b,{className:"menu-items",to:"/return",children:e.text.return})]}),!e.doc.serverAvailable&&e.doc.logged&&Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(l.b,{className:"menu-items",to:"/checkOutStatus",children:e.text.checkOutStatus})}),e.doc.admin&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("hr",{className:"hline"}),Object(i.jsx)(l.b,{className:"menu-items",to:"/userSearch",children:e.text.userSearch}),Object(i.jsx)(l.b,{className:"menu-items",to:"/rentalSituation",children:e.text.situation}),Object(i.jsx)(l.b,{className:"menu-items",to:"/rentHistory",children:e.text.history})]}),e.doc.serverAvailable&&e.doc.admin&&Object(i.jsx)(l.b,{className:"menu-items",to:"/newMember",children:e.text.newMember}),!e.doc.serverAvailable&&e.doc.logged&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("hr",{className:"hline"}),Object(i.jsx)("div",{className:"menu-items",onClick:()=>{e.doc.logOut(),document.cookie="user_id=",document.cookie="password=",document.cookie="autoLogin=false"},children:e.text.logOut})]}),!e.doc.serverAvailable&&!e.doc.logged&&Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(l.b,{className:"menu-items",to:"/checkOutStatus",children:e.text.logIn})})]})]})};var Te=function(e){return Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)("div",{id:"navbar",className:"navbar",children:[Object(i.jsx)("div",{className:"title",children:Ie.isMobile?Object(i.jsx)("h1",{children:e.text.titleShort}):Object(i.jsx)("h1",{children:e.text.titleLong})}),Object(i.jsx)(De,{text:e.text,doc:e.doc})]})})};const we=new pe,Le=new ye(Object({NODE_ENV:"production",PUBLIC_URL:"/library",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AWSS_KEY1:"AKIARJHWVM",REACT_APP_AWSS_KEY2:"Y4YGU3MDMX",REACT_APP_AWSS_SECRET1:"Xvk2fxmia49bRets3DvZ",REACT_APP_AWSS_SECRET2:"G0bqmrQvaiBofvpnfQ7Q",REACT_APP_NAME:"library",REACT_APP_VERSION:"0.9.11"})),Ue={};let Be="";var Pe=function(){const[e,t]=Object(c.useState)(!1),[o,n]=Object(c.useState)(!1),[s,u]=Object(c.useState)(""),{loading:j,error:h,data:O}=Object(r.e)(H),[g,{data:x}]=Object(d.a)($,{variables:{user_id:s}}),{loading:m,error:p,data:S}=Object(r.e)(Q),[k,{data:E}]=Object(d.a)(F,{variables:{_id:s}});function _(){const e=b;e.type=oe.c.TYPE.SUCCESS,e.render=Ue.succeededToOpen,e.autoClose=3e3,e.toastId="",oe.c.info(Ue.succeededToOpen,e)}function N(e){console.log("==== Update logging state "+we.logged),n(we.logged)}return Object(c.useEffect)((function(){!async function(){console.log("Initialize app"),console.log("Platform: "),console.log(navigator.platform),Be+="<p>Initialize app</p>",console.log("library"),console.log("0.9.11"),console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/library",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AWSS_KEY1:"AKIARJHWVM",REACT_APP_AWSS_KEY2:"Y4YGU3MDMX",REACT_APP_AWSS_SECRET1:"Xvk2fxmia49bRets3DvZ",REACT_APP_AWSS_SECRET2:"G0bqmrQvaiBofvpnfQ7Q",REACT_APP_NAME:"library",REACT_APP_VERSION:"0.9.11"}).REACT_APP_QUEUE_URL);const e=navigator.languages;console.log(e);let o={};o=e.length>0&&(e[0].toLowerCase().includes("kr")||e[0].toLowerCase().includes("ko"))?Ce.kr:Ce.en;for(let t in o)Ue[t]=o[t];await we.updateIpAddr(),"autoLogin"in Le.cookie&&"true"===Le.cookie.autoLogin&&(console.log("Auto Login: "+Le.cookie.user_id),u(Le.cookie.user_id),console.log(Le.cookie.nothing),k()),t(!0)}()}),[k]),Object(c.useEffect)((()=>{if(console.log("User data loaded"),!E)return;const e=E.user[0];Le.cookie.password&&Le.checkLogIn(e,Le.cookie.password)&&(console.log("Login suceeded"),we.logIn(e),g())}),[E]),Object(c.useEffect)((()=>{console.log("Rent Query Updated"),Be=Be+"<p>Rent Query Updated "+j+" "+h+"</p>",console.log(j),console.log("Rent Error"),console.log(h),O&&(console.log("Rent available"),Be+="<p>Rent available</p>",we.setRent(O.rent),we.initialized&&_())}),[j,h,O]),Object(c.useEffect)((()=>{console.log("Request Query Updated"),x&&(console.log("Request available"),we.setRequest(x.request))}),[x]),Object(c.useEffect)((()=>{if(console.log("Server Query Updated"),Be+="<p>Server Query Updated</p>",console.log(S),console.log(e),S&&e&&(console.log("Server info available"),Be+="<p>Server info available</p>",console.log(S),we.setServerInfo(S.serverInfo),!we.serverAvailable)){console.log("Server is not available. Load books from cloud DB");const e=b;e.type=oe.c.TYPE.LOADING,e.autoClose=!1,e.toastId=f,oe.c.loading(Ue.loading,e),we.setLogCallback(N),console.log("Get github file"),we.requestGet(Ee.book_url,{}).then((function(e){const t=e.data;console.log("Downloaded books");const o=[];for(let c in t){const e=t[c];o.push(e)}we.setBook(o),we.initialized&&_()}))}}),[m,p,S,e]),Object(i.jsx)(l.a,{children:Object(i.jsxs)("div",{className:"App",children:[Object(i.jsx)("div",{children:Object(i.jsx)(oe.a,{newestOnTop:!0,closeOnClick:!0,rtl:!1,draggable:!0,pauseOnHover:!0,pauseOnFocusLoss:!1,transition:oe.b,limit:10})}),Object(i.jsx)(Te,{doc:we,text:Ue}),Object(i.jsxs)(v.d,{children:[Object(i.jsx)(v.b,{path:"/",element:Object(i.jsx)(a,{doc:we,text:Ue})}),Object(i.jsx)(v.b,{path:"/notice/:id?",element:Object(i.jsx)(X,{doc:we,text:Ue})}),Object(i.jsx)(v.b,{path:"/search/:id?",element:Object(i.jsx)(te,{doc:we,text:Ue})}),Object(i.jsx)(v.b,{path:"/checkOutStatus",element:Object(i.jsx)(le,{context:Le,doc:we,text:Ue,logged:o})}),Object(i.jsx)(v.b,{path:"/userSearch/:id?",element:Object(i.jsx)(Oe,{context:Le,doc:we,text:Ue})}),Object(i.jsx)(v.b,{path:"/checkOut/:id?",element:Object(i.jsx)(de,{context:Le,doc:we,text:Ue})}),Object(i.jsx)(v.b,{path:"/return",element:Object(i.jsx)(je,{context:Le,doc:we,text:Ue})}),Object(i.jsx)(v.b,{path:"/rentalSituation",element:Object(i.jsx)(ge,{context:Le,doc:we,text:Ue})}),Object(i.jsx)(v.b,{path:"/rentHistory",element:Object(i.jsx)(xe,{context:Le,doc:we,text:Ue})}),Object(i.jsx)(v.b,{path:"/newMember",element:Object(i.jsx)(me,{context:Le,doc:we,text:Ue})})]}),Object(i.jsxs)("h3",{children:["v ","0.9.11"]})]})})};var Me=e=>{e&&e instanceof Function&&o.e(5).then(o.bind(null,469)).then((t=>{let{getCLS:o,getFID:c,getFCP:n,getLCP:s,getTTFB:l}=t;o(e),c(e),n(e),s(e),l(e)}))},qe=o(463),He=o(462),Ke=o(464),Fe=o(459);const Ge=Object({NODE_ENV:"production",PUBLIC_URL:"/library",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AWSS_KEY1:"AKIARJHWVM",REACT_APP_AWSS_KEY2:"Y4YGU3MDMX",REACT_APP_AWSS_SECRET1:"Xvk2fxmia49bRets3DvZ",REACT_APP_AWSS_SECRET2:"G0bqmrQvaiBofvpnfQ7Q",REACT_APP_NAME:"library",REACT_APP_VERSION:"0.9.11"}).REACT_APP_HASURA_TOKEN,Ye=new qe.a({link:new He.a({uri:Ee.graphql_url,headers:{"x-hasura-admin-secret":Ge}}),cache:new Ke.a}),Ve=document.getElementById("root");Object(s.createRoot)(Ve).render(Object(i.jsx)(n.a.StrictMode,{children:Object(i.jsx)(Fe.a,{client:Ye,children:Object(i.jsx)(Pe,{})})})),Me()},47:function(e,t,o){},62:function(e){e.exports=JSON.parse('{"book_url":"https://raw.githubusercontent.com/linupa/hkmccBook/main/book.json","graphql_url":"https://hkmcc-library.hasura.app/v1/graphql","queue_url":"https://sqs.us-west-1.amazonaws.com/088564131385/HKMCCLibraryRequest.fifo","region":"us-west-1"}')}},[[416,2,3]]]);
//# sourceMappingURL=main.f0369f27.chunk.js.map