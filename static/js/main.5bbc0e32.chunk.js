(this.webpackJsonplibrary=this.webpackJsonplibrary||[]).push([[0],{148:function(e){e.exports=JSON.parse('{"en":{"titleLong":"Holy Korean Martyrs Catholic Church Library","titleShort":"HKMCC Library","idHolder":"Enter User ID","pwHolder":"Enter email or phone","bookHolder":"Enter book ID","logIn":"Log In","logOut":"Log Out","logInSucceed":"Logged in","logInFail":"Log In Failed","nameSuffix":"","home":"Home","checkOutStatus":"Check Out Status","bookSearch":"Book Search","userSearch":"User Search","checkOut":"Check Out","return":"Return","history":"Rent History","situation":"Rent Situation","loading":"Loading DB","succeededToOpen":"Succeeded to load","searchUser":"Enter name or ID","searchBook":"Enter book keywords","failedToOpen":"Failed to open DB Refresh page later","available":"Available","checkedOut":"Checked out","reserved":"Reserved","overDue":"Overdue","lost":"Lost","damaged":"Damanged","given":"Given","notAvailable":"Not available","deleted":"Deleted","id":"ID","bookName":"Book name","rentDate":"Rent date","returnDate":"Return date","dueDate":"Due date","noEntry":"No entry","notice":"Notice","newMember":"New Member","autoLogin":"AutoLogin","userMode":"User Mode","adminMode":"Admin Mode","normal":"Normal","stopped":"Stopped","homeText":"<div class=\\"container\\"><h2>Library Hours:</h2> <ul> <li>Every Sunday 9:30am~12:00pm</li> </ul> <h2>Book Borrowing:</h2> <ul> <li>Every Sunday 10:30am~12:00pm</li> <li>Maximum number of books for borrowing: 5</li> <li>Borrowing period: 3 weeks (Please request an extension from a volunteer at the time of borrowing or send an extension request email to <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>)</li> <li>Book return: Please return the books to the return box in front of the library or directly to the library volunteers.</li> <li>Request for desired books: Please fill out and submit the desired book request form provided at the library.</li> </ul> <h2>For other inquiries:</h2> <ul> <li>Please contact the library by email at <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>.</li> </ul></div>","INVALID_BOOK":"Unregistered book","INVALID_USER":"Invalid user","NOT_AVAILABLE":"Not available","OVERDUE":"Overdue account","RENTED":"Already rented book","MAX_RENTAL":"Max rent reached","NOT_RENTED":"Not a rented book","rentSucceed":"Rented","returnSucceed":"Returned","rentSuffix":" book(s) rented","confirmRent":"Rent this book?","confirmReturn":"Return this book?","confirm":"Confirm","cancel":"Cancel","name":"Name","registeredDate":"Registered","phone":"Phone","email":"Email","address":"Address","notice_":"Notice","level":"Level","save":"Save","confirmSave":"Save the modification?","kid":"Kid","adult":"Adult","admin":"Admin","regSuccess":"Registration Succeed","regFail":"Registration Fail"},"kr":{"titleLong":"\ucc9c\uc8fc\uad50 \uc0b0\ud638\uc138 \ud55c\uad6d \uc21c\uad50\uc790 \uc131\ub2f9 \ub3c4\uc11c\uad00","titleShort":"HKMCC \ub3c4\uc11c\uad00","idHolder":"\ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","pwHolder":"\uc774\uba54\uc77c\uc774\ub098 \uc804\ud654\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","bookHolder":"\ub3c4\uc11c \ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","logIn":"\ub85c\uadf8\uc778","logOut":"\ub85c\uadf8\uc544\uc6c3","logInSucceed":"\ub85c\uadf8\uc778 \uc131\uacf5","logInFail":"\ub85c\uadf8\uc778 \uc2e4\ud328","nameSuffix":" \ub2d8","home":"\ud648","checkOutStatus":"\ub300\ucd9c \uae30\ub85d \uc870\ud68c","bookSearch":"\ub3c4\uc11c \uac80\uc0c9","userSearch":"\ud68c\uc6d0 \uac80\uc0c9","checkOut":"\ub300\ucd9c","return":"\ubc18\ub0a9","history":"\ub300\ucd9c \uc774\ub825","situation":"\ub300\ucd9c \ud604\ud669","loading":"DB \uc870\ud68c \uc911","succeededToOpen":"DB \uc870\ud68c \uc644\ub8cc","searchUser":"\uc774\ub984 \ub610\ub294 \ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","searchBook":"\ucc45 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694","failedToOpen":"DB \uc870\ud68c\uac00 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4 \uc7a0\uc2dc \ud6c4 \ud654\uba74\uc744 \uac31\uc2e0\ud574\uc8fc\uc138\uc694","available":"\ub300\ucd9c\uac00\ub2a5","checkedOut":"\ub300\ucd9c\uc911","reserved":"\uc608\uc57d\uc911","overDue":"\uc5f0\uccb4\uc911","lost":"\ubd84\uc2e4","damaged":"\ud30c\uc190","given":"\uae30\uc99d","notAvailable":"\ub300\ucd9c\ubd88\uac00","deleted":"\ud3d0\uae30","id":"\ubc88\ud638","bookName":"\ub3c4\uc11c\uba85","rentDate":"\ub300\ucd9c\uc77c","returnDate":"\ubc18\ub0a9\uc77c","dueDate":"\ub300\ucd9c\uae30\ud55c","noEntry":"\ub0b4\uc5ed \uc5c6\uc74c","notice":"\uacf5\uc9c0 \uc0ac\ud56d","newMember":"\uc2e0\uaddc \ud68c\uc6d0","autoLogin":"\uc790\ub3d9 \ub85c\uadf8\uc778","userMode":"\uc77c\ubc18 \ubaa8\ub4dc","adminMode":"\uad00\ub9ac\uc790 \ubaa8\ub4dc","normal":"\uc815\uc0c1","stopped":"\ub300\ucd9c\uc911\uc9c0","homeText":"<div class=\\"container\\"><h2>\ub3c4\uc11c\uad00 \uac1c\ubc29\uc2dc\uac04:</h2><ul><li>\ub9e4 \uc8fc\uc77c(\uc77c) 9:30am~12:00pm</li></ul><h2>\ub3c4\uc11c \ub300\ucd9c:</h2><ul><li>\ub9e4 \uc8fc\uc77c 10:30am~12:00pm </li><li>\ub300\ucd9c \uad8c\uc218: \ucd5c\ub300 5\uad8c</li><li>\ub300\ucd9c \uae30\uac04: 3\uc8fc (\ub3c4\uc11c \ub300\ucd9c\uc2dc\uac04\uc5d0 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc5f0\uc7a5\uc744 \uc694\uccad\ud558\uc2dc\uac70\ub098, <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\uc73c\ub85c \uc5f0\uc7a5 \uc2e0\uccad \uba54\uc77c\uc744 \ubcf4\ub0b4\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.)</li><li>\ub3c4\uc11c \ubc18\ub0a9: \ub3c4\uc11c\uad00 \uc55e \ubc18\ub0a9\ud568\uc5d0 \ub123\uc5b4 \uc8fc\uc2dc\uac70\ub098 \ub3c4\uc11c\uad00 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc9c1\uc811 \ubc18\ub0a9\ud558\uc5ec \uc8fc\uc2ed\uc2dc\uc624.</li><li>\ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad: \ub3c4\uc11c\uad00\uc5d0 \ube44\uce58\ub41c \ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad\uc11c\uc5d0 \uc791\uc131\ud558\uc5ec \uc81c\ucd9c\ud558\uc5ec \uc8fc\uc138\uc694.</li></ul></p><h2>\ubb38\uc758:</h2><ul><li>\ub3c4\uc11c\uad00 \uad00\ub828 \ubb38\uc758\ub294 \ub3c4\uc11c\uad00 \uc774\uba54\uc77c \uc8fc\uc18c <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\ub85c \ubb38\uc758 \ubc14\ub78d\ub2c8\ub2e4.</li></ul></div>","INVALID_BOOK":"\ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \ub3c4\uc11c\uc785\ub2c8\ub2e4","INVALID_USER":"\ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \ud68c\uc6d0\uc785\ub2c8\ub2e4","NOT_AVAILABLE":"\ub300\ucd9c \ubd88\uac00 \ub3c4\uc11c\uc785\ub2c8\ub2e4","OVERDUE":"\uc5f0\uccb4\uc911\uc785\ub2c8\ub2e4","RENTED":"\ub300\ucd9c\ub41c \ub3c4\uc11c\uc785\ub2c8\ub2e4","MAX_RENTAL":"\ub300\ucd9c \uad8c\uc218\ub97c \ucd08\uacfc\ud558\uc600\uc2b5\ub2c8\ub2e4","NOT_RENTED":"\ub300\ucd9c\ub418\uc9c0 \uc54a\uc740 \ub3c4\uc11c\uc785\ub2c8\ub2e4","rentSucceed":"\ub300\ucd9c \uc644\ub8cc","returnSucceed":"\ubc18\ub0a9 \uc644\ub8cc","rentSuffix":"\uad8c \ub300\ucd9c \uc911","confirmRent":"\ub300\ucd9c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","confirmReturn":"\ubc18\ub0a9\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","confirm":"\ud655\uc778","cancel":"\ucde8\uc18c","name":"\uc774\ub984","registeredDate":"\ub4f1\ub85d\uc77c","phone":"\uc804\ud654\ubc88\ud638","email":"\uc774\uba54\uc77c","address":"\uc8fc\uc18c","notice_":"\ube44\uace0","level":"\ub4f1\uae09","save":"\uc800\uc7a5","confirmSave":"\uc800\uc7a5\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","kid":"\uc544\ub3d9","adult":"\uc131\uc778","admin":"\uad00\ub9ac\uc790","regSuccess":"\ub4f1\ub85d \uc644\ub8cc","regFail":"\ub4f1\ub85d \uc2e4\ud328"}}')},218:function(e){e.exports=JSON.parse('{"privateKey":"-----BEGIN RSA PRIVATE KEY-----\\nMIICYAIBAAKBgQCrjaN6qZ81C0wl1uegCHbI/psEvpTNzBCS42ZwvVDq2y69kXfx\\nkDygmKqWi8rTFm6lx474GOAKpneEQ3ragP017HbW55hrXhQu2jK/UE5OPdIImPF5\\nY2v28y0WEdWd0h6/4S28lSE5nG0IigsfuIh0FIvH9vGVwBqCPm1DOEAUIQIDAQAB\\nAoGAE/ZVUY6vUfLQl46cQUj62YSW8URj+FaIjy8a2n+NDOcYV0K4HEnWZDGfmAkI\\nPuvbUDsabdAnMdYRDjjz1H7L4Y52vU+ZqD3+kJ3iUsR9Ba+R17zS6F4HVNPCzUDI\\nOpgE+z8od8+on2cppBPHMEl/Ze+CcKYLz7bLs8zje8QHZMkCRQDyuEx9WQSCf0LS\\nds+jwr7npwVlbb737oal6UKuVzKv039aLaxBpsAeMQsSdXgBq2E2ChmC8SmPuB0V\\n0mutfSBu2UapkwI9ALTwh/iFkje7O/1wjCVZn4TnLz6a4nx676rydpsRy2PrDyQ3\\naC5SWmzQezeSTs9Qmbhxm4ZTj3Co4aeL+wJEC+zqNS5ufkrqaZTU1uL2pkMajMU7\\noMrjartvP0mhf+oQU8nysLcUsWcPeDS1VL+q4xDT+A8JT7poE25nQ/rl4Qxj4GkC\\nPQCR+zoIlWOZ2VMWMBayD7P22zqvzPCMM/dnuYVdqSaqr7wgoR9JuCHChxXSiRVS\\niBntyKMM5h/laivdLL8CRGdrBwiAkVrYnghDj+9UJX9Twox3oahPqYhzxWJR7jZ4\\nipOKhw9r+YfZDNDYpVgE+g2KB75tZlOU9Hx7dXyzANnsIueT\\n-----END RSA PRIVATE KEY-----\\n"}')},236:function(e,t,n){},237:function(e,t,n){},238:function(e,t,n){},261:function(e,t,n){},269:function(e,t){},271:function(e,t){},282:function(e,t){},284:function(e,t){},311:function(e,t){},313:function(e,t){},314:function(e,t){},319:function(e,t){},321:function(e,t){},327:function(e,t){},329:function(e,t){},348:function(e,t){},360:function(e,t){},363:function(e,t){},385:function(e,t,n){},386:function(e,t,n){},388:function(e,t,n){"use strict";n.r(t);var c=n(3),o=n(6),r=n(0),a=n.n(r),s=n(104),i=n.n(s),l=(n(236),n(5)),u=(n(237),n(238),n(1));var d=function(e){return Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Home"),e.doc.setCallback(void 0);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(u.jsx)("div",{id:"home",dangerouslySetInnerHTML:{__html:e.text.homeText}})},b=(n(52),n(224)),j=n(403),O=10,h=500;String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var n=new RegExp("\\{"+t+"\\}","gi");e=e.replace(n,arguments[t])}return e};var f,p,g,x,m,v,k,S,E,y={position:"top-center",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0},I=function(e,t){return"0"===t||0===t?e.normal:"1"===t||1===t?e.overDue:"2"===t||2===t?e.stopped:void 0},N=function(e,t){return"0"===t?e.available:"1"===t?e.checkedOut:"3"===t?e.overDue:e.notAvailable},C=function(e,t){return e.rentDate>t.rentDate||!(e.rentDate<t.rentDate)&&e.title>t.title},R=function(e){return unescape(encodeURIComponent(e))},A="custom-loading-id",D="custom-logging-id",T=n(79),_=n.n(T),w=n(80),L=n.n(w),U=n(50),B=n(51),M=Object(B.a)(f||(f=Object(U.a)(["\n    query AllBook{\n        books (sortBy: TITLE_ASC, limit:20000) {\n            _id\n            author\n            title\n            claim_num\n            num\n            series\n            category\n            claim\n            publisher\n            seqnum\n        }\n    }\n"]))),P=Object(B.a)(p||(p=Object(U.a)(["\n    query AllRent{\n        rents (limit:20000) {\n            _id\n            book_id\n            user_id\n            rent_date\n            return_date\n            state\n        }\n    }\n"]))),H=Object(B.a)(g||(g=Object(U.a)(["\n    query AllUser {\n        users (limit: 20000) {\n            _id\n            name\n            state\n            level\n        }\n    }"]))),z=Object(B.a)(x||(x=Object(U.a)(["\n    query FindUser($_id: String!){\n        user (query: {_id:$_id}) {\n            _id\n            name\n            state\n            level\n            encrypted_email\n            encrypted_phone\n        }\n    }"]))),K=Object(B.a)(m||(m=Object(U.a)(["\n    query findLogs($user_id: String!){\n        rentLogs (limit: 20000, query: {user_id: $user_id}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            return_data\n            user_id\n        }\n    }"]))),F=Object(B.a)(v||(v=Object(U.a)(["\n    query findLogs ($fromTime: String!, $toTime: String!) {\n        rentLogs(limit: 20000, query: {AND: [{timestamp_gte: $fromTime}, {timestamp_lt: $toTime}]}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            return_data\n            user_id\n        }\n    }"]))),V=Object(B.a)(k||(k=Object(U.a)(["\n    query GetNotices {\n        notices (sortBy: _ID_DESC, limit:20000) {\n            _id\n            date\n            title\n        }\n    }"]))),Y=Object(B.a)(S||(S=Object(U.a)(["\n    query GetContent ($_id: String!) {\n        notice (query: {_id: $_id}) {\n            _id\n            date\n            title\n            content\n        }\n    }"]))),q=Object(B.a)(E||(E=Object(U.a)(["\n    query GetServerInfo {\n        serverInfo {\n            _id\n            globalIp\n            localIp\n            port\n        }\n    }"])));var G=function(e){var t=Object(r.useState)([]),n=Object(l.a)(t,2),a=n[0],s=n[1],i=Object(r.useState)([]),d=Object(l.a)(i,2),h=d[0],f=d[1],p=Object(r.useState)(0),g=Object(l.a)(p,2),x=g[0],m=g[1],v=Object(r.useState)(-1),k=Object(l.a)(v,2),S=k[0],E=k[1],y=Object(b.b)(V),I=y.loading,N=y.data,C=y.error,R=Object(j.a)(Y,{variables:{_id:S}}),A=Object(l.a)(R,2),D=A[0],T=A[1],w=T.loading,U=T.data,B=T.error;Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Notice"),e.doc.setCallback(void 0);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){console.log("Get Notice"),N&&s(N.notices)}),[N,C,I]),Object(r.useEffect)((function(){console.log("Get Content")}),[U,B,w]),Object(r.useEffect)((function(){var e=a.length;if(console.log("Page num "+x.toString()+" "),console.log(e),e>O){var t=x*O,n=Math.min(O,e-t);f(a.slice(t,t+n))}else f(a),m(0)}),[a,x]),Object(r.useEffect)((function(){}),[h]);var M=function(e){return Object(u.jsxs)("tr",{className:"",children:[Object(u.jsxs)("td",{className:"",children:[" ",e.date," "]}),Object(u.jsxs)("td",{className:"noticeEntry",colSpan:"2",onClick:function(){return t=e._id,console.log("selected "+t.toString()),E(S===t?-1:t),void D();var t},children:[" ",e.title]})]},e._id)};return Object(u.jsxs)("div",{id:"notice",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.notice})}),S>0&&U&&Object(u.jsx)("div",{id:"noticeContent",children:Object(u.jsx)("table",{className:"content",children:Object(u.jsxs)("tbody",{children:[M(U.notice),Object(u.jsx)("tr",{children:Object(u.jsx)("td",{className:"content",colSpan:"3",children:U.notice.content})})]})})}),Object(u.jsx)("div",{id:"noticeList",children:Object(u.jsx)("table",{children:Object(u.jsx)("tbody",{children:h.length>0&&h.map((function(e){return M(e)}))})})}),a.length>O&&Object(u.jsxs)("div",{id:"pageControl",children:[Object(u.jsx)("div",{className:"page",id:"page",children:Object(u.jsx)(_.a,{fontSize:"large",sx:{color:0===x?"#ffffff":"#404040"},onClick:function(){x>0&&m(x-1)}})}),Object(u.jsx)("div",{className:"pageNum",id:"pageNum",children:x+1}),Object(u.jsx)("div",{className:"page",id:"page",children:Object(u.jsx)(L.a,{fontSize:"large",sx:{color:a.length<=(x+1)*O?"#ffffff":"#404040"},onClick:function(){a.length>(x+1)*O&&m(x+1)}})})]})]})},Q=n(21),W=n(411),Z=n(9),J=n(22),$=n.n(J);var X=function(){console.log("Do nothing...")};var ee=function(e){var t=Object(r.useState)([]),n=Object(l.a)(t,2),c=n[0],o=n[1],a=Object(r.useState)(0),s=Object(l.a)(a,2),i=s[0],d=s[1],b=Object(r.useState)([]),j=Object(l.a)(b,2),h=j[0],f=j[1];return Object(r.useEffect)((function(){console.log("Init List View")}),[]),Object(r.useEffect)((function(){o(e.list),d(0)}),[e.list]),Object(r.useEffect)((function(){e.showCallback&&(X=e.showCallback)}),[e.showCallback]),Object(r.useEffect)((function(){var e=c.length;if(e>O){var t=i*O,n=Math.min(O,e-t);f(c.slice(t,t+n))}else f(c)}),[c,i]),Object(u.jsxs)("div",{id:"listView",children:[X(h,e.detail),c&&c.length>O&&Object(u.jsxs)("div",{id:"pageControl",children:[Object(u.jsx)("div",{className:"page",id:"page",children:Object(u.jsx)(_.a,{fontSize:"large",sx:{color:0===i?"#ffffff":"#404040"},onClick:function(){console.log("Prev"),i>0&&d(i-1)}})}),Object(u.jsx)("div",{className:"pageNum",id:"pageNum",children:i+1}),Object(u.jsx)("div",{className:"page",id:"page",children:Object(u.jsx)(L.a,{fontSize:"large",sx:{color:c.length<=(i+1)*O?"#ffffff":"#404040"},onClick:function(){console.log("Next"),c.length>(i+1)*O&&d(i+1)}})})]})]})},te=!1;var ne=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),a=n[0],s=n[1],i=Object(W.a)(a,50),d=Object(l.a)(i,1)[0],b=Object(r.useState)([]),j=Object(l.a)(b,2),O=j[0],f=j[1],p=Object(r.useState)(0),g=Object(l.a)(p,2),x=(g[0],g[1]),m=Object(r.useRef)("0"),v=Object(r.useState)([]),k=Object(l.a)(v,2),S=k[0],E=k[1],y=Object(r.useState)([]),I=Object(l.a)(y,2),C=I[0],A=I[1],D=Object(Z.p)().id;function T(){return _.apply(this,arguments)}function _(){return(_=Object(o.a)(Object(c.a)().mark((function t(){var n,o,r,a,s,i,l;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(console.log("All data loaded "+te),te=!0,n=[],o=e.doc.rent,r=0;r<o.length;r++)n.push({code:o[r].book_id,retDate:o[r].return_date,state:o[r].state});for(i in A(n),a=[],s=e.doc.book)l=s[i],a.push({code:l._id,name:l.title,num:l.num,author:l.author,claim:l.claim,claim_num:l.claim_num,totalName:l.series,category:l.publisher,publish:l.publisher});console.log("Load"),console.log(s.length),E(a);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.doc.isOpen()?T():e.doc.setCallback(T),console.log("BOOK ID: "+D);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){console.log("Updated id: "+D),s(D||"")}),[D]),Object(r.useEffect)((function(){function t(e){return n.apply(this,arguments)}function n(){return(n=Object(o.a)(Object(c.a)().mark((function t(n){var o,r,a,s,i,l,u,d,b,j,O,f,p,g,x,m,v,k,E,y;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=[],!e.doc.serverAvailable){t.next=18;break}return console.log(R(n)),console.log(btoa(R(n))),r="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",a={params:{book:btoa(R(n)),match:!1}},console.log(a),t.next=9,$.a.get(r,a);case 9:if(s=t.sent,console.log(s),"books"in s.data.return){t.next=13;break}return t.abrupt("return",o);case 13:for(i=s.data.return.books,l="",u=0;u<i.length;u++)d=i[u],b="".concat(d.BOOKNAME," ").concat(d.CLAIMNUM),1!==(j=d._STATE)&&3!==j||(l=e.text.returnDate+" "+d._RETURN),O={index:u,text:b,name:d.BOOKNAME,code:d.BARCODE,rent:N(e.text,d._STATE.toString()),retDate:l,author:d.AUTHOR,totalName:d.TOTAL_NAME,claim_num:d.CLAMENUM,publish:d.PUBLISH,claim:d.CLAIM},o.push(O);t.next=51;break;case 18:f=0;case 19:if(!(f<S.length)){t.next=51;break}if(p=S[f],!(o.length>=h)){t.next=23;break}return t.abrupt("break",51);case 23:if(!(p.name&&p.name.toString().includes(n)||p.code===n)){t.next=48;break}g="".concat(p.name," ").concat(p.claim_num),x="",m="0",v=Object(Q.a)(C),t.prev=28,v.s();case 30:if((k=v.n()).done){t.next=38;break}if((E=k.value).code!==p.code){t.next=36;break}return"1"!==(m=E.state)&&"3"!==m||(x=e.text.returnDate+" "+E.retDate),t.abrupt("break",38);case 36:t.next=30;break;case 38:t.next=43;break;case 40:t.prev=40,t.t0=t.catch(28),v.e(t.t0);case 43:return t.prev=43,v.f(),t.finish(43);case 46:y={index:f,text:g,name:p.name,code:p.code.toString(),rent:N(e.text,m),retDate:x,author:p.author,totalName:p.totalName,claim_num:p.claim_num,publish:p.publish,claim:p.claim},o.push(y);case 48:f++,t.next=19;break;case 51:return o.sort((function(e,t){return e.text>t.text})),t.abrupt("return",o);case 53:case"end":return t.stop()}}),t,null,[[28,40,43,46]])})))).apply(this,arguments)}function r(){return(r=Object(o.a)(Object(c.a)().mark((function e(){var n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=8;break}return e.next=3,t(d);case 3:(n=e.sent).length>0?f(n):f([]),1===n.length&&(m.current=n[0].code),e.next=9;break;case 8:f([]);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){r.apply(this,arguments)}()}),[d,S,C,e]);var w=function(){var e=Object(o.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Prev "+m.current),-1===m.current||m.current!==t?(console.log("Select "+t),x(t),m.current=t):(console.log("Deselect "+t),x(-1),m.current=-1);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(e){var t=e.code!==m.current,n=t?"searchResult":"selectedSearchResult";return Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{id:n,onClick:Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(e.code);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),children:Object(u.jsx)("table",{children:Object(u.jsx)("tbody",{children:Object(u.jsxs)("tr",{className:"searchTr",children:[Object(u.jsxs)("td",{className:"searchTitle",children:[" ",e.text]}),Object(u.jsxs)("td",{className:"searchRent",children:[" ",e.rent," "]})]})})})}),!t&&Object(u.jsx)("div",{children:Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[e.author," "]}),Object(u.jsxs)("td",{colSpan:"2",rowSpan:"2",children:[e.totalName," ",Object(u.jsx)("b",{children:e.name})," ",e.claim_num," "]})]}),Object(u.jsx)("tr",{children:Object(u.jsxs)("td",{children:[e.code," "]})}),Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:e.publish}),Object(u.jsxs)("td",{colSpan:e.retDate.length>0?"1":"2",children:[e.claim," "]}),e.retDate.length>0&&Object(u.jsx)("td",{children:e.retDate})]})]})})})]},e.code)};return Object(u.jsxs)("div",{id:"search",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsxs)("h2",{children:[" ",e.text.bookSearch," "]})}),Object(u.jsx)("div",{id:"searchContents",children:Object(u.jsx)("input",{id:"searchInput",placeholder:e.text.searchBook,value:a,onChange:function(e){s(e.target.value)}})}),Object(u.jsx)(ee,{list:O,showCallback:function(e){return e.map((function(e){return L(e)}))}})]})},ce=n(13),oe=n(25),re={LoggedOut:0,LoggingIn:1,LoggedIn:2};var ae=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),s=n[0],i=n[1],d=Object(r.useState)(""),b=Object(l.a)(d,2),O=b[0],h=b[1],f=Object(r.useState)([]),p=Object(l.a)(f,2),g=p[0],x=p[1],m=Object(r.useState)(!1),v=Object(l.a)(m,2),k=v[0],S=v[1],E=Object(r.useState)(""),I=Object(l.a)(E,2),N=I[0],R=I[1],A=Object(r.useState)(re.LoggedOut),T=Object(l.a)(A,2),_=T[0],w=T[1],L=Object(r.useState)([]),U=Object(l.a)(L,2),B=U[0],M=U[1],P=Object(r.useState)(!1),H=Object(l.a)(P,2),F=H[0],V=H[1],Y=Object(j.a)(z,{variables:{_id:N}}),q=Object(l.a)(Y,2),G=q[0],Q=q[1].data,W=Object(j.a)(K,{variables:{user_id:N}}),J=Object(l.a)(W,2),$=J[0],X=J[1].data,te=Object(r.useState)(""),ne=Object(l.a)(te,2),ae=ne[0],se=ne[1],ie=Object(r.useState)(""),le=Object(l.a)(ie,2),ue=le[0],de=le[1];function be(){return je.apply(this,arguments)}function je(){return(je=Object(o.a)(Object(c.a)().mark((function t(){var n;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("All data loaded "+k),!e.doc.logged){t.next=14;break}return w(re.LoggedIn),n=e.doc.userInfo._id,R(n),t.t0=x,t.next=8,e.doc.getRent(n);case 8:return t.t1=t.sent,(0,t.t0)(t.t1),t.next=12,$();case 12:t.next=17;break;case 14:w(re.LoggedOut),R(""),h("");case 17:console.log("Set title "+e.doc.logged),e.doc.logged?e.doc.adminMode?de(e.text.userSearch):de(e.text.checkOut):de(e.text.logIn),console.log("Done"),S(!0);case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){var n,o;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.doc.initialized){t.next=2;break}return t.abrupt("return");case 2:e.doc.isOpen()&&be(),console.log("======================================="),console.log("CheckOutStatus initialize"),"autoLogin"in e.context.cookie&&(n="true"===e.context.cookie.autoLogin,V(n)),o=new Date,2,o.setTime(o.getTime()+1728e5),se(o.toGMTString());case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){console.log("User data updated "),be()}),[e.doc.logged]),Object(r.useEffect)((function(){function e(){return(e=Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("User data updated "),e.next=3,fe();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[Q]),Object(r.useEffect)((function(){if(X&&e.doc.bookReady&&e.doc.rentReady){console.log("History updated "),console.log(X);for(var t=[],n=0;n<X.rentLogs.length;n++){var c=X.rentLogs[n];if("1"===c.book_state&&(!(!1 in c)&&c.return_data)){var o=c.book_id,r=e.doc.book[o].title,a=c.timestamp.split(" ")[0].replace("-","/",2).replace("-","/"),s=c.return_data;t.push({id:o,title:r,rentDate:a,retDate:s})}}t.sort(C),console.log("Set history"),M(t)}}),[X,e.doc.bookReady,e.doc.rentReady]);var Oe=function(t){return Object(u.jsx)("div",{children:Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{id:"id",children:e.text.id}),Object(u.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(u.jsx)("th",{id:"returnDate",children:e.text.returnDate})]},"ID"),t.map((function(e,t){return function(e,t){var n=e.id,c=e.rentDate,o=e.retDate,r=e.title,s=t.toString();return Object(u.jsxs)(a.a.Fragment,{children:[Object(u.jsxs)("tr",{className:"bookData",children:[Object(u.jsx)("td",{className:"bookData",children:Object(u.jsx)(oe.b,{to:"/search/"+n,children:n})}),Object(u.jsx)("td",{className:"bookData",children:c}),Object(u.jsx)("td",{className:"bookData",children:o})]},s),Object(u.jsx)("tr",{className:"bookName",children:Object(u.jsx)("td",{colSpan:"3",className:"bookName",children:r})},s+"Title")]},s+"Fragment")}(e,t)})),0===t.length&&Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})})},he=function(){var e=Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(re.LoggingIn),R(s.toUpperCase()),e.next=4,G();case 4:return e.next=6,$();case 6:return console.log("Log In"),e.next=9,fe();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(){var t=Object(o.a)(Object(c.a)().mark((function t(){var n,o;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Q&&_!==re.LoggedOut){t.next=2;break}return t.abrupt("return");case 2:if(console.log(ce.c.isActive(D)),n=y,!e.context.checkLogIn(Q,O)){t.next=17;break}return e.doc.logIn(Q.user),t.t0=x,t.next=9,e.doc.getRent(N);case 9:t.t1=t.sent,(0,t.t0)(t.t1),w(re.LoggedIn),n.type=ce.c.TYPE.SUCCESS,o=e.text.logInSucceed,document.cookie="user_id="+N+"; expires="+ae+";",t.next=19;break;case 17:n.type=ce.c.TYPE.ERROR,o=e.text.logInFail;case 19:n.render=o,n.autoClose=3e3,n.toastId=D,ce.c.isActive(D)?(console.log("update toast"),ce.c.update(D,n)):(console.log("New toast"),ce.c.info(o,n));case 23:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return e.doc.initialized?Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:ue})}),Object(u.jsxs)("div",{id:"checkOutInput",hidden:!(_!==re.LoggedIn),children:[Object(u.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:s,disabled:!k,onInput:function(e){i(e.target.value)}}),Object(u.jsx)("input",{type:"password",id:"searchPassword",placeholder:e.text.pwHolder,value:O,disabled:!k,onInput:function(e){h(e.target.value)}}),Object(u.jsxs)("div",{id:"autoLogin",children:[Object(u.jsx)("input",{type:"checkbox",id:"autoLoginButton",checked:F,onChange:function(){return function(){console.log("Toggle autoLogin");var e="autoLogin="+(F?"false":"true")+"; expires="+ae+";";console.log(e),document.cookie=e,V(!F)}()}}),Object(u.jsx)("label",{children:e.text.autoLogin})]}),Object(u.jsxs)("button",{id:"logIn",onClick:Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",he());case 1:case"end":return e.stop()}}),e)}))),children:[" ",e.text.logIn," "]})]}),Object(u.jsxs)("div",{id:"checkOutResult",hidden:!(_===re.LoggedIn),children:[Object(u.jsx)("div",{children:Oe(g)}),Object(u.jsx)("div",{id:"name",children:e.text.history}),Object(u.jsx)(ee,{list:B,showCallback:function(e){return Oe(e)}})]})]}):Object(u.jsx)(Z.a,{to:"/"})},se=n(112),ie=n.n(se),le={LoggedOut:0,LoggingIn:1,LoggedIn:2,LoggingOut:3};var ue=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),a=n[0],s=n[1],i=Object(r.useState)(""),d=Object(l.a)(i,2),b=d[0],j=d[1],O=Object(W.a)(b,50),h=Object(l.a)(O,1)[0],f=Object(r.useState)(""),p=Object(l.a)(f,2),g=p[0],x=p[1],m=Object(r.useState)(le.LoggedOut),v=Object(l.a)(m,2),k=v[0],S=v[1],E=Object(r.useState)({}),N=Object(l.a)(E,2),C=N[0],R=N[1],T=Object(r.useState)({}),_=Object(l.a)(T,2),w=_[0],L=_[1],U=Object(r.useState)(!1),B=Object(l.a)(U,2),M=B[0],P=B[1],H=Object(r.useState)({}),z=Object(l.a)(H,2),K=z[0],F=z[1],V=Object(r.useState)(""),Y=Object(l.a)(V,2),q=Y[0],G=Y[1];Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("======================================="),console.log("CheckOut initialize");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var n=setInterval(Object(o.a)(Object(c.a)().mark((function t(){var n,o,r;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("localIp"in e.doc.serverInfo&&"port"in e.doc.serverInfo){t.next=2;break}return t.abrupt("return");case 2:n=e.doc.serverInfo.localIp,o=e.doc.serverInfo.port,n.length>0&&o>0&&(r="https://"+n+":"+o+"/scanBarcode",$.a.get(r).then((function(e){var t=e.data.scan;t&&(console.log(t),G(t))})));case 5:case"end":return t.stop()}}),t)}))),1e3);return function(){t.apply(this,arguments)}(),function(){return clearInterval(n)}}),[]),Object(r.useEffect)((function(){console.log("User data updated "),console.log(ce.c.isActive(D));var t,n=y,c=!1;"USER_CODE"in C&&k!==le.LoggedIn?(S(le.LoggedIn),n.type=ce.c.TYPE.SUCCESS,t=e.text.logInSucceed,c=!0):"USER_CODE"in C||(S(le.LoggedOut),k===le.LoggingIn&&(n.type=ce.c.TYPE.ERROR,t=e.text.logInFail,c=!0)),c&&F({id:A,text:t,type:n.type})}),[C]),Object(r.useEffect)((function(){console.log("book updated "),"BARCODE"in w?0===w._STATE?P(!0):(F({id:A,text:e.text.RENTED,type:ce.c.TYPE.ERROR}),document.getElementById("barcodeScan").value=null,P(!1)):(P(!1),G(""))}),[w]),Object(r.useEffect)((function(){if("text"in K){ce.c.dismiss(),console.log("Notification "+K.text);var e=y;e.type=K.type,e.autoClose=3e3,ce.c.info(K.text,e)}}),[K]),Object(r.useEffect)((function(){k!==le.LoggedIn&&G(a)}),[k,a]);var Q=function(){var t=Object(o.a)(Object(c.a)().mark((function t(n){var o,r,a,s;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/user?user="+n,r={params:{user:n,data:"nothing"}},console.log(r),t.next=5,$.a.get(o,btoa(JSON.stringify(r)));case 5:a=t.sent,s=a.data.return,R(s),console.log(s);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Z=function(){var e=Object(o.a)(Object(c.a)().mark((function e(){var t;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("LOGIN"),console.log(a),0!==a.length){e.next=4;break}return e.abrupt("return");case 4:S(le.LoggingIn),t=a.toUpperCase(),x(t),Q(t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Log Out"),R({}),s(""),L({}),G(""),document.getElementById("barcodeScan").value=null;case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function X(t){if(console.log("Image Captured"),t.target.files&&t.target.files.length>0){var n=t.target.files[0];console.log(n),console.log(n.type);var c="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/uploadImage";console.log(c),F({id:A,text:e.text.loading,type:ce.c.TYPE.INFO}),function(e){return new Promise((function(t,n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){return t(c.result)},c.onerror=function(e){return n(e)}}))}(n).then((function(t){$()({method:"post",mode:"no-cors",crossDomain:"true",url:c,headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","Access-Control-Allow-Methods":"GET, PUT, POST, DELETE, OPTIONS"},withCredentials:!1,credentials:"same-origin",data:{image:t}}).then((function(t){var n=t.data.return;console.log(t),console.log(n),"BOOKNAME"in n?(L(n),F({id:A,text:e.text.succeededToOpen,type:ce.c.TYPE.SUCCESS})):(console.log("Failed"),F({id:A,text:e.text.INVALID_BOOK,type:ce.c.TYPE.ERROR}),L({}),G(""))}))}))}}return Object(r.useEffect)((function(){if(b.length>0){var t="HK"+b;console.log("Search book1 "+t);var n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",c={params:{book:t,match:!0}};console.log(c),$.a.get(n,c).then((function(e){var t=e.data.return;console.log(t),"books"in t&&"BOOKNAME"in t.books&&(console.log(t.books),L(t.books))}))}}),[h,b,e.doc]),Object(r.useEffect)((function(){if(console.log("Barcode: "+q),0!==q.length)if(k!==le.LoggedIn)s(q);else{var t=q;console.log("Search book2 "+t);var n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",c={params:{book:t,match:!0}};console.log(c),$.a.get(n,c).then((function(e){var t=e.data.return;console.log(t),"books"in t&&"BOOKNAME"in t.books&&L(t.books)}))}}),[q,e.doc,k]),Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.checkOut})}),Object(u.jsxs)("div",{id:"checkOutInput",hidden:k===le.LoggedIn,children:[Object(u.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:a,onInput:function(e){s(e.target.value)}}),Object(u.jsxs)("button",{id:"logIn",onClick:Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Z());case 1:case"end":return e.stop()}}),e)}))),children:[" ",e.text.logIn," "]})]}),Object(u.jsxs)("div",{id:"checkOutResult",hidden:k!==le.LoggedIn,children:[C.USER_CODE&&Object(u.jsxs)("div",{id:"userInfo",children:[Object(u.jsx)("div",{id:"userItem",children:C.USER_CODE+" : "+C.USER_NAME+e.text.nameSuffix}),Object(u.jsxs)("div",{id:"userItem",children:[" ",I(e.text,C.USER_STATE)," "]}),Object(u.jsxs)("div",{id:"userItem",children:[" ",C._RENT.length+" "+e.text.rentSuffix," "]})]}),Object(u.jsxs)("div",{id:"bookInput",hidden:M,children:[Object(u.jsxs)("label",{id:"barcodeScan",hidden:!0,children:[Object(u.jsx)(ie.a,{fontSize:"large",sx:{color:"#404040"}}),Object(u.jsx)("span",{children:Object(u.jsx)("input",{type:"file",id:"barcodeScanInput",accept:"image/*",capture:"environment",onChange:function(e){return X(e)}})})]}),Object(u.jsxs)("label",{id:"manualInput",children:[Object(u.jsx)("div",{id:"hkPrefix",children:"HK"}),Object(u.jsx)("input",{inputMode:"numeric",pattern:"[0-9]*",type:"text",id:"searchInput",placeholder:e.text.bookHolder,onInput:function(e){j(e.target.value)}})]})]}),Object(u.jsxs)("div",{id:"checkRent",hidden:!M,children:[Object(u.jsxs)("div",{id:"bookName",children:[" ",e.text.confirmRent," "]}),Object(u.jsxs)("div",{id:"bookName",children:[" ",w.AUTHOR+": "+w.BOOKNAME," "]}),Object(u.jsxs)("button",{id:"confirm",onClick:function(){return function(){console.log("Confirmed"),P(!1),console.log(w),document.getElementById("barcodeScan").value=null;var t="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/checkOut";$()({method:"post",mode:"no-cors",crossDomain:"true",url:t,headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","Access-Control-Allow-Methods":"GET, PUT, POST, DELETE, OPTIONS"},withCredentials:!1,credentials:"same-origin",data:{book:w.BARCODE,user:g}}).then((function(t){var n,c=t.data.return;console.log("Rent confirmed"),console.log(c),"SUCCESS"===c?F({id:A,text:e.text.rentSucceed,type:ce.c.TYPE.SUCCESS}):(n=c in e.text?e.text[c]:e.text.NOT_AVAILABLE,console.log(n),F({id:A,text:n,type:ce.c.TYPE.ERROR})),L({}),G(""),Q(g)}))}()},children:[" ",e.text.confirm," "]}),Object(u.jsxs)("button",{id:"cancel",onClick:function(){return console.log("Cancelled"),P(!1),document.getElementById("barcodeScan").value=null,L({}),void G("")},children:[" ",e.text.cancel," "]})]}),Object(u.jsxs)("button",{id:"logOutButton",onClick:function(){return J()},children:[" ",e.text.logOut," "]})]})]})};var de=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),a=n[0],s=n[1],i=Object(W.a)(a,50),d=Object(l.a)(i,1)[0],b=Object(r.useState)({}),j=Object(l.a)(b,2),O=j[0],h=j[1],f=Object(r.useState)(!1),p=Object(l.a)(f,2),g=p[0],x=p[1],m=Object(r.useState)({}),v=Object(l.a)(m,2),k=v[0],S=v[1],E=Object(r.useState)(""),I=Object(l.a)(E,2),N=I[0],C=I[1];function R(t){if(console.log("Image Captured"),t.target.files&&t.target.files.length>0){var n=t.target.files[0];console.log(n),console.log(n.type);var c="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/uploadImage";S({id:A,text:e.text.loading,type:ce.c.TYPE.INFO}),function(e){return new Promise((function(t,n){var c=new FileReader;c.readAsDataURL(e),c.onload=function(){return t(c.result)},c.onerror=function(e){return n(e)}}))}(n).then((function(t){$()({method:"post",mode:"no-cors",crossDomain:"true",url:c,headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","Access-Control-Allow-Methods":"GET, PUT, POST, DELETE, OPTIONS"},withCredentials:!1,credentials:"same-origin",data:{image:t}}).then((function(t){var n=t.data.return;console.log(n),"BOOKNAME"in n?(h(n),S({id:A,text:e.text.succeededToOpen,type:ce.c.TYPE.SUCCESS})):(S({id:A,text:e.text.INVALID_BOOK,type:ce.c.TYPE.ERROR}),h({}),C(""))}))}))}}return Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.doc.setCallback(void 0),console.log("======================================="),console.log("Return initialize");case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var n=setInterval(Object(o.a)(Object(c.a)().mark((function t(){var n,o,r;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("localIp"in e.doc.serverInfo&&"port"in e.doc.serverInfo){t.next=2;break}return t.abrupt("return");case 2:n=e.doc.serverInfo.localIp,o=e.doc.serverInfo.port,n&&n.length>0&&o>0&&(r="https://"+n+":"+o+"/scanBarcode",$.a.get(r).then((function(e){var t=e.data.scan;t&&(console.log(N+" -> "+t),C(t))})));case 5:case"end":return t.stop()}}),t)}))),1e3);return function(){t.apply(this,arguments)}(),function(){return clearInterval(n)}}),[]),Object(r.useEffect)((function(){if(a.length>0){var t="HK"+a;console.log("Search book1 "+t);var n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",c={params:{book:t,match:!0}};console.log(c),$.a.get(n,c).then((function(e){var t=e.data.return;console.log(t),"books"in t&&"BOOKNAME"in t.books&&h(t.books)}))}}),[d,a,e.doc]),Object(r.useEffect)((function(){if(console.log("B"+N),N.length>0){var t=N;console.log("Search book2 "+t);var n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",c={params:{book:t,match:!0}};console.log(c),$.a.get(n,c).then((function(e){var t=e.data.return;console.log(t),"books"in t&&"BOOKNAME"in t.books&&h(t.books)}))}}),[N,e.doc]),Object(r.useEffect)((function(){console.log("book updated "),"BARCODE"in O?1===O._STATE||3===O._STATE?x(!0):(console.log("Not rented"),S({id:A,text:e.text.NOT_RENTED,type:ce.c.TYPE.ERROR}),document.getElementById("barcodeScan").value=null,x(!1),C("")):x(!1)}),[O]),Object(r.useEffect)((function(){if("text"in k){ce.c.dismiss();var e=y;e.type=k.type,e.autoClose=3e3,ce.c.info(k.text,e)}}),[k]),Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.return})}),Object(u.jsxs)("div",{id:"checkOutResult",children:[Object(u.jsxs)("div",{id:"bookInput",hidden:g,children:[Object(u.jsxs)("label",{id:"barcodeScan",hidden:!0,children:[Object(u.jsx)(ie.a,{fontSize:"large",sx:{color:"#404040"}}),Object(u.jsx)("span",{children:Object(u.jsx)("input",{type:"file",id:"barcodeScanInput",accept:"image/*",capture:"environment",onChange:function(e){return R(e)}})})]}),Object(u.jsxs)("label",{id:"manualInput",children:[Object(u.jsx)("div",{id:"hkPrefix",children:"HK"}),Object(u.jsx)("input",{inputMode:"numeric",pattern:"\\d*",type:"text",id:"searchInput",placeholder:e.text.bookHolder,onInput:function(e){s(e.target.value)}})]})]}),Object(u.jsxs)("div",{id:"checkReturn",hidden:!g,children:[Object(u.jsxs)("div",{id:"bookName",children:[" ",e.text.confirmReturn," "]}),Object(u.jsxs)("div",{id:"bookName",children:[" ",O.AUTHOR+":"+O.BOOKNAME," "]}),Object(u.jsxs)("button",{id:"confirm",onClick:function(){return function(){console.log("Confirmed"),x(!1),console.log(O);var t="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/return";$()({method:"post",mode:"no-cors",crossDomain:"true",url:t,headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","Access-Control-Allow-Methods":"GET, PUT, POST, DELETE, OPTIONS"},withCredentials:!1,credentials:"same-origin",data:{book:O.BARCODE}}).then((function(t){var n,c=t.data.return;console.log(c),"SUCCESS"===c?S({id:A,text:e.text.returnSucceed,type:ce.c.TYPE.SUCCESS}):(n=c in e.text?e.text[c]:e.text.NOT_AVAILABLE,console.log(n),S({id:A,text:n,type:ce.c.TYPE.ERROR})),h({}),C("")}))}()},children:[" ",e.text.confirm," "]}),Object(u.jsxs)("button",{id:"cancel",onClick:function(){return console.log("Cancelled"),x(!1),h({}),void C("")},children:[" ",e.text.cancel," "]})]})]})]})};n(261);var be=function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),a=n[0],s=n[1],i=Object(r.useState)(!0),d=Object(l.a)(i,2),b=d[0],j=d[1],O=Object(r.useState)({}),h=Object(l.a)(O,2),f=h[0],p=h[1];function g(e,t){console.log(e),console.log(t);var n=f;switch(e){case 0:n.USER_NAME=t;break;case 1:n.PHONE_NUMBER=t;break;case 2:n.EMAIL=t;break;case 3:n.ADDRESS=t;break;case 4:n.USER_LEVEL=t;break;case 5:n.NOTICE=t}var c=Object.keys(n).length;console.log(c),c>1&&j(!1),p(n)}return Object(r.useEffect)((function(){console.log("User Info"),console.log(e.info),document.getElementById("userName").value=e.info.USER_NAME,document.getElementById("phone").value=e.info.PHONE_NUMBER,document.getElementById("email").value=e.info.EMAIL,document.getElementById("address").value=e.info.ADDRESS,document.getElementById("notice_").value=e.info.NOTICE,document.getElementById("user_level").value=e.info.USER_LEVEL,p({USER_CODE:e.info.USER_CODE}),j(!0)}),[e.info]),Object(u.jsxs)("div",{children:[Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.name," "]}),Object(u.jsx)("td",{colSpan:"3",children:Object(u.jsx)("input",{type:"text",className:"input",id:"userName",onChange:function(e){g(0,e.target.value)}})})]},"Name"),"REG_DATE"in e.info&&Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.registeredDate," "]}),Object(u.jsx)("td",{colSpan:"3",className:"data",children:e.info.REG_DATE})]},"Register"),Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.phone," "]}),Object(u.jsx)("td",{colSpan:"3",children:Object(u.jsx)("input",{type:"text",className:"input",id:"phone",onChange:function(e){g(1,e.target.value)}})})]},"Phone"),Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.email," "]}),Object(u.jsx)("td",{colSpan:"3",children:Object(u.jsx)("input",{type:"text",className:"input",id:"email",onChange:function(e){g(2,e.target.value)}})})]},"Email"),Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.address," "]}),Object(u.jsx)("td",{colSpan:"3",children:Object(u.jsx)("input",{type:"text",className:"input",id:"address",onChange:function(e){g(3,e.target.value)}})})]},"Address"),Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.notice_," "]}),Object(u.jsx)("td",{colSpan:"3",children:Object(u.jsx)("input",{type:"text",className:"input",id:"notice_",onChange:function(e){g(5,e.target.value)}})})]},"Notice"),Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.level," "]}),Object(u.jsx)("td",{colSpan:"3",className:"cell",children:Object(u.jsxs)("select",{name:"User Level",id:"user_level",className:"dropdown",onChange:function(e){g(4,e.target.value)},children:[Object(u.jsxs)("option",{value:"0",children:[" ",e.text.kid," "]}),Object(u.jsxs)("option",{value:"1",children:[" ",e.text.adult," "]}),Object(u.jsxs)("option",{value:"2",children:[" ",e.text.admin," "]})]})})]},"Level")]})}),Object(u.jsxs)("button",{id:"modify",hidden:a,onClick:Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s(!0));case 1:case"end":return e.stop()}}),e)}))),disabled:b,children:[" ",e.text.save," "]}),Object(u.jsxs)("div",{id:"checkModify",hidden:!a,children:[Object(u.jsxs)("div",{id:"noticeMsg",children:[" ",e.text.confirmSave," "]}),Object(u.jsxs)("button",{id:"confirm",onClick:function(){return function(){console.log("Save modification"),console.log(f);var t=e.doc.serverInfo.localIp,n=e.doc.serverInfo.port;if(!(0===t.length||n<=0)){var c="https://"+t+":"+n+"/user",o={};for(var r in f)o[r]=btoa(R(f[r]));$.a.post(c,o).then((function(t){console.log(t),e.refresh(t)})),s(!1)}}()},children:[" ",e.text.confirm," "]}),Object(u.jsxs)("button",{id:"cancel",onClick:function(){s(!1)},children:[" ",e.text.cancel," "]})]})]})};var je=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),s=n[0],i=n[1],d=Object(W.a)(s,50),b=Object(l.a)(d,1)[0],O=Object(r.useState)(!1),f=Object(l.a)(O,2),p=f[0],g=f[1],x=Object(r.useState)([]),m=Object(l.a)(x,2),v=m[0],k=m[1],S=Object(r.useState)(!1),E=Object(l.a)(S,2),N=E[0],C=E[1],A=Object(j.a)(H),D=Object(l.a)(A,2),T=D[0],_=D[1],w=_.loading,L=_.data,U=_.error,B=Object(r.useState)({}),M=Object(l.a)(B,2),P=M[0],z=M[1],K=Object(r.useState)(0),F=Object(l.a)(K,2),V=(F[0],F[1]),Y=Object(r.useRef)("0"),q=Object(Z.p)().id,G=Object(r.useState)([]),J=Object(l.a)(G,2),X=J[0],te=J[1];function ne(){return re.apply(this,arguments)}function re(){return re=Object(o.a)(Object(c.a)().mark((function t(){var n,o,r=arguments;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!(r.length>0&&void 0!==r[0])||r[0],console.log("All data loaded "+N),n&&((o=y).type=ce.c.TYPE.SUCCESS,o.render=e.text.succeededToOpen,o.autoClose=3e3,o.toastId="",ce.c.info(e.text.succeededToOpen,o)),console.log("Set title "+e.logged),console.log("Done"),C(!0);case 6:case"end":return t.stop()}}),t)}))),re.apply(this,arguments)}function ae(e){console.log("Refresh page "+p),console.log(e),g(!p)}Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.doc.initialized){t.next=2;break}return t.abrupt("return");case 2:e.doc.isOpen()?ne(!1):e.doc.setCallback(ne),console.log("======================================="),console.log("UserSearch initialize"),console.log("User ID: "+q),e.doc.serverAvailable||(console.log("Load users"),T());case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){console.log("Updated id: "+q),i(q||"")}),[q]),Object(r.useEffect)((function(){console.log("User data updated "),ne(!1)}),[e.logged]),Object(r.useEffect)((function(){if(console.log("User list loaded"),console.log(U),console.log(w),L){var t=[];console.log("User list available");for(var n=0;n<L.users.length;n++){var c=L.users[n],o={id:c._id,name:c.name,level:c.level,state:I(e.text,c.state)};t.push(o)}console.log(t),e.doc.setUser(t),console.log(e.doc.getUser()),z(e.doc.getUser())}}),[L,w,U,e]);var se=function(){var t=Object(o.a)(Object(c.a)().mark((function t(n){var o;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!==Y.current&&Y.current===n){t.next=12;break}return console.log("Select "+n),V(n),Y.current=n,t.next=6,e.doc.getRent(n);case 6:o=t.sent,console.log("Set Rent List"),console.log(o),te(o),t.next=16;break;case 12:console.log("Deselect "+n),V(-1),Y.current=-1,te([]);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ie=function(t,n){return Object(u.jsxs)("div",{children:[t.map((function(e,t){return function(e,t,n){var r=n.toString();return Object(u.jsxs)("div",{children:[Object(u.jsx)("table",{children:Object(u.jsx)("tbody",{children:Object(u.jsxs)("tr",{className:"searchTr",onClick:Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,se(e.id);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),children:[Object(u.jsx)("td",{className:"bookData",children:e.id}),Object(u.jsx)("td",{className:"bookData",children:e.name}),Object(u.jsx)("td",{className:"bookData",children:e.state}),Object(u.jsx)("td",{className:"bookData",children:e.rent})]},e.id)})}),e.id===Y.current&&le(e,t)]},r)}(e,n,t)})),0===t.length&&Object(u.jsx)("table",{children:Object(u.jsx)("tbody",{children:Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")})})]})},le=function(t,n){t.id;return console.log("Detail"),console.log(t),Object(u.jsxs)(u.Fragment,{children:[e.doc.serverAvailable&&Object(u.jsx)(be,{text:e.text,doc:e.doc,info:t,refresh:ae}),Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{id:"id",children:e.text.id}),Object(u.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(u.jsx)("th",{id:"returnDate",children:e.text.returnDate})]},"ID"),n.map((function(e,t){return function(e,t){var n=e.id,c=e.rentDate,o=e.retDate,r=e.title,s=t.toString();return Object(u.jsxs)(a.a.Fragment,{children:[Object(u.jsxs)("tr",{className:"bookData",children:[Object(u.jsx)("td",{className:"bookData",children:Object(u.jsx)(oe.b,{to:"/search/"+n,children:n})}),Object(u.jsx)("td",{className:"bookData",children:c}),Object(u.jsx)("td",{className:"bookData",children:o})]},s),Object(u.jsx)("tr",{className:"bookName",children:Object(u.jsx)("td",{colSpan:"3",className:"bookName",children:r})},s+"Title")]},s+"Fragment")}(e,t)})),0===n.length&&Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})]})};return Object(r.useEffect)((function(){function t(e){return n.apply(this,arguments)}function n(){return(n=Object(o.a)(Object(c.a)().mark((function e(t){var n,o,r;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],e.t0=Object(c.a)().keys(P);case 2:if((e.t1=e.t0()).done){e.next=10;break}if(o=e.t1.value,r=P[o],!(n.length>=h)){e.next=7;break}return e.abrupt("break",10);case 7:(r.name&&r.name.toString().includes(t)||r.id.toLowerCase()===t.toLowerCase())&&n.push(r),e.next=2;break;case 10:return n.sort((function(e,t){return e.name>t.name})),console.log(n),e.abrupt("return",n);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function r(){return(r=Object(o.a)(Object(c.a)().mark((function n(){var o,r,a,i,l,u,d,j,O,h;return Object(c.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=s.trim(),console.log("Query "+o+" "+b),!(o.length>0&&b)){n.next=25;break}if(!e.doc.serverAvailable){n.next=17;break}return console.log("from CLIB"),a="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/users",i={params:{user:btoa(R(o))}},console.log(i),n.next=10,$.a.get(a,i);case 10:if(l=n.sent,u=l.data.return.data,console.log(l.data.return),r=[],u){d=Object(Q.a)(l.data.return.data);try{for(d.s();!(j=d.n()).done;)O=j.value,console.log(O),(h=O).id=O.USER_CODE,h.name=O.USER_NAME,h.state=I(e.text,O.USER_STATE),h.rent=O._RENT.length,r.push(h)}catch(c){d.e(c)}finally{d.f()}}n.next=21;break;case 17:return console.log("from DB"),n.next=20,t(b);case 20:r=n.sent;case 21:r.length>0?k(r):k([]),1===r.length?se(r[0].id):se(0),n.next=26;break;case 25:k([]);case 26:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){r.apply(this,arguments)}()}),[b,e,P,p]),e.doc.initialized?Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.userSearch})}),Object(u.jsxs)("div",{id:"checkOutInput",hidden:!e.doc.admin,children:[Object(u.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:s,onChange:function(e){i(e.target.value)}}),Object(u.jsx)("div",{children:Object(u.jsx)(ee,{list:v,detail:X,showCallback:function(e,t){return ie(e,t)}})})]})]}):Object(u.jsx)(Z.a,{to:"/"})};var Oe=function(e){var t=Object(r.useState)([]),n=Object(l.a)(t,2),s=n[0],i=n[1],d=Object(r.useState)(!1),b=Object(l.a)(d,2),O=b[0],h=b[1],f=Object(j.a)(H),p=Object(l.a)(f,2),g=p[0],x=p[1],m=x.loading,v=x.data,k=x.error,S=Object(r.useState)({}),E=Object(l.a)(S,2),y=E[0],C=E[1];function R(e,t){return e.rentDate>t.rentDate}function A(){return D.apply(this,arguments)}function D(){return(D=Object(o.a)(Object(c.a)().mark((function t(){var n,o,r,a,s,l,u,d,b,j,f,p,g,x,m;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("All data loaded "+O),!e.doc.serverAvailable){t.next=15;break}return n=[],o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",r={params:{user:"*",match:!1}},t.next=7,$.a.get(o,r);case 7:for(a=t.sent,s=a.data.return.books,l="",u=0;u<s.length;u++)d=s[u],b="".concat(d.BOOKNAME," ").concat(d.CLAIMNUM),1!==(j=d._STATE)&&3!==j||(l=d.RETURN_DATE),f={index:u,text:b,title:d.BOOKNAME,id:d.BARCODE,rent:N(e.text,d.STATS.toString()),rentDate:d.LENT_DATE,retDate:l,author:d.AUTHOR,totalName:d.TOTAL_NAME,claim_num:d.CLAMENUM,publish:d.PUBLISH,claim:d.CLAIM,user:d.USER,userName:d.USER_NAME},n.push(f);n.sort(R),i(n),t.next=23;break;case 15:return t.next=17,e.doc.getRent();case 17:for(g in p=t.sent,console.log("Rent"),console.log(p),p.sort(R),p)x=p[g].user,m=void 0,m=y&&x in y?y[x].name:"",p[g].userName=m;i(p);case 23:console.log("Done"),h(!0);case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("======================================="),console.log("RentHistory initialize"),e.doc.serverAvailable?A():(console.log("Load users"),g());case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){if(console.log("User list loaded"),console.log(k),console.log(m),v){var t=[];console.log("User list available");for(var n=0;n<v.users.length;n++){var c=v.users[n],o={id:c._id,name:c.name,level:c.level,state:I(e.text,c.state)};t.push(o)}e.doc.setUser(t),C(e.doc.getUser())}}),[v,m,k,e.doc,e.text]),Object(r.useEffect)((function(){A()}),[y]);var T=function(t){return Object(u.jsx)("div",{children:Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{id:"id",children:e.text.id}),Object(u.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(u.jsx)("th",{id:"returnDate",children:e.text.dueDate})]},"ID"),t&&t.map((function(e,t){return function(e,t){var n=e.id,c=e.rentDate,o=e.retDate,r=e.title,s=e.user,i=e.userName,l=t.toString();return Object(u.jsxs)(a.a.Fragment,{children:[Object(u.jsxs)("tr",{className:"bookTop",children:[Object(u.jsx)("td",{className:"bookCell",children:Object(u.jsx)(oe.b,{to:"/search/"+n,children:n})}),Object(u.jsx)("td",{className:"bookCell",children:c}),Object(u.jsx)("td",{className:"bookCell",children:o})]},l),Object(u.jsx)("tr",{className:"bookRow",children:Object(u.jsx)("td",{colSpan:"3",className:"bookCell",children:r})},l+"Title"),Object(u.jsxs)("tr",{className:"bookBottom",children:[Object(u.jsx)("td",{className:"bookCell",children:Object(u.jsxs)(oe.b,{to:"/userSearch/"+s,children:[" ",s," "]})}),Object(u.jsxs)("td",{colSpan:"2",className:"bookCell",children:[" ",i," "]})]},l+"Renter")]},l+"Fragment")}(e,t)})),t&&0===t.length&&Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})})};return e.doc.initialized?Object(u.jsxs)("div",{id:"situation",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.situation})}),Object(u.jsx)("div",{id:"checkOutResult",children:Object(u.jsx)(ee,{list:s,showCallback:function(e){return T(e)}})})]}):Object(u.jsx)(Z.a,{to:"/"})};var he=function(e){var t=Object(r.useState)([]),n=Object(l.a)(t,2),s=n[0],i=n[1],d=Object(r.useState)(!1),b=Object(l.a)(d,2),O=(b[0],b[1]),h=Object(r.useState)(""),f=Object(l.a)(h,2),p=f[0],g=f[1],x=Object(r.useState)(""),m=Object(l.a)(x,2),v=m[0],k=m[1],S=Object(j.a)(H),E=Object(l.a)(S,2),y=E[0],N=E[1],R=N.loading,A=N.data,D=N.error,T=Object(j.a)(F,{variables:{fromTime:p,toTime:v}}),w=Object(l.a)(T,2),U=w[0],B=w[1],M=B.loading,P=B.data,z=B.error,K=Object(r.useState)({}),V=Object(l.a)(K,2),Y=V[0],q=V[1],G=Object(r.useState)(0),Q=Object(l.a)(G,2),W=Q[0],J=Q[1],X=Object(r.useState)(0),te=Object(l.a)(X,2),ne=te[0],ce=te[1];function re(e,t){return e.rentDate>t.rentDate||!(e.rentDate<t.rentDate)&&e.title>t.title}function ae(){return se.apply(this,arguments)}function se(){return(se=Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O(!0);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){var n,o,r,a,s,i;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("======================================="),console.log("RentHistory initialize"),e.doc.initialized){t.next=4;break}return t.abrupt("return");case 4:for(n=document.getElementById("year"),o=document.getElementById("month"),r=1;r<=12;r++)(a=document.createElement("option")).text=r.toString(),o.add(a,r);for(s=(new Date).getFullYear(),i=(new Date).getMonth()+1,2017,r=2017;r<=s;r++)(a=document.createElement("option")).text=r.toString(),n.add(a,r);console.log(s),console.log(i),J(s),ce(i),document.getElementById("year").value=s,document.getElementById("month").value=i,e.doc.serverAvailable?ae():(console.log("Load users"),y(),ue());case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){if(console.log("User list loaded"),console.log(D),console.log(R),A){var t=[];console.log("User list available");for(var n=0;n<A.users.length;n++){var c=A.users[n],o={id:c._id,name:c.name,level:c.level,state:I(e.text,c.state)};t.push(o)}e.doc.setUser(t),q(e.doc.getUser())}}),[A,R,D,e.doc,e.text]),Object(r.useEffect)((function(){if(console.log("History update"),P){console.log(P.rentLogs);for(var t=P.rentLogs,n=[],c="",o=0;o<t.length;o++){var r=t[o];if("1"===r.book_state){var a,s,l=r.book_id,u=r.user_id;a=Y&&u in Y?Y[u].name:"",l in e.doc.book?s=e.doc.book[l]:((s={}).author="",s.totalName="",s.claim_num="",s.publish="",s.title="");var d="".concat(s.title," ").concat(s.claim_num);"return_data"in r&&(c=r.return_data);var b={index:o,text:d,title:s.title,id:l,rentDate:r.timestamp,retDate:c,author:s.author,claim_num:s.claim_num,publish:s.publisher,claim:s.claim,user:u,userName:a};n.push(b)}}n.sort(C),console.log(n),i(n)}}),[P,M,z]),Object(r.useEffect)((function(){ae()}),[Y]);var ie=function(t){return Object(u.jsx)("div",{children:Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{id:"id",children:e.text.id}),Object(u.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(u.jsx)("th",{id:"returnDate",children:e.text.returnDate})]},"ID"),t&&t.map((function(e,t){return function(e,t){var n=e.id,c=e.rentDate,o=e.retDate,r=e.title,s=e.user,i=e.userName,l=t.toString();return Object(u.jsxs)(a.a.Fragment,{children:[Object(u.jsxs)("tr",{className:"bookTop",children:[Object(u.jsx)("td",{className:"bookCell",children:Object(u.jsx)(oe.b,{to:"/search/"+n,children:n})}),Object(u.jsx)("td",{className:"bookCell",children:c}),Object(u.jsx)("td",{className:"bookCell",children:o})]},l),Object(u.jsx)("tr",{className:"bookRow",children:Object(u.jsx)("td",{colSpan:"3",className:"bookCell",children:r})},l+"Title"),Object(u.jsxs)("tr",{className:"bookBottom",children:[Object(u.jsx)("td",{className:"bookCell",children:Object(u.jsxs)(oe.b,{to:"/userSearch/"+s,children:[" ",s," "]})}),Object(u.jsxs)("td",{colSpan:"2",className:"bookCell",children:[" ",i," "]})]},l+"Renter")]},l+"Fragment")}(e,t)})),t&&0===t.length&&Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})})};function le(e,t){switch(console.log(e),console.log(t),e){case 0:J(t);break;case 1:ce(parseInt(t))}}var ue=function(){var t=Object(o.a)(Object(c.a)().mark((function t(){var n,o,r,a,s,l,u,d,b,j,O,h,f;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Search"),n=W.toString()+"-"+ne.toString().padStart(2,"0"),!e.doc.serverAvailable){t.next=18;break}return o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/history",r={params:{period:n}},console.log(r),t.next=8,$.a.get(o,r);case 8:for(a=t.sent,console.log(a),s=a.data.return.books,l=[],u="",d=0;d<s.length;d++)b=s[d],j="".concat(b.BOOKNAME," ").concat(b.CLAIMNUM),b._STATE,"RETURN_DATE"in b&&(u=b.RETURN_DATE),O={index:d,text:j,title:b.BOOKNAME,id:b.BARCODE,rentDate:b.RENT_DATE,retDate:u,author:b.AUTHOR,totalName:b.TOTAL_NAME,claim_num:b.CLAMENUM,publish:b.PUBLISH,claim:b.CLAIM,user:b.USER,userName:b.USER_NAME},l.push(O);l.sort(re),i(l),t.next=26;break;case 18:return f=ne+1,h=W.toString()+"-"+f.toString().padStart(2,"0"),g(n),k(h),console.log(n),console.log(h),t.next=26,U();case 26:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return e.doc.initialized?Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.history})}),Object(u.jsxs)("div",{id:"searchRange",children:[Object(u.jsx)("div",{className:"page",id:"page",children:Object(u.jsx)(_.a,{fontSize:"large",sx:{color:"#404040"},onClick:function(){!function(){var e=W,t=ne;t>1?t-=1:(e-=1,t=12),J(e),ce(t),document.getElementById("year").value=e,document.getElementById("month").value=t}()}})}),Object(u.jsx)("select",{name:"year",id:"year",className:"dropdown",onChange:function(e){le(0,e.target.value)}}),Object(u.jsx)("select",{name:"month",id:"month",className:"dropdown",onChange:function(e){le(1,e.target.value)}}),Object(u.jsx)("button",{id:"searchButton",onClick:function(){return ue()},children:" search "}),Object(u.jsx)("div",{className:"page",id:"page",children:Object(u.jsx)(L.a,{fontSize:"large",sx:{color:"#404040"},onClick:function(){!function(){var e=W,t=ne;t<12?t+=1:(e+=1,t=1),J(e),ce(t),document.getElementById("year").value=e,document.getElementById("month").value=t}()}})})]}),Object(u.jsx)("div",{id:"checkOutResult",children:Object(u.jsx)(ee,{list:s,showCallback:function(e){return ie(e)}})})]}):Object(u.jsx)(Z.a,{to:"/"})};var fe=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),a=n[0],s=n[1],i=Object(r.useState)({}),d=Object(l.a)(i,2),b=d[0],O=d[1],h=Object(W.a)(a,50),f=(Object(l.a)(h,1)[0],Object(r.useState)(!1)),p=Object(l.a)(f,2),g=p[0],x=p[1],m=Object(r.useState)([]),v=Object(l.a)(m,2),k=(v[0],v[1],Object(r.useState)(!1)),S=Object(l.a)(k,2),E=(S[0],S[1],Object(j.a)(H)),N=Object(l.a)(E,2),C=(N[0],N[1]),R=C.loading,A=C.data,D=C.error,T=Object(r.useState)({}),_=Object(l.a)(T,2),w=(_[0],_[1]),L=Object(r.useState)(0),U=Object(l.a)(L,2),B=(U[0],U[1],Object(r.useRef)("0"),Object(Z.p)().id),M=Object(r.useState)([]),P=Object(l.a)(M,2);function z(){var e={USER_CODE:"",USER_NAME:"",PHONE_NUMBER:"",EMAIL:"",ADDRESS:"",NOTICE:"",USER_LEVEL:-1};O(e)}return P[0],P[1],Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.doc.initialized&&e.doc.serverAvailable){t.next=2;break}return t.abrupt("return");case 2:console.log("======================================="),console.log("NewMember initialize"),z();case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){console.log("Updated id: "+B),s(B||"")}),[B]),Object(r.useEffect)((function(){if(console.log("User list loaded"),console.log(D),console.log(R),A){var t=[];console.log("User list available");for(var n=0;n<A.users.length;n++){var c=A.users[n],o={id:c._id,name:c.name,level:c.level,state:I(e.text,c.state)};t.push(o)}console.log(t),e.doc.setUser(t),console.log(e.doc.getUser()),w(e.doc.getUser())}}),[A,R,D,e]),e.doc.initialized&&e.doc.serverAvailable?Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.newMember})}),Object(u.jsx)("div",{id:"checkOutInput",hidden:!e.doc.admin,children:e.doc.serverAvailable&&Object(u.jsx)(be,{text:e.text,doc:e.doc,info:b,refresh:function(t){console.log("Refresh page "+g),console.log(t),x(!g);var n,c=y;"OK"===t.data.return?(c.type=ce.c.TYPE.SUCCESS,n=e.text.logInSucceed,z()):(c.type=ce.c.TYPE.ERROR,n=e.text.logInFail),c.autoClose=3e3,ce.c.info(n,c)}})})]}):Object(u.jsx)(Z.a,{to:"/"})},pe=(n(262),n(14)),ge=n(15),xe=function(){function e(){Object(pe.a)(this,e),console.log("Create Doc class"),this.initialized=!1,this.bookReady=!1,this.rentReady=!1,this.userReady=!1,this.logged=!1,this.userInfo={},this.book={},this.rent={},this.logCallback=void 0,this.admin=!1,this.serverInfo={},this.serverAvailable=!1,this.ipAddr=""}return Object(ge.a)(e,[{key:"updateIpAddr",value:function(){var e=Object(o.a)(Object(c.a)().mark((function e(){var t,n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.a.get("https://api.ipify.org/?format=json");case 2:t=e.sent,console.log("Get IP Address"),console.log(t.data),n=t.data.ip,console.log("IP addr updated "+n),this.ipAddr=n,this.checkServerIp();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkServerIp",value:function(){if(0!==this.ipAddr.length&&this.serverInfo.globalIp);}},{key:"checkState",value:function(){this.bookReady&&this.rentReady&&(this.initialized=!0,ce.c.dismiss(),this.callback&&this.callback())}},{key:"setLogCallback",value:function(e){this.logCallback=e}},{key:"setRent",value:function(e){this.rent=e,this.rentReady=!0,this.checkState(),this.checkRent()}},{key:"setServerInfo",value:function(e){this.serverInfo=e,console.log(this.serverInfo.globalIp),this.checkServerIp()}},{key:"setBook",value:function(e){this.book={};for(var t=0;t<e.length;t++){var n=e[t],c=n._id;this.book[c]=n}this.bookReady=!0,this.checkState()}},{key:"setUser",value:function(e){this.user={};for(var t=0;t<e.length;t++){var n=e[t],c=n.id;this.user[c]=n,this.user[c].rent=0}this.userReady=!0,this.checkRent()}},{key:"checkRent",value:function(){if(this.userReady&&this.rentReady){for(var e=0;e<this.rent.length;e++){var t=this.rent[e].state;if("1"===t||"3"===t){var n=this.rent[e].user_id;n&&n.length>0&&n in this.user?this.user[n].rent+=1:this.user[n].rent=1}}console.log(this.user)}else console.log("Cannot check rent")}},{key:"logIn",value:function(e){console.log("Logged in: "+e._id),this.logged=!0,this.userInfo=e,"2"===e.level&&(this.admin=!0),this.logCallback&&this.logCallback(!0)}},{key:"logOut",value:function(){console.log("Logged out"),this.logged=!1,this.userInfo={},this.logCallback&&this.logCallback(!1)}},{key:"getRent",value:function(){var e=Object(o.a)(Object(c.a)().mark((function e(){var t,n,o,r,a,s,i,l,u,d,b,j,O,h,f=arguments;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.length>0&&void 0!==f[0]?f[0]:void 0,n=[],!this.serverAvailable){e.next=13;break}return o="https://"+this.serverInfo.localIp+":"+this.serverInfo.port+"/book",r={params:{user:t}},console.log(r),e.next=8,$.a.get(o,r);case 8:if(a=e.sent,console.log(a),"books"in a.data.return){s=Object(Q.a)(a.data.return.books);try{for(s.s();!(i=s.n()).done;)l=i.value,console.log(l),u={id:l.BARCODE,title:l.BOOKNAME,rentDate:l.LENT_DATE,retDate:l.RETURN_DATE,stat:l.STATS},n.push(u)}catch(c){s.e(c)}finally{s.f()}}e.next=36;break;case 13:if(console.log("Check "+t),console.log(this.bookReady),this.bookReady){e.next=17;break}return e.abrupt("return",n);case 17:d=0;case 18:if(!(d<this.rent.length)){e.next=36;break}if(b=this.rent[d],void 0===t||b.user_id===t){e.next=22;break}return e.abrupt("continue",33);case 22:if("1"===b.state||"3"===b.state){e.next=24;break}return e.abrupt("continue",33);case 24:j=b.book_id,O=this.book[j],(h={}).id=O._id,h.title=O.title,h.rentDate=b.rent_date.split(" ")[0].replace("-","/",2).replace("-","/"),h.retDate=b.return_date.split(" ")[0].replace("-","/",2).replace("-","/"),h.user=b.user_id,n.push(h);case 33:d++,e.next=18;break;case 36:return e.abrupt("return",n);case 37:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUser",value:function(){return this.user}},{key:"openDoc",value:function(){var e=Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.initialized=!0,e.next=8;break;case 4:return e.prev=4,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()},{key:"isOpen",value:function(){return this.initialized}},{key:"setCallback",value:function(e){console.log("Update function registered"),this.callback=e}}]),e}(),me=xe,ve=n(218),ke=new(n(263))(ve.privateKey),Se=function(){function e(){Object(pe.a)(this,e),console.log("Create Context"),console.log("Cookies");var t=document.cookie;this.cookie=t.split(";").map((function(e){return e.split("=")})).reduce((function(e,t){var n=t.shift().trim(),c=t.join("=").trim();return e[decodeURIComponent(n)]=decodeURIComponent(c),e}),{}),console.log(this.cookie)}return Object(ge.a)(e,[{key:"checkLogIn",value:function(e,t){var n,c=!1;if(e.user&&t.length>0){console.log("User data available");var o=e.user.encrypted_email,r=e.user.encrypted_phone;if(n=ke.sign(t,"base64"),t===o||t===r)n=t,c=!0;else if(o===n)c=!0;else{for(var a="",s=0;s<t.length;s++)isNaN(t[s])||(a+=t[s]);(n=ke.sign(a,"base64"))===r&&(c=!0)}}if(c){var i=new Date;i.setTime(i.getTime()+1728e5);var l=i.toGMTString();document.cookie="password="+n+"; expires="+l+";"}return c}}]),e}(),Ee=n(148),ye=n(219);n(385),n(386);var Ie=function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),c=n[0],o=n[1],a=Object(r.useState)(!1),s=Object(l.a)(a,2),i=s[0],d=s[1];return Object(r.useEffect)((function(){c!==e.dropdown&&(console.log("User clicked "+e.doc.logged),console.log(e.dropdown),d(!i),o(e.dropdown));var t=document.getElementById("dropdown-menu");i?t.classList.add("is-show"):t.classList.remove("is-show")}),[e.dropdown,c,i,e.doc.logged]),Object(u.jsxs)("div",{id:"dropdown-menu",onClick:function(){d(!i)},className:"dropdown-menu",children:[!e.doc.serverAvailable&&e.doc.logged&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"menu-items",children:e.doc.userInfo._id+" : "+e.doc.userInfo.name+e.text.nameSuffix}),Object(u.jsx)("hr",{className:"hline"})]}),Object(u.jsx)(oe.b,{className:"menu-items",to:"/",onClick:function(){return d(!1)},children:e.text.home}),Object(u.jsx)(oe.b,{className:"menu-items",to:"/notice",onClick:function(){return d(!1)},children:e.text.notice}),Object(u.jsx)(oe.b,{className:"menu-items",to:"/search",onClick:function(){return d(!1)},children:e.text.bookSearch}),e.doc.serverAvailable&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(oe.b,{className:"menu-items",to:"/checkOut",onClick:function(){return d(!1)},children:e.text.checkOut}),Object(u.jsx)(oe.b,{className:"menu-items",to:"/return",onClick:function(){return d(!1)},children:e.text.return})]}),!e.doc.serverAvailable&&e.doc.logged&&Object(u.jsx)(u.Fragment,{children:Object(u.jsx)(oe.b,{className:"menu-items",to:"/checkOutStatus",onClick:function(){return d(!1)},children:e.text.checkOutStatus})}),e.doc.admin&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("hr",{className:"hline"}),Object(u.jsx)(oe.b,{className:"menu-items",to:"/userSearch",onClick:function(){return d(!1)},children:e.text.userSearch}),Object(u.jsx)(oe.b,{className:"menu-items",to:"/rentalSituation",onClick:function(){return d(!1)},children:e.text.situation}),Object(u.jsx)(oe.b,{className:"menu-items",to:"/rentHistory",onClick:function(){return d(!1)},children:e.text.history})]}),e.doc.serverAvailable&&e.doc.admin&&Object(u.jsx)(oe.b,{className:"menu-items",to:"/newMember",onClick:function(){return d(!1)},children:e.text.newMember}),!e.doc.serverAvailable&&e.doc.logged&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("hr",{className:"hline"}),Object(u.jsx)("div",{className:"menu-items",onClick:function(){return d(!1),e.doc.logOut(),document.cookie="user_id=",document.cookie="password=",void(document.cookie="autoLogin=false")},children:e.text.logOut})]}),!e.doc.serverAvailable&&!e.doc.logged&&Object(u.jsx)(u.Fragment,{children:Object(u.jsx)(oe.b,{className:"menu-items",to:"/checkOutStatus",onClick:function(){return d(!1)},children:e.text.logIn})})]})},Ne=n(220),Ce=n.n(Ne);var Re=function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),c=n[0],o=n[1];return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{id:"navbar",className:"navbar",children:[Object(u.jsx)("div",{className:"title",children:ye.isMobile?Object(u.jsx)("h1",{children:e.text.titleShort}):Object(u.jsx)("h1",{children:e.text.titleLong})}),Object(u.jsx)("div",{className:"menu",onClick:function(){var e=document.getElementById("navbar").style.maxWidth;console.log("maxWidth"),console.log(e),console.log(document.getElementById("navbar").style.width),o(!c)},children:Object(u.jsx)(Ce.a,{className:"img",fontSize:"large",sx:{color:"#ffffff"}})}),Object(u.jsx)(Ie,{text:e.text,doc:e.doc,dropdown:c})]})})},Ae=new me,De=new Se,Te={},_e="";var we=function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(!1),i=Object(l.a)(s,2),O=i[0],h=i[1],f=Object(r.useState)(""),p=Object(l.a)(f,2),g=p[0],x=p[1],m=Object(b.b)(P),v=m.loading,k=m.error,S=m.data,E=Object(b.b)(q),I=E.loading,N=E.error,C=E.data,R=Object(j.a)(M),D=Object(l.a)(R,2),T=D[0],_=D[1],w=_.loading,L=_.error,U=_.data,B=Object(j.a)(z,{variables:{_id:g}}),H=Object(l.a)(B,2),K=H[0],F=H[1].data;function V(){var e=y;e.type=ce.c.TYPE.SUCCESS,e.render=Te.succeededToOpen,e.autoClose=3e3,e.toastId="",ce.c.info(Te.succeededToOpen,e)}function Y(e){console.log("==== Update logging state "+Ae.logged),console.log(Ae.userInfo),h(Ae.logged)}return Object(r.useEffect)((function(){function e(){return(e=Object(o.a)(Object(c.a)().mark((function e(){var t,n,o;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o in console.log("Initialize app"),_e+="<p>Initialize app</p>",console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/library",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NAME:"library",REACT_APP_VERSION:"0.8.0"}).APP_NAME),console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/library",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NAME:"library",REACT_APP_VERSION:"0.8.0"}).APP_VERSION),t=navigator.languages,console.log(t),n={},n=t.length>0&&(t[0].toLowerCase().includes("kr")||t[0].toLowerCase().includes("ko"))?Ee.kr:Ee.en)Te[o]=n[o];return e.next=11,Ae.updateIpAddr();case 11:"autoLogin"in De.cookie&&"true"===De.cookie.autoLogin&&(console.log("Auto Login: "+De.cookie.user_id),x(De.cookie.user_id),console.log(De.cookie.nothing),K()),a(!0);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[K]),Object(r.useEffect)((function(){console.log("User data loaded"),F&&(console.log("Login check "+De.cookie.password),console.log(F),De.cookie.password&&De.checkLogIn(F,De.cookie.password)&&(console.log("Login suceeded"),Ae.logIn(F.user)))}),[F]),Object(r.useEffect)((function(){console.log("Rent Query Updated"),_e=_e+"<p>Rent Query Updated "+v+" "+k+"</p>",console.log(v),console.log(k),S&&(console.log("Rent available"),_e+="<p>Rent available</p>",Ae.setRent(S.rents),Ae.initialized&&V())}),[v,k,S]),Object(r.useEffect)((function(){console.log("Book Query Updated"),_e+="<p>Book Query Updated</p>",console.log(w),console.log(L),U&&(console.log("Book available"),_e+="<p>Book available</p>",Ae.setBook(U.books),Ae.initialized&&V())}),[w,L,U]),Object(r.useEffect)((function(){if(console.log("Server Query Updated"),_e+="<p>Server Query Updated</p>",console.log(C),console.log(n),C&&n&&(console.log("Server info available"),_e+="<p>Server info available</p>",console.log(C.serverInfo),Ae.setServerInfo(C.serverInfo),!Ae.serverAvailable)){console.log("Server is not available. Load books from cloud DB"),T();var e=y;e.type=ce.c.TYPE.LOADING,e.autoClose=!1,e.toastId=A,ce.c.loading(Te.loading,e),Ae.setLogCallback(Y)}}),[I,N,C,T,n]),Object(u.jsx)(oe.a,{children:Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)("div",{children:Object(u.jsx)(ce.a,{newestOnTop:!0,closeOnClick:!0,rtl:!1,draggable:!0,pauseOnHover:!0,pauseOnFocusLoss:!1,transition:ce.b,limit:10})}),Object(u.jsx)(Re,{doc:Ae,text:Te}),Object(u.jsxs)(Z.d,{children:[Object(u.jsx)(Z.b,{path:"/",element:Object(u.jsx)(d,{doc:Ae,text:Te})}),Object(u.jsx)(Z.b,{path:"/notice",element:Object(u.jsx)(G,{doc:Ae,text:Te})}),Object(u.jsx)(Z.b,{path:"/search/:id?",element:Object(u.jsx)(ne,{doc:Ae,text:Te})}),Object(u.jsx)(Z.b,{path:"/checkOutStatus",element:Object(u.jsx)(ae,{context:De,doc:Ae,text:Te,logged:O})}),Object(u.jsx)(Z.b,{path:"/userSearch/:id?",element:Object(u.jsx)(je,{context:De,doc:Ae,text:Te})}),Object(u.jsx)(Z.b,{path:"/checkOut",element:Object(u.jsx)(ue,{context:De,doc:Ae,text:Te})}),Object(u.jsx)(Z.b,{path:"/return",element:Object(u.jsx)(de,{context:De,doc:Ae,text:Te})}),Object(u.jsx)(Z.b,{path:"/rentalSituation",element:Object(u.jsx)(Oe,{context:De,doc:Ae,text:Te})}),Object(u.jsx)(Z.b,{path:"/rentHistory",element:Object(u.jsx)(he,{context:De,doc:Ae,text:Te})}),Object(u.jsx)(Z.b,{path:"/newMember",element:Object(u.jsx)(fe,{context:De,doc:Ae,text:Te})})]}),Object(u.jsxs)("h3",{children:["v ","0.8.0"]})]})})},Le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,412)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),o(e),r(e),a(e)}))},Ue=n(149),Be=n(409),Me=n(408),Pe=n(410),He=n(407),ze="data-xaque",Ke="https://realm.mongodb.com/api/client/v2.0/app/".concat(ze,"/graphql"),Fe=new Ue.a(ze);function Ve(){return Ye.apply(this,arguments)}function Ye(){return(Ye=Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Fe.currentUser){e.next=5;break}return e.next=3,Fe.logIn(Ue.b.anonymous());case 3:e.next=7;break;case 5:return e.next=7,Fe.currentUser.refreshAccessToken();case 7:return e.abrupt("return",Fe.currentUser.accessToken);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var qe=new Be.a({link:new Me.a({uri:Ke,fetch:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(o.a)(Object(c.a)().mark((function e(t,n){var o;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve();case 2:return o=e.sent,n.headers.Authorization="Bearer ".concat(o),e.abrupt("return",fetch(t,n));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}),cache:new Pe.a});i.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(He.a,{client:qe,children:Object(u.jsx)(we,{})})}),document.getElementById("root")),Le()},52:function(e,t,n){}},[[388,1,2]]]);
//# sourceMappingURL=main.5bbc0e32.chunk.js.map